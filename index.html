<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.1.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.1.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.1.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="iOS 修炼中...">
<meta property="og:type" content="website">
<meta property="og:title" content="以梦为马">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="以梦为马">
<meta property="og:description" content="iOS 修炼中...">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="以梦为马">
<meta name="twitter:description" content="iOS 修炼中...">






  <link rel="canonical" href="http://yoursite.com/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>以梦为马</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">以梦为马</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">谨以此纪念岁月</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>




<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-主页 menu-item-active">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />主页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-归档">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/iOS开发之 - WKWebView VS UIWebView/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="刘朋坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="以梦为马">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/iOS开发之 - WKWebView VS UIWebView/" itemprop="url">
                  iOS开发之 - WKWebView VS UIWebView
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>WKWebView是苹果在 iOS 8 中推出的新框架，相比UIWebView来说，WKWebView 性能好，速度快，内存小，功能多，且支持了更多的 HTML5 特性……因此本小白禁不住“诱惑”利用了一晚上的时间，整理了一些关于 WKWebView 的资料，与大家分享下！在说 WKWebView 之前，我们先说说他的老大哥 UIWebView ！！！</p>
</blockquote>
<p>UIWebView 是苹果在 iOS 2 之后推出的，由于资格比较“老”，大家对 UIWebView 应该也不会陌生，这里直接上代码：</p>
<h3 id="1-UIWebView-基本使用"><a href="#1-UIWebView-基本使用" class="headerlink" title="1.UIWebView 基本使用"></a>1.UIWebView 基本使用</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建webview</span></span><br><span class="line"><span class="built_in">UIWebView</span> *webView = [[<span class="built_in">UIWebView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">20</span>, NNWidth, NNHeight - <span class="number">20</span>)];</span><br><span class="line"><span class="comment">// 网络请求</span></span><br><span class="line"><span class="built_in">NSURLRequest</span> *request =[<span class="built_in">NSURLRequest</span> requestWithURL:[<span class="built_in">NSURL</span> URLWithString:<span class="string">@"http://www.baidu.com"</span>]];</span><br><span class="line"><span class="comment">// 加载网页</span></span><br><span class="line">[webView loadRequest:request];</span><br><span class="line"><span class="comment">// 添加到界面</span></span><br><span class="line">[<span class="keyword">self</span>.view addSubview:webView];</span><br></pre></td></tr></table></figure>
<h3 id="2-UIWebView-常用方法"><a href="#2-UIWebView-常用方法" class="headerlink" title="2.UIWebView 常用方法"></a>2.UIWebView 常用方法</h3><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">webView reload</span>]; <span class="comment">// 刷新</span></span><br><span class="line">[<span class="meta">webView stopLoading</span>]; <span class="comment">// 停止加载</span></span><br><span class="line">[<span class="meta">webView goBack</span>]; <span class="comment">// 后退</span></span><br><span class="line">[<span class="meta">webView goForward</span>]; <span class="comment">// 前进</span></span><br><span class="line">[<span class="meta">webView canGoBack</span>]; <span class="comment">// 是否可以后退</span></span><br><span class="line">[<span class="meta">webView canGoForward</span>]; <span class="comment">// 是否可以向前</span></span><br><span class="line">[<span class="meta">webView isLoading</span>]; <span class="comment">// 是否正在加载</span></span><br></pre></td></tr></table></figure>
<h3 id="3-UIWebView-相关代理协议"><a href="#3-UIWebView-相关代理协议" class="headerlink" title="3.UIWebView 相关代理协议"></a>3.UIWebView 相关代理协议</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#pragma mark - UIWebViewDelegate</span></span><br><span class="line"><span class="comment">/// 是否允许加载网页</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)webView:(<span class="built_in">UIWebView</span> *)webView shouldStartLoadWithRequest:(<span class="built_in">NSURLRequest</span> *)request navigationType:(<span class="built_in">UIWebViewNavigationType</span>)navigationType &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"允许加载网页"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// 开始加载网页时调用</span></span><br><span class="line">- (<span class="keyword">void</span>)webViewDidStartLoad:(<span class="built_in">UIWebView</span> *)webView &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"开始加载网页"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/// 网页加载完成时调用</span></span><br><span class="line">- (<span class="keyword">void</span>)webViewDidFinishLoad:(<span class="built_in">UIWebView</span> *)webView &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"网页加载完成"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// 网页加载错误时调用</span></span><br><span class="line">- (<span class="keyword">void</span>)webView:(<span class="built_in">UIWebView</span> *)webView didFailLoadWithError:(<span class="built_in">NSError</span> *)error &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"网页加载错误时调用"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="这里是-UIWebView-的效果图！！！"><a href="#这里是-UIWebView-的效果图！！！" class="headerlink" title="这里是 UIWebView 的效果图！！！"></a>这里是 UIWebView 的效果图！！！</h3><p><img src="http://upload-images.jianshu.io/upload_images/2665449-ab410b93f7c4d753.gif?imageMogr2/auto-orient/strip" alt="UIWebView加载网页"><br><img src="http://upload-images.jianshu.io/upload_images/2665449-14ead660659b5a2b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="代理方法输出的顺序"></p>
<h3 id="因为主要想与大家分享的是-WKWebView，所以对-UIWebView-的介绍就到此为止了。接下来的-WKWebView-才是今晚的主角！！！"><a href="#因为主要想与大家分享的是-WKWebView，所以对-UIWebView-的介绍就到此为止了。接下来的-WKWebView-才是今晚的主角！！！" class="headerlink" title="因为主要想与大家分享的是 WKWebView，所以对 UIWebView 的介绍就到此为止了。接下来的 WKWebView 才是今晚的主角！！！"></a>因为主要想与大家分享的是 WKWebView，所以对 UIWebView 的介绍就到此为止了。接下来的 WKWebView 才是今晚的主角！！！</h3><hr>
<p><strong>依然是先介绍 WKWebView 的基本使用</strong></p>
<h3 id="1-WKWebView-基本使用"><a href="#1-WKWebView-基本使用" class="headerlink" title="1. WKWebView 基本使用"></a>1. WKWebView 基本使用</h3><blockquote>
<p>这里加一个不用提示的提示：WKWebView 和 UIWebview 的基本使用方法相类似，但是需要导入头文件 #import &lt;WebKit/WebKit.h&gt;，其它步骤如下</p>
</blockquote>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建webview</span></span><br><span class="line"><span class="built_in">WKWebView</span> *webView = [[<span class="built_in">WKWebView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">20</span>, NNWidth, NNHeight - <span class="number">20</span>)];</span><br><span class="line"><span class="comment">// 创建请求</span></span><br><span class="line"><span class="built_in">NSURLRequest</span> *request =[<span class="built_in">NSURLRequest</span> requestWithURL:[<span class="built_in">NSURL</span> URLWithString:<span class="string">@"http://www.baidu.com"</span>]];</span><br><span class="line"><span class="comment">// 加载网页</span></span><br><span class="line">[webView loadRequest:request];</span><br><span class="line"><span class="comment">// 将webView添加到界面</span></span><br><span class="line">[<span class="keyword">self</span>.view addSubview:webView];</span><br></pre></td></tr></table></figure>
<p>ps:这里就不再补充效果图了，除了速度内存优于 UIWebView，显示的效果差不多。。。</p>
<h3 id="2-WKWebView-加载文件"><a href="#2-WKWebView-加载文件" class="headerlink" title="2. WKWebView 加载文件"></a>2. WKWebView 加载文件</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建webview</span></span><br><span class="line"><span class="built_in">WKWebView</span> *webView = [[<span class="built_in">WKWebView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">20</span>, NNWidth, NNHeight - <span class="number">20</span>)];</span><br><span class="line"><span class="comment">// 创建url(可以随便从桌面拉张图片)</span></span><br><span class="line"><span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> fileURLWithPath:<span class="string">@"/Users/ios/Desktop/图片/90416596477f347431a929dc73b9f404.jpg"</span>];</span><br><span class="line"><span class="comment">// 加载文件</span></span><br><span class="line">[webView loadFileURL:url allowingReadAccessToURL:url];</span><br><span class="line"><span class="comment">// 最后将webView添加到界面</span></span><br><span class="line">[<span class="keyword">self</span>.view addSubview:webView];</span><br></pre></td></tr></table></figure>
<h4 id="这里是加载文件效果图！"><a href="#这里是加载文件效果图！" class="headerlink" title="这里是加载文件效果图！"></a>这里是加载文件效果图！</h4><p><img src="http://upload-images.jianshu.io/upload_images/2665449-026af846596935f2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="加载本地图片"></p>
<h3 id="3-WKWebView-与-JS-代码交互"><a href="#3-WKWebView-与-JS-代码交互" class="headerlink" title="3. WKWebView 与 JS 代码交互"></a>3. WKWebView 与 JS 代码交互</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 图片缩放的 JS 代码</span></span><br><span class="line"><span class="built_in">NSString</span> *JSImage = <span class="string">@"var count = document.images.length;for (var i = 0; i &lt; count; i++) &#123;var image = document.images[i];image.style.width=375;&#125;;window.alert('找到' + count + '张图');"</span>;</span><br><span class="line"><span class="comment">// 初始化 WKUserScript</span></span><br><span class="line"><span class="built_in">WKUserScript</span> *script = [[<span class="built_in">WKUserScript</span> alloc] initWithSource:JSImage injectionTime:<span class="built_in">WKUserScriptInjectionTimeAtDocumentEnd</span> forMainFrameOnly:<span class="literal">YES</span>];</span><br><span class="line"><span class="comment">// 初始化WKWebViewConfiguration</span></span><br><span class="line"><span class="built_in">WKWebViewConfiguration</span> *configuration = [[<span class="built_in">WKWebViewConfiguration</span> alloc] init];</span><br><span class="line">[configuration.userContentController addUserScript:script];</span><br><span class="line">_webView = [[<span class="built_in">WKWebView</span> alloc] initWithFrame:<span class="keyword">self</span>.view.bounds configuration:configuration];</span><br><span class="line"><span class="comment">// 这里需要从网上找到一张图片的地址</span></span><br><span class="line">[_webView loadHTMLString:<span class="string">@"&lt;head&gt;&lt;/head&gt;![](http://upload-images.jianshu.io/upload_images/2665449-f109bc70619e2a92.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)"</span>baseURL:<span class="literal">nil</span>];</span><br><span class="line">[<span class="keyword">self</span>.view addSubview:_webView];</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-311830759271b58f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="与 JS 交互效果图"></p>
<h3 id="4-WKWebView-常用的代理协议"><a href="#4-WKWebView-常用的代理协议" class="headerlink" title="4. WKWebView 常用的代理协议"></a>4. WKWebView 常用的代理协议</h3><p><em>WKWebView 的代理方法还是蛮有趣的，大家可以试下哈！</em></p>
<h4 id="4-1-WKNavigationDelegate-协议"><a href="#4-1-WKNavigationDelegate-协议" class="headerlink" title="4.1 WKNavigationDelegate 协议"></a>4.1 WKNavigationDelegate 协议</h4><p>这里简单罗列了几个常用的方法。以下四个与 UIWebView 中的方法相同：<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#pragma</span> <span class="selector-tag">mark</span> <span class="selector-tag">-</span> <span class="selector-tag">WKNavigationDelegate</span></span><br><span class="line"><span class="comment">// 页面开始加载时调用</span></span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">webView</span><span class="selector-pseudo">:(WKWebView</span> *)<span class="selector-tag">webView</span> <span class="selector-tag">didStartProvisionalNavigation</span><span class="selector-pseudo">:(WKNavigation</span> *)<span class="selector-tag">navigation</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 内容开始返回时调用</span></span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">webView</span><span class="selector-pseudo">:(WKWebView</span> *)<span class="selector-tag">webView</span> <span class="selector-tag">didCommitNavigation</span><span class="selector-pseudo">:(WKNavigation</span> *)<span class="selector-tag">navigation</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 页面加载完成时调用</span></span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">webView</span><span class="selector-pseudo">:(WKWebView</span> *)<span class="selector-tag">webView</span> <span class="selector-tag">didFinishNavigation</span><span class="selector-pseudo">:(WKNavigation</span> *)<span class="selector-tag">navigation</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 页面加载失败时调用</span></span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">webView</span><span class="selector-pseudo">:(WKWebView</span> *)<span class="selector-tag">webView</span> <span class="selector-tag">didFailProvisionalNavigation</span><span class="selector-pseudo">:(WKNavigation</span> *)<span class="selector-tag">navigation</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>新增的三个代理方法:<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 这个方法是服务器重定向时调用，即 接收到服务器跳转请求之后调用</span></span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">webView</span><span class="selector-pseudo">:(WKWebView</span> *)<span class="selector-tag">webView</span> <span class="selector-tag">didReceiveServerRedirectForProvisionalNavigation</span><span class="selector-pseudo">:(WKNavigation</span> *)<span class="selector-tag">navigation</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 在收到响应后，决定是否跳转</span></span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">webView</span><span class="selector-pseudo">:(WKWebView</span> *)<span class="selector-tag">webView</span> <span class="selector-tag">decidePolicyForNavigationResponse</span><span class="selector-pseudo">:(WKNavigationResponse</span> *)<span class="selector-tag">navigationResponse</span> <span class="selector-tag">decisionHandler</span><span class="selector-pseudo">:(void</span> (^)(WKNavigationResponsePolicy))<span class="selector-tag">decisionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 在发送请求之前，决定是否跳转</span></span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">webView</span><span class="selector-pseudo">:(WKWebView</span> *)<span class="selector-tag">webView</span> <span class="selector-tag">decidePolicyForNavigationAction</span><span class="selector-pseudo">:(WKNavigationAction</span> *)<span class="selector-tag">navigationAction</span> <span class="selector-tag">decisionHandler</span><span class="selector-pseudo">:(void</span> (^)(WKNavigationActionPolicy))<span class="selector-tag">decisionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="4-2-WKUIDelegate-协议"><a href="#4-2-WKUIDelegate-协议" class="headerlink" title="4.2 WKUIDelegate 协议"></a>4.2 WKUIDelegate 协议</h4><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#pragma</span> <span class="selector-tag">mark</span> <span class="selector-tag">-</span> <span class="selector-tag">WKUIDelegate</span></span><br><span class="line"><span class="comment">/// 创建一个新的WebView</span></span><br><span class="line"><span class="selector-tag">-</span> (WKWebView *)<span class="selector-tag">webView</span><span class="selector-pseudo">:(WKWebView</span> *)<span class="selector-tag">webView</span> <span class="selector-tag">createWebViewWithConfiguration</span><span class="selector-pseudo">:(WKWebViewConfiguration</span> *)<span class="selector-tag">configuration</span> <span class="selector-tag">forNavigationAction</span><span class="selector-pseudo">:(WKNavigationAction</span> *)<span class="selector-tag">navigationAction</span> <span class="selector-tag">windowFeatures</span><span class="selector-pseudo">:(WKWindowFeatures</span> *)<span class="selector-tag">windowFeatures</span> &#123;</span><br><span class="line"><span class="selector-tag">return</span> <span class="selector-tag">nil</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*  web界面中有弹出警告框时调用</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  @param webView           实现该代理的webview</span></span><br><span class="line"><span class="comment">*  @param message           警告框中的内容</span></span><br><span class="line"><span class="comment">*  @param frame             主窗口</span></span><br><span class="line"><span class="comment">*  @param completionHandler 警告框消失调用</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">webView</span><span class="selector-pseudo">:(WKWebView</span> *)<span class="selector-tag">webView</span> <span class="selector-tag">runJavaScriptAlertPanelWithMessage</span><span class="selector-pseudo">:(NSString</span> *)<span class="selector-tag">message</span> <span class="selector-tag">initiatedByFrame</span><span class="selector-pseudo">:(void</span> (^)())<span class="selector-tag">completionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// 输入框</span></span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">webView</span><span class="selector-pseudo">:(WKWebView</span> *)<span class="selector-tag">webView</span> <span class="selector-tag">runJavaScriptTextInputPanelWithPrompt</span><span class="selector-pseudo">:(NSString</span> *)<span class="selector-tag">prompt</span> <span class="selector-tag">defaultText</span><span class="selector-pseudo">:(nullable</span> <span class="selector-tag">NSString</span> *)<span class="selector-tag">defaultText</span> <span class="selector-tag">initiatedByFrame</span><span class="selector-pseudo">:(WKFrameInfo</span> *)<span class="selector-tag">frame</span> <span class="selector-tag">completionHandler</span><span class="selector-pseudo">:(void</span> (^)(NSString * __nullable result))<span class="selector-tag">completionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/// 确认框</span></span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">webView</span><span class="selector-pseudo">:(WKWebView</span> *)<span class="selector-tag">webView</span> <span class="selector-tag">runJavaScriptConfirmPanelWithMessage</span><span class="selector-pseudo">:(NSString</span> *)<span class="selector-tag">message</span> <span class="selector-tag">initiatedByFrame</span><span class="selector-pseudo">:(WKFrameInfo</span> *)<span class="selector-tag">frame</span> <span class="selector-tag">completionHandler</span><span class="selector-pseudo">:(void</span> (^)(BOOL result))<span class="selector-tag">completionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/// 警告框</span></span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">webView</span><span class="selector-pseudo">:(WKWebView</span> *)<span class="selector-tag">webView</span> <span class="selector-tag">runJavaScriptAlertPanelWithMessage</span><span class="selector-pseudo">:(NSString</span> *)<span class="selector-tag">message</span> <span class="selector-tag">initiatedByFrame</span><span class="selector-pseudo">:(WKFrameInfo</span> *)<span class="selector-tag">frame</span> <span class="selector-tag">completionHandler</span><span class="selector-pseudo">:(void</span> (^)(void))<span class="selector-tag">completionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5-另外搜集了一些-WKWebView-常用的属性："><a href="#5-另外搜集了一些-WKWebView-常用的属性：" class="headerlink" title="5.另外搜集了一些 WKWebView 常用的属性："></a>5.另外搜集了一些 WKWebView 常用的属性：</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">•    <span class="string">WKBackForwardListItem:</span> webview中后退列表里的某一个网页。</span><br><span class="line">•    <span class="string">WKFrameInfo:</span> 包含一个网页的布局信息。</span><br><span class="line">•    <span class="string">WKNavigation:</span> 包含一个网页的加载进度信息。</span><br><span class="line">•    <span class="string">WKPreferences:</span> 概括一个 webview 的偏好设置。</span><br><span class="line">•    <span class="string">WKProcessPool:</span> 表示一个 web 内容加载池。</span><br><span class="line">•    <span class="string">WKScriptMessage:</span> 包含网页发出的信息。</span><br><span class="line">•    <span class="string">WKUserScript:</span>表示可以被网页接受的用户脚本。</span><br><span class="line">•    <span class="string">WKWebViewConfiguration:</span> 初始化 webview 的设置。</span><br><span class="line">•    <span class="string">WKWindowFeatures:</span> 指定加载新网页时的窗口属性。</span><br><span class="line">•    <span class="string">WKScriptMessageHandler:</span> 提供从网页中收消息的回调方法。</span><br></pre></td></tr></table></figure>
<p>小尾巴:正像开头说的那样， WKWebView 相比UIWebView来说性能好，速度快，内存小，功能多……但现在开发中普遍用的还是 UIWebView，这是因为大多数App需要支持iOS7及以上的版本。但苹果之所以推出 WKWebView 就是为了弥补 UIWebView 的种种不足，逐渐取代 UIWebView，相信不久的将来，网页会成为 WKWebView 的天下！</p>
<p><em>今天就简单的写到这里，以后如果用到其它的了，再和大家分享😄!</em></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/ 前端笔记 - HTML 特殊标签实现文字滚动/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="刘朋坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="以梦为马">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/ 前端笔记 - HTML 特殊标签实现文字滚动/" itemprop="url">
                  前端笔记 - HTML 特殊标签实现文字滚动
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>想用 HTML 做个文字滚动效果，可以用特殊标签 marquee 实现，当然也可以用 JS 实现， 今天试了下用特殊标签 marquee 实现文字滚动。先声明下本人从事于 iOS 开发，之前零零星星的学过 HTML ，但目前尚处于小白阶段😂，因此文章如果有不当之处还请各位大神不吝指出！</p>
</blockquote>
<h3 id="先一起看下-marquee-标签存在哪些属性："><a href="#先一起看下-marquee-标签存在哪些属性：" class="headerlink" title="先一起看下 marquee 标签存在哪些属性："></a>先一起看下 marquee 标签存在哪些属性：</h3><ul>
<li>behavior：滚动方式，三种：scroll（循环滚动） slide（单次滚动）、alternate（来回滚动）</li>
<li>bgcolor：滚动文本框的背景颜色</li>
<li>direction：滚动方向，四种：left（从右到左）、right（从左到右）、up（从下到上）、down（从上到下）</li>
<li>scrolldelay：每轮滚动之间的延迟时间，数字越大滚动越慢</li>
<li>scrollamount：一次滚动总的时间量，数字越小滚动越慢</li>
<li>align：文字的对齐方式，三种： middle(居中)、bottom(居下)、top(居上)</li>
<li>width：滚动文本框的宽度</li>
<li>height：滚动文本框的高度</li>
<li>loop：滚动次数，默认为 infinite（无限）</li>
<li>hspace：水平方向的空白距离</li>
<li>vspace：垂直方向的空白距离</li>
</ul>
<h3 id="下面便是-marquee-属性的一些应用"><a href="#下面便是-marquee-属性的一些应用" class="headerlink" title="下面便是 marquee 属性的一些应用"></a>下面便是 marquee 属性的一些应用</h3><h4 id="一、滚动方式-behavior-：scroll（循环滚动）"><a href="#一、滚动方式-behavior-：scroll（循环滚动）" class="headerlink" title="一、滚动方式 behavior ：scroll（循环滚动）"></a>一、滚动方式 behavior ：scroll（循环滚动）</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">marquee</span> <span class="attr">direction</span>=<span class="string">"right"</span></span></span><br><span class="line"><span class="tag"><span class="attr">behavior</span>=<span class="string">"scroll"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">金风玉露一相逢, 便胜却人间无数.<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">两情若是久长时, 又岂在朝朝暮暮.<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">marquee</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-47605cbed1e7bf3a.gif?imageMogr2/auto-orient/strip" alt="循环滚动"></p>
<h4 id="二、滚动方式-behavior：alternate（来回滚动）"><a href="#二、滚动方式-behavior：alternate（来回滚动）" class="headerlink" title="二、滚动方式 behavior：alternate（来回滚动）"></a>二、滚动方式 behavior：alternate（来回滚动）</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">marquee</span> <span class="attr">direction</span>=<span class="string">"right"</span></span></span><br><span class="line"><span class="tag"><span class="attr">behavior</span>=<span class="string">"alternate"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">金风玉露一相逢, 便胜却人间无数.<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">两情若是久长时, 又岂在朝朝暮暮.<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">marquee</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-2ef9e8f7f7097a05.gif?imageMogr2/auto-orient/strip" alt="来回滚动"></p>
<h3 id="三、滚动方向-direction：up（从下到上）"><a href="#三、滚动方向-direction：up（从下到上）" class="headerlink" title="三、滚动方向 direction：up（从下到上）"></a>三、滚动方向 direction：up（从下到上）</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">marquee</span> <span class="attr">direction</span>=<span class="string">"up"</span></span></span><br><span class="line"><span class="tag"><span class="attr">behavior</span>=<span class="string">"scroll"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">金风玉露一相逢, 便胜却人间无数.<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">两情若是久长时, 又岂在朝朝暮暮.<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">marquee</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-afc2adaff655f9b5.gif?imageMogr2/auto-orient/strip" alt="从下到上"></p>
<h3 id="四、滚动方向-direction：left（从右到左）"><a href="#四、滚动方向-direction：left（从右到左）" class="headerlink" title="四、滚动方向 direction：left（从右到左）"></a>四、滚动方向 direction：left（从右到左）</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">marquee</span> <span class="attr">direction</span>=<span class="string">"left"</span></span></span><br><span class="line"><span class="tag"><span class="attr">behavior</span>=<span class="string">"scroll"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">金风玉露一相逢, 便胜却人间无数.<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">两情若是久长时, 又岂在朝朝暮暮.<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">marquee</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-59c59ad94d252736.gif?imageMogr2/auto-orient/strip" alt="从右到左"></p>
<h3 id="五、滚动速度（scrollamount）"><a href="#五、滚动速度（scrollamount）" class="headerlink" title="五、滚动速度（scrollamount）"></a>五、滚动速度（scrollamount）</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">marquee</span> <span class="attr">direction</span>=<span class="string">"left"</span></span></span><br><span class="line"><span class="tag"><span class="attr">behavior</span>=<span class="string">"scroll"</span></span></span><br><span class="line"><span class="tag"><span class="attr">scrollamount</span>=<span class="string">"80px"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">金风玉露一相逢, 便胜却人间无数.<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">两情若是久长时, 又岂在朝朝暮暮.<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">marquee</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-8c084cd3ab2119e7.gif?imageMogr2/auto-orient/strip" alt="滚动速度"></p>
<h3 id="六、循环次数（loop）"><a href="#六、循环次数（loop）" class="headerlink" title="六、循环次数（loop）"></a>六、循环次数（loop）</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">marquee</span> <span class="attr">direction</span>=<span class="string">"left"</span></span></span><br><span class="line"><span class="tag"><span class="attr">behavior</span>=<span class="string">"scroll"</span></span></span><br><span class="line"><span class="tag"><span class="attr">scrollamount</span>=<span class="string">"80px"</span></span></span><br><span class="line"><span class="tag"><span class="attr">loop</span>=<span class="string">"5"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">金风玉露一相逢, 便胜却人间无数.<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">两情若是久长时, 又岂在朝朝暮暮.<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">marquee</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-1e7e0b115db0402f.gif?imageMogr2/auto-orient/strip" alt="循环次数"></p>
<h3 id="七、当鼠标停留在文字上，文字停止滚动"><a href="#七、当鼠标停留在文字上，文字停止滚动" class="headerlink" title="七、当鼠标停留在文字上，文字停止滚动"></a>七、当鼠标停留在文字上，文字停止滚动</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">marquee</span> <span class="attr">direction</span>=<span class="string">"left"</span></span></span><br><span class="line"><span class="tag"><span class="attr">behavior</span>=<span class="string">"scroll"</span></span></span><br><span class="line"><span class="tag"><span class="attr">scrollamount</span>=<span class="string">"80px"</span></span></span><br><span class="line"><span class="tag"><span class="attr">onmouseover</span>=<span class="string">stop()</span></span></span><br><span class="line"><span class="tag"><span class="attr">onmouseout</span>=<span class="string">start()</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">金风玉露一相逢, 便胜却人间无数.<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">两情若是久长时, 又岂在朝朝暮暮.<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">marquee</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-a9a929dcfc80b834.gif?imageMogr2/auto-orient/strip" alt="当鼠标停留在文字上，文字停止滚动"></p>
<h3 id="八、给滚动字幕加超链接"><a href="#八、给滚动字幕加超链接" class="headerlink" title="八、给滚动字幕加超链接"></a>八、给滚动字幕加超链接</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">marquee</span> <span class="attr">direction</span>=<span class="string">"left"</span></span></span><br><span class="line"><span class="tag"><span class="attr">behavior</span>=<span class="string">"scroll"</span></span></span><br><span class="line"><span class="tag"><span class="attr">scrollamount</span>=<span class="string">"80px"</span></span></span><br><span class="line"><span class="tag"><span class="attr">onmouseover</span>=<span class="string">stop()</span></span></span><br><span class="line"><span class="tag"><span class="attr">onmouseout</span>=<span class="string">start()</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">#</span>&gt;</span>金风玉露<span class="tag">&lt;/<span class="name">a</span>&gt;</span>一相逢, 便胜却人间无数.<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">两情若是久长时, 又岂在朝朝暮暮.<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">marquee</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-5668ad5af1df16db.gif?imageMogr2/auto-orient/strip" alt="给滚动字幕加超链接"></p>
<h3 id="九、综合其它属性"><a href="#九、综合其它属性" class="headerlink" title="九、综合其它属性"></a>九、综合其它属性</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">marquee</span> <span class="attr">direction</span>=<span class="string">"left"</span></span></span><br><span class="line"><span class="tag"><span class="attr">behavior</span>=<span class="string">"scroll"</span></span></span><br><span class="line"><span class="tag"><span class="attr">scrollamount</span>=<span class="string">"30"</span></span></span><br><span class="line"><span class="tag"><span class="attr">scrolldelay</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag"><span class="attr">loop</span>=<span class="string">"-1"</span></span></span><br><span class="line"><span class="tag"><span class="attr">width</span>=<span class="string">"500"</span></span></span><br><span class="line"><span class="tag"><span class="attr">height</span>=<span class="string">"100"</span></span></span><br><span class="line"><span class="tag"><span class="attr">bgcolor</span>=<span class="string">"#FFCCFF"</span></span></span><br><span class="line"><span class="tag"><span class="attr">hspace</span>=<span class="string">"30"</span></span></span><br><span class="line"><span class="tag"><span class="attr">vspace</span>=<span class="string">"10"</span></span></span><br><span class="line"><span class="tag"><span class="attr">onmouseover</span>=<span class="string">this.stop()</span></span></span><br><span class="line"><span class="tag"><span class="attr">onmouseout</span>=<span class="string">start()</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">#</span>&gt;</span>金风玉露<span class="tag">&lt;/<span class="name">a</span>&gt;</span>一相逢, 便胜却人间无数.<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">两情若是久长时, 又岂在朝朝暮暮.<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">marquee</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-d8ef46a6806d1d63.gif?imageMogr2/auto-orient/strip" alt="综合其它属性"></p>
<p>小结：试了 HTML 实现文字滚动效果之后，发现比 iOS 简单方便许多，以后在工作之余会多学学前端知识，求大神带哈😀！</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/Markdown 常用语法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="刘朋坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="以梦为马">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/Markdown 常用语法/" itemprop="url">
                  Markdown 常用语法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>又有朋友入坑程序猿这一神圣而又伟大的职业，问写博客用 <a href="https://zh.wikipedia.org/wiki/Markdown" target="_blank" rel="noopener">Markdown</a> 语法怎么样，表示大力赞同 ，一直以来都觉得 Markdown 语法超级简单方便，这两天年后刚上班，闲来无事，于是整理下平常用到的 Markdown 语法，希望能帮到有需要的道友。</p>
</blockquote>
<h3 id="一、标题"><a href="#一、标题" class="headerlink" title="一、标题"></a>一、标题</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 标题前面加 # 号，一个 # 代表是一级标题</span></span><br><span class="line"># 一级标题</span><br><span class="line">## 二级标题</span><br><span class="line">### 三级标题</span><br><span class="line">#### 四级标题</span><br><span class="line">##### 五级标题</span><br><span class="line">###### 六级标题</span><br></pre></td></tr></table></figure>
<p><strong>效果预览</strong>：</p>
<h1 id="一级标题"><a href="#一级标题" class="headerlink" title="一级标题"></a>一级标题</h1><h2 id="二级标题"><a href="#二级标题" class="headerlink" title="二级标题"></a>二级标题</h2><h3 id="三级标题"><a href="#三级标题" class="headerlink" title="三级标题"></a>三级标题</h3><h4 id="四级标题"><a href="#四级标题" class="headerlink" title="四级标题"></a>四级标题</h4><h5 id="五级标题"><a href="#五级标题" class="headerlink" title="五级标题"></a>五级标题</h5><h6 id="六级标题"><a href="#六级标题" class="headerlink" title="六级标题"></a>六级标题</h6><h3 id="二、区块引用"><a href="#二、区块引用" class="headerlink" title="二、区块引用"></a>二、区块引用</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// `&gt;`后有 1 个空格</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 引用</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 一级引用</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> &gt; 二级引用</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> &gt; &gt; 三级引用</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> &gt; &gt; &gt; 四级引用</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> &gt; &gt; &gt; &gt; 五级引用</span></span><br></pre></td></tr></table></figure>
<p><strong>效果预览</strong>：</p>
<blockquote>
<p>引用</p>
</blockquote>
<blockquote>
<p>一级引用</p>
<blockquote>
<p>二级引用</p>
<blockquote>
<p>三级引用</p>
<blockquote>
<p>四级引用</p>
<blockquote>
<p>五级引用</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<h3 id="三、强调"><a href="#三、强调" class="headerlink" title="三、强调"></a>三、强调</h3><p>三个 <code>*</code> 或 <code>_</code> 代表斜体加粗，两个 <code>*</code> 或 <code>_</code> 代表加粗，一个 <code>*</code> 或 <code>_</code> 代表斜体，<code>~~</code> 代表删除。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="strong">***斜体加粗文本**</span>* 或者 <span class="strong">___斜体加粗文本__</span>_</span><br><span class="line"></span><br><span class="line"><span class="strong">**加粗文本**</span> 或者 <span class="strong">__加粗文本__</span></span><br><span class="line"></span><br><span class="line"><span class="emphasis">*斜体文本*</span>  或者<span class="emphasis">_斜体文本_</span></span><br><span class="line"></span><br><span class="line">~~删除文本~~</span><br></pre></td></tr></table></figure>
<p><strong>效果预览</strong>：</p>
<p><strong><em>斜体加粗文本</em></strong> 或者 <strong><em>斜体加粗文本</em></strong></p>
<p><strong>加粗文本</strong> 或者 <strong>加粗文本</strong></p>
<p><em>斜体文本</em>  或者<em>斜体文本</em></p>
<p><del>删除文本</del></p>
<p>当然以上几种还可以交叉使用，比如<br><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~~*<span class="strong">*删除加粗文本*</span><span class="strong">*~~</span></span><br><span class="line"><span class="strong"></span></span><br><span class="line"><span class="strong">~~*</span>*<span class="strong">*删除斜体加粗文本*</span>*<span class="strong">*~~</span></span><br></pre></td></tr></table></figure></p>
<p><strong>效果预览</strong>：</p>
<p><del><strong>删除加粗文本</strong></del></p>
<p><del><strong><em>删除斜体加粗文本</em></strong></del></p>
<h3 id="四、列表"><a href="#四、列表" class="headerlink" title="四、列表"></a>四、列表</h3><p>Markdown 支持有序列表和无序列表。<br>无序列表使用 <code>*</code> 、<code>-</code>、和 <code>+</code> 作为列表标记：<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">* </span>北京</span><br><span class="line"><span class="bullet">* </span>海淀区</span><br><span class="line"><span class="bullet">* </span>五道口</span><br><span class="line"><span class="bullet">* </span>上海</span><br><span class="line"><span class="bullet">* </span>黄浦区</span><br><span class="line"><span class="bullet">* </span>外滩</span><br><span class="line"><span class="bullet">* </span>广州</span><br><span class="line"><span class="bullet">* </span>广州</span><br><span class="line"><span class="bullet">* </span>广州</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="bullet">- </span>北京</span><br><span class="line"><span class="bullet">- </span>海淀区</span><br><span class="line"><span class="bullet">- </span>五道口</span><br><span class="line"><span class="bullet">- </span>上海</span><br><span class="line"><span class="bullet">- </span>黄浦区</span><br><span class="line"><span class="bullet">- </span>外滩</span><br><span class="line"><span class="bullet">- </span>广州</span><br><span class="line"><span class="bullet">- </span>广州</span><br><span class="line"><span class="bullet">- </span>广州</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="bullet">+ </span>北京</span><br><span class="line"><span class="bullet">+ </span>海淀区</span><br><span class="line"><span class="bullet">+ </span>五道口</span><br><span class="line"><span class="bullet">+ </span>上海</span><br><span class="line"><span class="bullet">+ </span>黄浦区</span><br><span class="line"><span class="bullet">+ </span>外滩</span><br><span class="line"><span class="bullet">+ </span>广州</span><br><span class="line"><span class="bullet">+ </span>广州</span><br><span class="line"><span class="bullet">+ </span>广州</span><br></pre></td></tr></table></figure></p>
<p><strong>效果预览</strong>：</p>
<ul>
<li>北京</li>
<li>海淀区</li>
<li>五道口</li>
<li>上海</li>
<li>黄浦区</li>
<li>外滩</li>
<li>广州</li>
<li>广州</li>
<li>广州</li>
</ul>
<p>有序列表则使用数字加英文句点 <code>.</code> 来表示：<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1. </span>北京</span><br><span class="line"><span class="bullet">2. </span>上海</span><br><span class="line"><span class="bullet">3. </span>广州</span><br></pre></td></tr></table></figure></p>
<p><strong>效果预览</strong>：</p>
<ol>
<li>北京</li>
<li>上海</li>
<li>广州</li>
</ol>
<p>###五、分隔线</p>
<p>可以用三个或三个以上的 <code>*</code> 、<code>-</code>、或 <code>_</code> 来建立分隔线<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">******</span></span><br><span class="line"><span class="string">___</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure></p>
<p><strong>效果预览</strong>：</p>
<hr>
<hr>
<hr>
<h3 id="六、链接"><a href="#六、链接" class="headerlink" title="六、链接"></a>六、链接</h3><p>Markdown 支持三种形式的链接语法： 行内式和参考式和自动链接。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">行内式链接：[<span class="string">_以梦为马</span>](<span class="link">http://www.jianshu.com/u/4f54fbd2ea5f</span>)</span><br><span class="line"></span><br><span class="line">参考式链接：[<span class="string">_以梦为马</span>][<span class="symbol">url</span>]</span><br><span class="line"></span><br><span class="line">// url 为链接标记</span><br><span class="line">[<span class="symbol">url</span>]: <span class="link">http://www.jianshu.com/u/4f54fbd2ea5f</span></span><br><span class="line"></span><br><span class="line">自动链接：<span class="xml"><span class="tag">&lt;<span class="name">http:</span>//<span class="attr">www.jianshu.com</span>/<span class="attr">u</span>/<span class="attr">4f54fbd2ea5f</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p><strong>效果预览</strong>：</p>
<p>行内式链接：<a href="http://www.jianshu.com/u/4f54fbd2ea5f" target="_blank" rel="noopener">_以梦为马</a></p>
<p>参考式链接：<a href="http://www.jianshu.com/u/4f54fbd2ea5f" target="_blank" rel="noopener">_以梦为马</a></p>
<p>自动链接：<a href="http://www.jianshu.com/u/4f54fbd2ea5f" target="_blank" rel="noopener">http://www.jianshu.com/u/4f54fbd2ea5f</a></p>
<h3 id="七、图片"><a href="#七、图片" class="headerlink" title="七、图片"></a>七、图片</h3><p>Markdown 插入图片的方式有两种，分为行内式和参考式，但两者都无法调整图片大小，因此建议在插入图片之前先调整好图片的大小</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">行内式插入图片：![<span class="string">图片描述</span>](<span class="link">http://upload.jianshu.io/users/upload_avatars/2665449/2a2822209b0d.jpeg?imageMogr2/auto-orient/strip|imageView2/1/w/240/h/240</span>)</span><br><span class="line">参考式插入图片：![<span class="string">图片描述</span>][<span class="symbol">image</span>]</span><br><span class="line">[<span class="symbol">image</span>]: <span class="link">http://upload.jianshu.io/users/upload_avatars/2665449/2a2822209b0d.jpeg?imageMogr2/auto-orient/strip|imageView2/1/w/240/h/240</span></span><br></pre></td></tr></table></figure>
<p><strong>效果预览</strong>：</p>
<p>这是行内式插入图片： [图片上传失败…(image-62463-1514895850682)]</p>
<p>这是参考式插入图片：![参考式插入图片][image]<br>[image]: <a href="http://upload.jianshu.io/users/upload_avatars/2665449/2a2822209b0d.jpeg?imageMogr2/auto-orient/strip|imageView2/1/w/240/h/240" target="_blank" rel="noopener">http://upload.jianshu.io/users/upload_avatars/2665449/2a2822209b0d.jpeg?imageMogr2/auto-orient/strip|imageView2/1/w/240/h/240</a></p>
<h3 id="八、代码"><a href="#八、代码" class="headerlink" title="八、代码"></a>八、代码</h3><h5 id="代码分为行内代码和代码框"><a href="#代码分为行内代码和代码框" class="headerlink" title="代码分为行内代码和代码框"></a>代码分为行内代码和代码框</h5><ul>
<li>行内代码就是用两个`把需要添加行内代码的区域包起来。</li>
</ul>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这是行内代码：`<span class="literal">self</span>.<span class="built_in">table</span>View.delegate = <span class="literal">self</span>`</span><br></pre></td></tr></table></figure>
<p><strong>效果预览</strong>：</p>
<p>这是行内代码：<code>self.tableView.delegate = self</code></p>
<ul>
<li>代码框就是用两个 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<p>这是代码框：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">self.tableView.delegate = self;</span><br><span class="line">self.tableView.dataSource = self;</span><br><span class="line">self.tableView.showsVerticalScrollIndicator = NO;</span><br><span class="line">self.tableView.separatorStyle = UITableViewCellSeparatorStyleNone;</span><br><span class="line">```</span><br></pre></td></tr></table></figure></p>
<p><strong>效果预览</strong>：</p>
<p>这是代码框：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">self.tableView.delegate = self;</span><br><span class="line">self.tableView.dataSource = self;</span><br><span class="line">self.tableView.showsVerticalScrollIndicator = NO;</span><br><span class="line">self.tableView.separatorStyle = UITableViewCellSeparatorStyleNone;</span><br></pre></td></tr></table></figure></p>
<h3 id="九、表格"><a href="#九、表格" class="headerlink" title="九、表格"></a>九、表格</h3><ul>
<li>表格对齐方式有三种：</li>
<li>居左：<code>:----</code></li>
<li>居中：<code>:----:</code>或<code>-----</code></li>
<li>居右：<code>----:</code></li>
</ul>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string">标题</span>|<span class="string">标题</span>|<span class="string">标题</span>|</span><br><span class="line">|<span class="string">:---</span>|<span class="string">:---:</span>|<span class="string">---:</span>|</span><br><span class="line">|<span class="string">居左居左居左居左</span>|<span class="string">居中</span>|<span class="string">居右</span>|</span><br><span class="line">|<span class="string">居左</span>|<span class="string">居中居中居中居中</span>|<span class="string">居右</span>|</span><br><span class="line">|<span class="string">居左</span>|<span class="string">居中</span>|<span class="string">居右居右居右居右</span>|</span><br></pre></td></tr></table></figure>
<p><strong>效果预览</strong>：</p>
<table>
<thead>
<tr>
<th style="text-align:left">标题</th>
<th style="text-align:center">标题</th>
<th style="text-align:right">标题</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">居左居左居左居左</td>
<td style="text-align:center">居中</td>
<td style="text-align:right">居右</td>
</tr>
<tr>
<td style="text-align:left">居左</td>
<td style="text-align:center">居中居中居中居中</td>
<td style="text-align:right">居右</td>
</tr>
<tr>
<td style="text-align:left">居左</td>
<td style="text-align:center">居中</td>
<td style="text-align:right">居右居右居右居右</td>
</tr>
</tbody>
</table>
<h3 id="十、脚注"><a href="#十、脚注" class="headerlink" title="十、脚注"></a>十、脚注</h3><p>使用[^]来定义脚注：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">这是一个脚注 [^1]</span><br><span class="line"></span><br><span class="line">[<span class="symbol">^1</span>]: <span class="link">这是一个脚注</span></span><br></pre></td></tr></table></figure>
<p><strong>效果预览</strong>：</p>
<p>这是一个脚注 <a href="这是一个脚注">^1</a></p>
<p>###十一、高级技巧</p>
<ul>
<li>HTML 标签</li>
<li>代码块   <code>&lt;pre&gt;代码块&lt;/pre&gt;</code><br><strong>效果预览</strong>：<pre>代码块</pre></li>
<li>粗斜体 <code>&lt;b&gt; Markdown 加粗 *斜体* &lt;/b&gt;</code><br><strong>效果预览</strong>：<br><b> Markdown 加粗 <em>斜体</em> </b></li>
<li>下划线   <code>&lt;u&gt;下划线&lt;/u&gt;</code><br><strong>效果预览</strong>：<br><u>下划线</u></li>
</ul>
<p>Markdown 中 HTML 标签还有很多，比如<code>&lt;kdb&gt;</code> <code>&lt;i&gt;</code> <code>&lt;em&gt;</code> <code>&lt;sup&gt;</code> <code>&lt;sub&gt;</code> <code>&lt;br&gt;</code> <code>&lt;p&gt;</code>等等，有兴趣的童鞋可以试试。</p>
<ul>
<li>符号转义<figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">\_</span>不想这里的文本变斜体<span class="symbol">\_</span></span><br><span class="line"><span class="symbol">\*</span><span class="symbol">\*</span>不想这里的文本加粗<span class="symbol">\*</span><span class="symbol">\*</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>效果预览</strong>：<br>_不想这里的文本变斜体_<br>**不想这里的文本加粗**</p>
<h3 id="结束语："><a href="#结束语：" class="headerlink" title="结束语："></a>结束语：</h3><p>Markdown 的常用语法基本上都在这里了，另外再推荐一款免费且十分好用的 Markdown 编辑器 <a href="http://25.io/mou/" target="_blank" rel="noopener">Mou</a>（Mac OS X 上）。</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/iOS 开发 - Swift 全面系统的学习（持续更新...）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="刘朋坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="以梦为马">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/iOS 开发 - Swift 全面系统的学习（持续更新...）/" itemprop="url">
                  iOS 开发 - Swift 全面系统的学习（持续更新...）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>最近项目不算紧，于是就学了学 Swift ，看了一大神写的项目<a href="https://github.com/hrscy/DanTang，很受益，感谢开源！另外自己也写了一些基础代码，分享出来，第一是希望得到同行前辈的指导，第二是希望对需要的朋友有所帮助。" target="_blank" rel="noopener">https://github.com/hrscy/DanTang，很受益，感谢开源！另外自己也写了一些基础代码，分享出来，第一是希望得到同行前辈的指导，第二是希望对需要的朋友有所帮助。</a></p>
</blockquote>
<h5 id="先分享一些学习资料："><a href="#先分享一些学习资料：" class="headerlink" title="先分享一些学习资料："></a>先分享一些学习资料：</h5><ul>
<li>学习网站：</li>
<li><p>苹果官方为开发者提供的 Swift 学习资源: <a href="https://developer.apple.com/swift/resources/" target="_blank" rel="noopener">https://developer.apple.com/swift/resources/</a></p>
</li>
<li><p>官方的 API Design: <a href="https://swift.org/documentation/api-design-guidelines/" target="_blank" rel="noopener">https://swift.org/documentation/api-design-guidelines/</a></p>
</li>
<li><p>学习书籍：</p>
</li>
<li><p>TheSwiftProgrammingLanguage(Swift3): 链接:<a href="http://pan.baidu.com/s/1jIopBwi" target="_blank" rel="noopener">http://pan.baidu.com/s/1jIopBwi</a>  密码:dqho</p>
</li>
<li><p>The Swift Programming Language 中文版: 链接:<a href="http://pan.baidu.com/s/1slpxtTj" target="_blank" rel="noopener">http://pan.baidu.com/s/1slpxtTj</a>  密码:xay1</p>
</li>
<li><p>其它学习资料</p>
</li>
<li><a href="https://github.com/Tim9Liu9/TimLiu-iOS/blob/master/Swift.md#swift" target="_blank" rel="noopener">https://github.com/Tim9Liu9/TimLiu-iOS/blob/master/Swift.md#swift</a></li>
<li><a href="https://github.com/ipader/SwiftGuide" target="_blank" rel="noopener">https://github.com/ipader/SwiftGuide</a></li>
</ul>
<hr>
<p><strong>练习的 demo 地址：</strong> <a href="https://github.com/liuzhongning/NNMintFurniture" target="_blank" rel="noopener">https://github.com/liuzhongning/NNMintFurniture</a></p>
<ul>
<li>主要包括以下功能：</li>
<li>多页面滑动视图（分页控制器）</li>
<li>图片轮播</li>
<li>导航栏渐变</li>
<li>瀑布流练习</li>
<li>UIScrollView 练习</li>
<li>照相功能，更换头像</li>
<li>二维码扫描及识别</li>
<li>随机图片验证码封装</li>
<li>圆形输入框封装</li>
<li>第三方库 SnapKit 用法</li>
<li>…………</li>
</ul>
<hr>
<blockquote>
<p>练习 demo 的简单介绍，前方高能预警，大量图片请注意手机流量！</p>
</blockquote>
<h4 id="一、多页面滑动视图（分页控制器）"><a href="#一、多页面滑动视图（分页控制器）" class="headerlink" title="一、多页面滑动视图（分页控制器）"></a>一、多页面滑动视图（分页控制器）</h4><p><img src="http://upload-images.jianshu.io/upload_images/2665449-32882dd38dd1bc87.gif?imageMogr2/auto-orient/strip" alt="多页面滑动视图"></p>
<ul>
<li>核心代码</li>
</ul>
<figure class="highlight roboconf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">// MARK: 点击了标签栏</span><br><span class="line">func titlesClick(button: UIButton) &#123;</span><br><span class="line"><span class="attribute">selectedButton!.isEnabled = true</span></span><br><span class="line"><span class="attribute">selectedButton!.setTitleColor(UIColor.gray, for</span>: <span class="variable">.normal</span>)</span><br><span class="line">button<span class="variable">.isEnabled</span> = false</span><br><span class="line">selectedButton = button</span><br><span class="line">selectedButton?<span class="variable">.setTitleColor</span>(UIColor<span class="variable">.red</span>, for: <span class="variable">.normal</span>)</span><br><span class="line"></span><br><span class="line">var offset = contentView!<span class="variable">.contentOffset</span></span><br><span class="line">offset<span class="variable">.x</span> = CGFloat(button<span class="variable">.tag</span>) * (contentView?<span class="variable">.frame</span><span class="variable">.size</span><span class="variable">.width</span>)!</span><br><span class="line">contentView!<span class="variable">.setContentOffset</span>(offset, animated: true)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// MARK: 点击了右边搜索框</span><br><span class="line">func rightBarButtonClick() &#123;</span><br><span class="line">navigationController?<span class="variable">.pushViewController</span>(NNSearchController(), animated: true)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// MARK: 点击了箭头</span><br><span class="line">func arrowButtonClick(button: UIButton) &#123;</span><br><span class="line">UIView<span class="variable">.animate</span>(withDuration: 0.25) &#123;</span><br><span class="line">button<span class="variable">.imageView</span>?<span class="variable">.transform</span> = button<span class="variable">.imageView</span>!<span class="variable">.transform</span><span class="variable">.rotated</span>(by: CGFloat(Double<span class="variable">.pi</span>))</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// MARK: - UIScrollViewDelegate 代理</span><br><span class="line">// MARK: scrollViewDidEndScrollingAnimation</span><br><span class="line">func scrollViewDidEndScrollingAnimation(_ scrollView: UIScrollView) &#123;</span><br><span class="line">let index = Int(scrollView<span class="variable">.contentOffset</span><span class="variable">.x</span> / scrollView<span class="variable">.frame</span><span class="variable">.size</span><span class="variable">.width</span>)</span><br><span class="line">// 取出子控制器</span><br><span class="line">let vc = childViewControllers[index]</span><br><span class="line">vc<span class="variable">.view</span><span class="variable">.frame</span><span class="variable">.origin</span><span class="variable">.x</span> = scrollView<span class="variable">.contentOffset</span><span class="variable">.x</span></span><br><span class="line">vc<span class="variable">.view</span><span class="variable">.frame</span><span class="variable">.origin</span><span class="variable">.y</span> = 0</span><br><span class="line">// 设置控制器的 view 的 height 值为整个屏幕的高度</span><br><span class="line">vc<span class="variable">.view</span><span class="variable">.frame</span><span class="variable">.size</span><span class="variable">.height</span> = scrollView<span class="variable">.frame</span><span class="variable">.size</span><span class="variable">.height</span></span><br><span class="line">scrollView<span class="variable">.addSubview</span>(vc<span class="variable">.view</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// MARK: scrollViewDidEndDecelerating</span><br><span class="line">func scrollViewDidEndDecelerating(_ scrollView: UIScrollView) &#123;</span><br><span class="line">scrollViewDidEndScrollingAnimation(scrollView)</span><br><span class="line">// 当前索引</span><br><span class="line">let index = Int(scrollView<span class="variable">.contentOffset</span><span class="variable">.x</span> / scrollView<span class="variable">.frame</span><span class="variable">.size</span><span class="variable">.width</span>)</span><br><span class="line">// 点击 Button</span><br><span class="line">let button = titlesView<span class="variable">.subviews</span>[index] as! UIButton</span><br><span class="line">titlesClick(button: button)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="二、图片轮播"><a href="#二、图片轮播" class="headerlink" title="二、图片轮播"></a>二、图片轮播</h4><p><img src="http://upload-images.jianshu.io/upload_images/2665449-0e923b9e52af87c1.gif?imageMogr2/auto-orient/strip" alt="图片轮播"></p>
<ul>
<li>核心代码：</li>
</ul>
<p><strong>轮播图的封装</strong><br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - 懒加载轮播视图</span></span><br><span class="line"><span class="keyword">private</span> lazy var <span class="string">shufflingFigureView :</span> NNShufflingFigureView = &#123;</span><br><span class="line">let frame = CGRect(<span class="string">x:</span> <span class="number">0</span>, <span class="string">y:</span> <span class="number">0</span>, <span class="string">width:</span> NNScreenWidth, <span class="string">height:</span> <span class="number">180</span>)</span><br><span class="line">let imageView = [<span class="string">"shuffling1"</span>, <span class="string">"shuffling2"</span>, <span class="string">"shuffling3"</span>, <span class="string">"shuffling4"</span>]</span><br><span class="line">let shufflingFigureView = NNShufflingFigureView(<span class="string">frame:</span> frame, <span class="string">images:</span> imageView <span class="keyword">as</span> NSArray, <span class="string">autoPlay:</span> <span class="literal">true</span>, <span class="string">delay:</span> <span class="number">3</span>, <span class="string">isFromNet:</span> <span class="literal">false</span>)</span><br><span class="line">shufflingFigureView.delegate = self</span><br><span class="line"><span class="keyword">return</span> shufflingFigureView</span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure></p>
<p><strong>通过代理处理图片的点击事件</strong><br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - 轮播代理方法，处理轮播图的点击事件</span></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">NNItemTableViewController</span>: <span class="title">NNShufflingFigureViewDelegate</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">addShufflingFigureView</span><span class="params">(addShufflingFigureView: NNShufflingFigureView, iconClick index: NSInteger)</span></span> &#123;</span><br><span class="line"><span class="built_in">print</span>(index)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="三、导航栏渐变"><a href="#三、导航栏渐变" class="headerlink" title="三、导航栏渐变"></a>三、导航栏渐变</h4><p><img src="http://upload-images.jianshu.io/upload_images/2665449-b6506cb5fab324c0.gif?imageMogr2/auto-orient/strip" alt="导航栏渐变"></p>
<ul>
<li>核心代码</li>
</ul>
<p><strong>页面滚动时调用</strong><br><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// MARK: - UIScrollViewDelegate 滚动页面时调用</span><br><span class="line">extension NNItemTableViewController &#123;</span><br><span class="line">override func scrollViewDidScroll(_ scrollView: UIScrollView) &#123;</span><br><span class="line"><span class="keyword">if</span> <span class="attr">type</span> == tableViewType.haveHeader &#123;</span><br><span class="line">return</span><br><span class="line">&#125;</span><br><span class="line"><span class="attr">currentPostion</span> = scrollView.contentOffset.y</span><br><span class="line"><span class="keyword">if</span> currentPostion &gt; <span class="number">0</span> &#123;</span><br><span class="line"><span class="keyword">if</span> currentPostion - lastPosition &gt;= <span class="number">0</span> &#123;</span><br><span class="line"><span class="keyword">if</span> topBool &#123;</span><br><span class="line"><span class="attr">topBool</span> = <span class="literal">false</span></span><br><span class="line"><span class="attr">bottomBool</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">stopPosition</span> = currentPostion + <span class="number">64</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="attr">lastPosition</span> = currentPostion</span><br><span class="line">navigationController?.navigationBar.<span class="attr">alpha</span> = <span class="number">1</span> - currentPostion / <span class="number">500</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">if</span> bottomBool &#123;</span><br><span class="line"><span class="attr">bottomBool</span> = <span class="literal">false</span></span><br><span class="line"><span class="attr">topBool</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">stopPosition</span> = currentPostion + <span class="number">64</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="attr">lastPosition</span> = currentPostion</span><br><span class="line">navigationController?.navigationBar.<span class="attr">alpha</span> = (stopPosition - currentPostion) / <span class="number">200</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="四、瀑布流练习"><a href="#四、瀑布流练习" class="headerlink" title="四、瀑布流练习"></a>四、瀑布流练习</h4><p><img src="http://upload-images.jianshu.io/upload_images/2665449-c47f2e1053e05065.gif?imageMogr2/auto-orient/strip" alt="瀑布流练习"></p>
<ul>
<li>核心代码</li>
</ul>
<p><strong>基础设置</strong><br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 布局</span></span><br><span class="line">let layout = NNItemCollectionViewFlowLayout()</span><br><span class="line"><span class="comment">// 创建collectionView</span></span><br><span class="line">let collectionView = UICollectionView.init(frame: view<span class="selector-class">.bounds</span>, collectionViewLayout: layout)</span><br><span class="line">view.addSubview(collectionView)</span><br><span class="line">collectionView<span class="selector-class">.dataSource</span> = self</span><br><span class="line">collectionView<span class="selector-class">.delegate</span> = self</span><br><span class="line">collectionView<span class="selector-class">.backgroundColor</span> = UIColor.white</span><br><span class="line">collectionView.register(UICollectionViewCell<span class="selector-class">.self</span>, forCellWithReuseIdentifier: NNItemCollectionViewControllerID)</span><br></pre></td></tr></table></figure></p>
<p><strong>自定义 UICollectionViewFlowLayout</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - 更新布局</span></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">prepare</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">super</span>.prepare()</span><br><span class="line"><span class="comment">// 清除所有的布局属性</span></span><br><span class="line">attrsArray.removeAll()</span><br><span class="line">columnHeightsAry.removeAll()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="number">_</span> <span class="keyword">in</span> <span class="number">0</span> ..&lt; columnCountDefault &#123;</span><br><span class="line">columnHeightsAry.append(edgeInsetsDefault.top)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sections : <span class="type">Int</span> = (collectionView?.numberOfSections)!</span><br><span class="line"><span class="keyword">for</span> num <span class="keyword">in</span> <span class="number">0</span> ..&lt; sections &#123;</span><br><span class="line"><span class="keyword">let</span> <span class="built_in">count</span> : <span class="type">Int</span> = (collectionView?.numberOfItems(inSection: num))!</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span> ..&lt; <span class="built_in">count</span> &#123;</span><br><span class="line"><span class="keyword">let</span> indexpath : <span class="type">NSIndexPath</span> = <span class="type">NSIndexPath</span>.<span class="keyword">init</span>(item: i, section: num)</span><br><span class="line"><span class="keyword">let</span> attrs = layoutAttributesForItem(at: indexpath <span class="keyword">as</span> <span class="type">IndexPath</span>)!</span><br><span class="line">attrsArray.append(attrs)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - cell 对应的布局属性</span></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">layoutAttributesForItem</span><span class="params">(at indexPath: IndexPath)</span></span> -&gt; <span class="type">UICollectionViewLayoutAttributes</span>? &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> attrs = <span class="type">UICollectionViewLayoutAttributes</span>.<span class="keyword">init</span>(forCellWith: indexPath)</span><br><span class="line"><span class="keyword">let</span> collectionWidth = collectionView?.frame.size.width</span><br><span class="line"><span class="comment">// 获得所有 item 的宽度</span></span><br><span class="line"><span class="keyword">let</span> itemW = (collectionWidth! - edgeInsetsDefault.<span class="keyword">left</span> - edgeInsetsDefault.<span class="keyword">right</span> - <span class="type">CGFloat</span>(columnCountDefault-<span class="number">1</span>) * columnMargin) / <span class="type">CGFloat</span>(columnCountDefault)</span><br><span class="line"><span class="keyword">let</span> itemH = <span class="number">50</span> + arc4random_uniform(<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 找出高度最短那一列</span></span><br><span class="line"><span class="keyword">var</span> dextColum : <span class="type">Int</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">var</span> minH = columnHeightsAry[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span> ..&lt; columnCountDefault&#123;</span><br><span class="line"><span class="comment">// 取出第 i 列的高度</span></span><br><span class="line"><span class="keyword">let</span> columnH = columnHeightsAry[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> minH &gt; columnH &#123;</span><br><span class="line">minH = columnH</span><br><span class="line">dextColum = i</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> x = edgeInsetsDefault.<span class="keyword">left</span> + <span class="type">CGFloat</span>(dextColum) * (itemW + columnMargin)</span><br><span class="line"><span class="keyword">var</span> y = minH</span><br><span class="line"><span class="keyword">if</span> y != edgeInsetsDefault.top&#123;</span><br><span class="line">y = y + itemMargin</span><br><span class="line">&#125;</span><br><span class="line">attrs.frame = <span class="type">CGRect</span>(x: x, y: y, width: itemW, height: <span class="type">CGFloat</span>(itemH))</span><br><span class="line"><span class="comment">// 更新最短那列高度</span></span><br><span class="line">columnHeightsAry[dextColum] = attrs.frame.maxY</span><br><span class="line"><span class="keyword">return</span> attrs</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="五、UIScrollView-练习"><a href="#五、UIScrollView-练习" class="headerlink" title="五、UIScrollView 练习"></a>五、UIScrollView 练习</h4><p><img src="http://upload-images.jianshu.io/upload_images/2665449-f96ca085518cc164.gif?imageMogr2/auto-orient/strip" alt="UIScrollView 练习"></p>
<ul>
<li>核心代码</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - 放大缩小</span></span><br><span class="line"><span class="comment">// MARK: 放大</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">amplificationBtnClick</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> zoomScale = scrollView.zoomScale <span class="comment">// 当前缩放</span></span><br><span class="line">zoomScale += <span class="number">0.1</span></span><br><span class="line"><span class="keyword">if</span> zoomScale &gt;= scrollView.maximumZoomScale &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">self</span>.scrollView.setZoomScale(zoomScale, animated: <span class="literal">true</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: 缩小</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">narrowDownBtnClick</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> zoomScale = scrollView.zoomScale <span class="comment">// 当前缩放</span></span><br><span class="line">zoomScale -= <span class="number">0.1</span></span><br><span class="line"><span class="keyword">if</span> zoomScale &lt;= scrollView.minimumZoomScale &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">self</span>.scrollView.setZoomScale(zoomScale, animated: <span class="literal">true</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - NNItemBtnViewDelegate 上下左右点击代理</span></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">NNItemScrollView</span> </span>&#123;</span><br><span class="line"><span class="comment">// MARK: 向左</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">leftBtnClickDelegate</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> point = <span class="keyword">self</span>.scrollView.contentOffset</span><br><span class="line">point.x += <span class="number">100</span></span><br><span class="line">point.x = point.x &gt;= <span class="keyword">self</span>.scrollView.contentSize.width ? <span class="number">0</span> : point.x</span><br><span class="line">scrollView.setContentOffset(point, animated: <span class="literal">true</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: 向右</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">rightBtnClickDelegate</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> point = <span class="keyword">self</span>.scrollView.contentOffset</span><br><span class="line">point.x -= <span class="number">100</span></span><br><span class="line">point.x = point.x &lt;= -<span class="type">NNScreenWidth</span> ? <span class="number">0</span> : point.x</span><br><span class="line">scrollView.setContentOffset(point, animated: <span class="literal">true</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: 向上</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">topBtnClickDelegate</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> point = <span class="keyword">self</span>.scrollView.contentOffset</span><br><span class="line">point.y += <span class="number">50</span></span><br><span class="line">point.y = point.y &gt;= <span class="keyword">self</span>.scrollView.contentSize.height ? <span class="number">0</span> : point.y</span><br><span class="line">scrollView.setContentOffset(point, animated: <span class="literal">true</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: 向下</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">bottomBtnClickDelegate</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> point = <span class="keyword">self</span>.scrollView.contentOffset</span><br><span class="line">point.y -= <span class="number">50</span></span><br><span class="line">point.y = point.y &lt;= -<span class="type">NNScreenHeight</span> ? <span class="number">0</span> : point.y</span><br><span class="line">scrollView.setContentOffset(point, animated: <span class="literal">true</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="六、照相功能，更换头像（建议用真机）"><a href="#六、照相功能，更换头像（建议用真机）" class="headerlink" title="六、照相功能，更换头像（建议用真机）"></a>六、照相功能，更换头像（建议用真机）</h4><p><img src="http://upload-images.jianshu.io/upload_images/2665449-eedef65d59cce265.gif?imageMogr2/auto-orient/strip" alt="照相功能，更换头像"></p>
<ul>
<li>核心代码</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - 点击头像按钮，更换头像</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">changePicture</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">let</span> alertcontroller = <span class="type">UIAlertController</span>(title: <span class="string">"请选择相片"</span>, message: <span class="literal">nil</span>, preferredStyle: .actionSheet)</span><br><span class="line"><span class="keyword">let</span> alertaction = <span class="type">UIAlertAction</span>(title: <span class="string">"从相册选取"</span>, style: .destructive) &#123; (action) <span class="keyword">in</span></span><br><span class="line"><span class="keyword">let</span> imagePicker = <span class="type">UIImagePickerController</span>()</span><br><span class="line">imagePicker.delegate = <span class="keyword">self</span></span><br><span class="line">imagePicker.sourceType = .photoLibrary</span><br><span class="line">imagePicker.allowsEditing = <span class="literal">true</span></span><br><span class="line"><span class="keyword">self</span>.present(imagePicker, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> alertaction2 = <span class="type">UIAlertAction</span>(title: <span class="string">"拍照"</span>, style: .destructive) &#123; (action) <span class="keyword">in</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="type">UIImagePickerController</span>.isSourceTypeAvailable(.camera)) &#123;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"设备不支持相机"</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> imagePicker = <span class="type">UIImagePickerController</span>()</span><br><span class="line">imagePicker.delegate = <span class="keyword">self</span></span><br><span class="line">imagePicker.sourceType = .camera</span><br><span class="line">imagePicker.allowsEditing = <span class="literal">true</span></span><br><span class="line"><span class="keyword">self</span>.present(imagePicker, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> alertAction3 = <span class="type">UIAlertAction</span>(title: <span class="string">"取消"</span>, style: .cancel) &#123; (action) <span class="keyword">in</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"取消"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">alertcontroller.addAction(alertaction)</span><br><span class="line">alertcontroller.addAction(alertaction2)</span><br><span class="line">alertcontroller.addAction(alertAction3)</span><br><span class="line">present(alertcontroller, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - UIImagePickerControllerDelegate</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">imagePickerController</span><span class="params">(<span class="number">_</span> picker: UIImagePickerController, didFinishPickingMediaWithInfo info: [String : Any])</span></span> &#123;</span><br><span class="line"><span class="keyword">let</span> image = info[<span class="type">UIImagePickerControllerOriginalImage</span>] <span class="keyword">as</span>! <span class="type">UIImage</span></span><br><span class="line">imageView.image = image</span><br><span class="line"><span class="keyword">self</span>.dismiss(animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="七、二维码扫描及识别（建议用真机）"><a href="#七、二维码扫描及识别（建议用真机）" class="headerlink" title="七、二维码扫描及识别（建议用真机）"></a>七、二维码扫描及识别（建议用真机）</h4><p><img src="http://upload-images.jianshu.io/upload_images/2665449-2bdb11d7ef7db000.gif?imageMogr2/auto-orient/strip" alt="二维码扫描及识别"></p>
<ul>
<li>核心代码</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - 扫描设备设置</span></span><br><span class="line">func setupScanSession() &#123;</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line"><span class="comment">// 设置捕捉设备</span></span><br><span class="line">let device = <span class="built_in">AVCaptureDevice</span>.defaultDevice(withMediaType: <span class="built_in">AVMediaTypeVideo</span>)</span><br><span class="line"><span class="comment">// 设置设备输入输出</span></span><br><span class="line">let input = try <span class="built_in">AVCaptureDeviceInput</span>(device: device)</span><br><span class="line">let output = <span class="built_in">AVCaptureMetadataOutput</span>()</span><br><span class="line">output.setMetadataObjectsDelegate(<span class="keyword">self</span>, queue: DispatchQueue.main)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置会话</span></span><br><span class="line">let  scanSession = <span class="built_in">AVCaptureSession</span>()</span><br><span class="line">scanSession.canSetSessionPreset(<span class="built_in">AVCaptureSessionPresetHigh</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> scanSession.canAddInput(input) &#123;</span><br><span class="line">scanSession.addInput(input)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> scanSession.canAddOutput(output) &#123;</span><br><span class="line">scanSession.addOutput(output)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置扫描类型(二维码和条形码)</span></span><br><span class="line">output.metadataObjectTypes = [</span><br><span class="line"><span class="built_in">AVMetadataObjectTypeQRCode</span>,</span><br><span class="line"><span class="built_in">AVMetadataObjectTypeCode39Code</span>,</span><br><span class="line"><span class="built_in">AVMetadataObjectTypeCode128Code</span>,</span><br><span class="line"><span class="built_in">AVMetadataObjectTypeCode39Mod43Code</span>,</span><br><span class="line"><span class="built_in">AVMetadataObjectTypeEAN13Code</span>,</span><br><span class="line"><span class="built_in">AVMetadataObjectTypeEAN8Code</span>,</span><br><span class="line"><span class="built_in">AVMetadataObjectTypeCode93Code</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 预览图层</span></span><br><span class="line">let scanPreviewLayer = <span class="built_in">AVCaptureVideoPreviewLayer</span>(session:scanSession)</span><br><span class="line">scanPreviewLayer!.videoGravity = <span class="built_in">AVLayerVideoGravityResizeAspectFill</span></span><br><span class="line">scanPreviewLayer!.frame = view.layer.bounds</span><br><span class="line"></span><br><span class="line">view.layer.insertSublayer(scanPreviewLayer!, at: <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置扫描区域</span></span><br><span class="line">NotificationCenter.default.addObserver(forName: <span class="built_in">NSNotification</span>.Name.AVCaptureInputPortFormatDescriptionDidChange, object: <span class="literal">nil</span>, queue: <span class="literal">nil</span>, using: &#123; (noti) <span class="keyword">in</span></span><br><span class="line">output.rectOfInterest = (scanPreviewLayer?.metadataOutputRectOfInterest(<span class="keyword">for</span>:<span class="keyword">self</span>.scanImageView.frame))!</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 保存会话</span></span><br><span class="line"><span class="keyword">self</span>.scanSession = scanSession</span><br><span class="line"></span><br><span class="line">&#125; catch &#123;</span><br><span class="line"><span class="comment">// 摄像头不可用</span></span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>扫描完成后调用</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - AVCaptureMetadataOutputObjectsDelegate 扫描捕捉完成</span></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">NNScanCodeController</span> : <span class="title">AVCaptureMetadataOutputObjectsDelegate</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">captureOutput</span><span class="params">(<span class="number">_</span> captureOutput: AVCaptureOutput!, didOutputMetadataObjects metadataObjects: [Any]!, from connection: AVCaptureConnection!)</span></span> &#123;</span><br><span class="line"><span class="comment">// 停止扫描</span></span><br><span class="line">scanLine.layer.removeAllAnimations()</span><br><span class="line">scanSession!.stopRunning()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 扫完完成</span></span><br><span class="line"><span class="keyword">if</span> metadataObjects.<span class="built_in">count</span> &gt; <span class="number">0</span> &#123;</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> resultObj = metadataObjects.first <span class="keyword">as</span>? <span class="type">AVMetadataMachineReadableCodeObject</span> &#123;</span><br><span class="line"><span class="built_in">print</span>(resultObj.stringValue)</span><br><span class="line">scanResult.text = <span class="string">"扫描结果:"</span> + resultObj.stringValue</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>识别验证码，从相册中选择</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - UIImagePickerControllerDelegate, UINavigationControllerDelegate</span></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">NNScanCodeController</span> : <span class="title">UIImagePickerControllerDelegate</span> , <span class="title">UINavigationControllerDelegate</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">imagePickerController</span><span class="params">(<span class="number">_</span> picker: UIImagePickerController, didFinishPickingMediaWithInfo info: [String : Any])</span></span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断是否能取到图片</span></span><br><span class="line"><span class="keyword">guard</span> <span class="keyword">let</span> image = info[<span class="type">UIImagePickerControllerOriginalImage</span>] <span class="keyword">as</span>? <span class="type">UIImage</span> <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 转成ciimage</span></span><br><span class="line"><span class="keyword">guard</span> <span class="keyword">let</span> ciimage = <span class="type">CIImage</span>(image: image) <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 从选中的图片中读取二维码</span></span><br><span class="line"><span class="comment">// 创建探测器</span></span><br><span class="line"><span class="keyword">let</span> detector = <span class="type">CIDetector</span>(ofType: <span class="type">CIDetectorTypeQRCode</span>, context: <span class="literal">nil</span>, options: [<span class="type">CIDetectorAccuracy</span> : <span class="type">CIDetectorAccuracyLow</span>])</span><br><span class="line"><span class="keyword">let</span> resoult = (detector?.features(<span class="keyword">in</span>: ciimage))!</span><br><span class="line">scanResult.text = <span class="string">"无法识别"</span></span><br><span class="line"><span class="keyword">for</span> result <span class="keyword">in</span> resoult &#123;</span><br><span class="line"><span class="keyword">guard</span> (result <span class="keyword">as</span>! <span class="type">CIQRCodeFeature</span>).messageString != <span class="literal">nil</span> <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">scanResult.text = <span class="string">"扫描结果:"</span> + (result <span class="keyword">as</span>! <span class="type">CIQRCodeFeature</span>).messageString!</span><br><span class="line">&#125;</span><br><span class="line">picker.dismiss(animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="八、随机图片验证码封装"><a href="#八、随机图片验证码封装" class="headerlink" title="八、随机图片验证码封装"></a>八、随机图片验证码封装</h4><p><img src="http://upload-images.jianshu.io/upload_images/2665449-7660d135f12c9d38.gif?imageMogr2/auto-orient/strip" alt="随机图片验证码封装"></p>
<ul>
<li>核心代码<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - 绘制图形验证码</span></span><br><span class="line">override func draw(_ <span class="built_in">rect</span>: CGRect) &#123;</span><br><span class="line"><span class="built_in">if</span> charString.isEmpty &#123;</span><br><span class="line"><span class="built_in">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let textString:<span class="keyword">String</span> = charString</span><br><span class="line">let charSize = textString.substring(to: textString.startIndex).<span class="built_in">size</span>(attributes: [NSFontAttributeName : UIFont.systemFont(ofSize: <span class="number">14</span>)])</span><br><span class="line">let <span class="built_in">width</span> = <span class="built_in">rect</span>.<span class="built_in">size</span>.<span class="built_in">width</span> / CGFloat(charCount) - charSize.<span class="built_in">width</span> - <span class="number">15</span>;</span><br><span class="line">let hight = <span class="built_in">rect</span>.<span class="built_in">size</span>.<span class="built_in">height</span> - charSize.<span class="built_in">height</span>;</span><br><span class="line">var <span class="built_in">point</span>: CGPoint</span><br><span class="line"></span><br><span class="line">var pointX: CGFloat</span><br><span class="line">var pointY: CGFloat</span><br><span class="line"><span class="built_in">for</span> i in <span class="number">0.</span>.&lt;textString.characters.count &#123;</span><br><span class="line">let <span class="keyword">char</span> = CGFloat(i)</span><br><span class="line">pointX = (CGFloat)(arc4random() % UInt32(Float(<span class="built_in">width</span>))) + <span class="built_in">rect</span>.<span class="built_in">size</span>.<span class="built_in">width</span> / (CGFloat)(textString.characters.count) * <span class="keyword">char</span></span><br><span class="line">pointY = (CGFloat)(arc4random() % UInt32(Float(hight)))</span><br><span class="line"><span class="built_in">point</span> = CGPoint(x: pointX, y: pointY)</span><br><span class="line">let charStr = textString[textString.index(textString.startIndex, offsetBy:i)]</span><br><span class="line">let <span class="keyword">string</span> = <span class="keyword">String</span>(charStr)</span><br><span class="line"><span class="keyword">string</span>.draw(at: <span class="built_in">point</span>,withAttributes:([NSFontAttributeName : UIFont.systemFont(ofSize: <span class="number">14</span>)]))</span><br><span class="line">&#125;</span><br><span class="line">drawLine(<span class="built_in">rect</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - 绘制干扰线</span></span><br><span class="line">func drawLine(_ <span class="built_in">rect</span>: CGRect) &#123;</span><br><span class="line">let context = UIGraphicsGetCurrentContext()</span><br><span class="line">context!.setLineWidth(<span class="number">1.0</span>)</span><br><span class="line">var pointX = <span class="number">0.0</span></span><br><span class="line">var pointY = <span class="number">0.0</span></span><br><span class="line"><span class="built_in">for</span> _ in <span class="number">0.</span>.&lt;lineCount &#123;</span><br><span class="line">context!.setStrokeColor(randomColor().cgColor)</span><br><span class="line">pointX = Double(arc4random() % UInt32(Float(<span class="built_in">rect</span>.<span class="built_in">size</span>.<span class="built_in">width</span>)))</span><br><span class="line">pointY = Double(arc4random() % UInt32(Float(<span class="built_in">rect</span>.<span class="built_in">size</span>.<span class="built_in">height</span>)))</span><br><span class="line">context?.<span class="built_in">move</span>(to: CGPoint(x: pointX, y: pointY))</span><br><span class="line">pointX = Double(CGFloat(arc4random() % UInt32(Float(<span class="built_in">rect</span>.<span class="built_in">size</span>.<span class="built_in">width</span>))))</span><br><span class="line">pointY = Double(CGFloat(arc4random() % UInt32(Float(<span class="built_in">rect</span>.<span class="built_in">size</span>.<span class="built_in">height</span>))))</span><br><span class="line">context?.addLine(to: CGPoint(x: pointX, y: pointY))</span><br><span class="line">context!.strokePath()</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>OC版本：iOS开发 - 随机图片验证码封装-<a href="http://www.jianshu.com/p/936d2e06fd26" target="_blank" rel="noopener">http://www.jianshu.com/p/936d2e06fd26</a></strong></p>
<h4 id="九、圆形输入框封装"><a href="#九、圆形输入框封装" class="headerlink" title="九、圆形输入框封装"></a>九、圆形输入框封装</h4><p><img src="http://upload-images.jianshu.io/upload_images/2665449-47ebc91140d2ea1c.gif?imageMogr2/auto-orient/strip" alt="圆形输入框封装"></p>
<ul>
<li>核心代码</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - 监听文本输入 核心操作</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">textFieldDidChange</span><span class="params">(<span class="number">_</span> textField: UITextField)</span></span> &#123;</span><br><span class="line"><span class="keyword">let</span> i = textField.text?.characters.<span class="built_in">count</span></span><br><span class="line"><span class="keyword">if</span> i! &gt; labelCount &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> i == <span class="number">0</span> &#123;</span><br><span class="line">((labelArr.object(at: <span class="number">0</span>)) <span class="keyword">as</span>! <span class="type">UILabel</span>).text = <span class="string">""</span></span><br><span class="line">((labelArr.object(at: <span class="number">0</span>)) <span class="keyword">as</span>! <span class="type">UILabel</span>).layer.borderColor = defaultColor.cgColor</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">((labelArr.object(at: (i! - <span class="number">1</span>))) <span class="keyword">as</span>! <span class="type">UILabel</span>).text = (textField.text! <span class="keyword">as</span> <span class="type">NSString</span>).substring(with: <span class="type">NSMakeRange</span>(i! - <span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">((labelArr.object(at: (i! - <span class="number">1</span>))) <span class="keyword">as</span>! <span class="type">UILabel</span>).layer.borderColor = changedColor.cgColor</span><br><span class="line">((labelArr.object(at: (i! - <span class="number">1</span>))) <span class="keyword">as</span>! <span class="type">UILabel</span>).textColor = changedColor</span><br><span class="line"><span class="keyword">if</span> labelCount &gt; i! &#123;</span><br><span class="line">((labelArr.object(at: (i!))) <span class="keyword">as</span>! <span class="type">UILabel</span>).text = <span class="string">""</span></span><br><span class="line">((labelArr.object(at: (i!))) <span class="keyword">as</span>! <span class="type">UILabel</span>).layer.borderColor = defaultColor.cgColor</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - setupUI</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">setupUI</span><span class="params">()</span></span> &#123;</span><br><span class="line">setupTextField()</span><br><span class="line"><span class="keyword">var</span> labelX = <span class="type">CGFloat</span>()</span><br><span class="line"><span class="keyword">let</span> labelY : <span class="type">CGFloat</span> = <span class="number">0.0</span></span><br><span class="line"><span class="keyword">let</span> labelWidth = <span class="keyword">self</span>.width / <span class="type">CGFloat</span>(labelCount)</span><br><span class="line"><span class="keyword">let</span> sideLength = labelWidth &lt; <span class="keyword">self</span>.height ? labelWidth : <span class="keyword">self</span>.height</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..&lt;labelCount &#123;</span><br><span class="line"><span class="keyword">if</span> i == <span class="number">0</span> &#123;</span><br><span class="line">labelX = <span class="number">0</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">labelX = <span class="type">CGFloat</span>(i) * (sideLength + labelDistance)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> label = <span class="type">UILabel</span>(frame: <span class="type">CGRect</span>(x: labelX, y: labelY, width: sideLength, height: sideLength))</span><br><span class="line"><span class="keyword">self</span>.addSubview(label)</span><br><span class="line">label.textAlignment = <span class="type">NSTextAlignment</span>.center</span><br><span class="line">label.layer.borderColor = <span class="type">UIColor</span>.black.cgColor</span><br><span class="line">label.layer.borderWidth = <span class="number">1.0</span></span><br><span class="line">label.layer.cornerRadius = sideLength / <span class="number">2.0</span></span><br><span class="line">labelArr.add(label)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - UITextFieldDelegate</span></span><br><span class="line"><span class="comment">// MARK: 监听输入框</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">textField</span><span class="params">(<span class="number">_</span> textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line"><span class="comment">// 允许删除</span></span><br><span class="line"><span class="keyword">if</span> (string.characters.<span class="built_in">count</span> == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (textField.text?.characters.<span class="built_in">count</span>)! &gt;= labelCount &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// MARK: 回车收起键盘</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">textFieldShouldReturn</span><span class="params">(<span class="number">_</span> textField: UITextField)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">textField.resignFirstResponder()</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>OC版本：iOS开发 - 圆形验证码(或密码)输入框的封装-<a href="http://www.jianshu.com/p/fce6bd4038eb" target="_blank" rel="noopener">http://www.jianshu.com/p/fce6bd4038eb</a></strong></p>
<h4 id="十、第三方库-SnapKit-用法"><a href="#十、第三方库-SnapKit-用法" class="headerlink" title="十、第三方库 SnapKit 用法"></a>十、第三方库 SnapKit 用法</h4><p><img src="http://upload-images.jianshu.io/upload_images/2665449-5e2952f51add8ded.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="第三方库 SnapKit 用法"></p>
<ul>
<li>示例代码<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">func addRedView() &#123;</span><br><span class="line">redView<span class="selector-class">.backgroundColor</span> = UIColor.red</span><br><span class="line">view.addSubview(redView)</span><br><span class="line"></span><br><span class="line"><span class="comment">// redView 距离父视图四条边的距离都是 50</span></span><br><span class="line">redView<span class="selector-class">.snp</span><span class="selector-class">.makeConstraints</span> &#123; (make) <span class="keyword">in</span></span><br><span class="line">make<span class="selector-class">.edges</span><span class="selector-class">.equalTo</span>(view).inset(<span class="number">50</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func addBlueView() &#123;</span><br><span class="line">blueView<span class="selector-class">.backgroundColor</span> = UIColor.blue</span><br><span class="line">view.addSubview(blueView)</span><br><span class="line"></span><br><span class="line"><span class="comment">// blueView 左边距离父视图为 0；上边距离父视图为 0；size 是(50，50)</span></span><br><span class="line">blueView<span class="selector-class">.snp</span><span class="selector-class">.makeConstraints</span> &#123; (make) <span class="keyword">in</span></span><br><span class="line">make<span class="selector-class">.left</span><span class="selector-class">.equalTo</span>(<span class="number">0</span>)</span><br><span class="line">make<span class="selector-class">.top</span><span class="selector-class">.equalTo</span>(<span class="number">0</span>)</span><br><span class="line">make<span class="selector-class">.size</span><span class="selector-class">.equalTo</span>(CGSize(<span class="attribute">width</span>: <span class="number">50</span>, height: <span class="number">50</span>))</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func addBlackView() &#123;</span><br><span class="line">blackView<span class="selector-class">.backgroundColor</span> = UIColor.black</span><br><span class="line">view.addSubview(blackView)</span><br><span class="line"></span><br><span class="line"><span class="comment">// blackView 左边和 redView 的右边距离为 0；大小与 blueView 相同；且与 blueView 上对齐</span></span><br><span class="line">blackView<span class="selector-class">.snp</span><span class="selector-class">.makeConstraints</span> &#123; (make) <span class="keyword">in</span></span><br><span class="line">make<span class="selector-class">.left</span><span class="selector-class">.equalTo</span>(redView<span class="selector-class">.snp</span><span class="selector-class">.right</span>)</span><br><span class="line">make<span class="selector-class">.size</span><span class="selector-class">.equalTo</span>(blueView)</span><br><span class="line">make<span class="selector-class">.top</span><span class="selector-class">.equalTo</span>(blueView)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func addCyanView() &#123;</span><br><span class="line">cyanView<span class="selector-class">.backgroundColor</span> = UIColor.cyan</span><br><span class="line">view.addSubview(cyanView)</span><br><span class="line"></span><br><span class="line"><span class="comment">// cyanView 与 blueView 左对齐；cyanView 的顶部距离 redView 的底部 10；cyanView 的高是40；cyanView 与 blueView 等宽</span></span><br><span class="line">cyanView<span class="selector-class">.snp</span><span class="selector-class">.makeConstraints</span> &#123; (make) <span class="keyword">in</span></span><br><span class="line">make<span class="selector-class">.trailing</span><span class="selector-class">.equalTo</span>(blueView)</span><br><span class="line">make<span class="selector-class">.top</span><span class="selector-class">.equalTo</span>(redView<span class="selector-class">.snp</span><span class="selector-class">.bottom</span>).offset(<span class="number">10</span>)</span><br><span class="line">make<span class="selector-class">.height</span><span class="selector-class">.equalTo</span>(<span class="number">40</span>)</span><br><span class="line">make<span class="selector-class">.width</span><span class="selector-class">.equalTo</span>(blueView)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func addYellowView() &#123;</span><br><span class="line">yellowView<span class="selector-class">.backgroundColor</span> = UIColor.yellow</span><br><span class="line">view.addSubview(yellowView)</span><br><span class="line"></span><br><span class="line"><span class="comment">// yellowView 顶部与 redView 的底部对齐；yellowView 与 blackView 左对齐；yellowView 与 blueView 相同大小</span></span><br><span class="line">yellowView<span class="selector-class">.snp</span><span class="selector-class">.makeConstraints</span> &#123; (make) <span class="keyword">in</span></span><br><span class="line">make<span class="selector-class">.top</span><span class="selector-class">.equalTo</span>(redView<span class="selector-class">.snp</span><span class="selector-class">.bottom</span>)</span><br><span class="line">make<span class="selector-class">.trailing</span><span class="selector-class">.equalTo</span>(blackView)</span><br><span class="line">make<span class="selector-class">.size</span><span class="selector-class">.equalTo</span>(blueView)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func addWhiteView() &#123;</span><br><span class="line">whiteView<span class="selector-class">.backgroundColor</span> = UIColor.white</span><br><span class="line">redView.addSubview(whiteView)</span><br><span class="line"></span><br><span class="line"><span class="comment">// whiteView 的父视图是 redView，距离父视图四条边的距离分别是（30，10，30，10）</span></span><br><span class="line"></span><br><span class="line">whiteView<span class="selector-class">.snp</span><span class="selector-class">.makeConstraints</span> &#123; (make) <span class="keyword">in</span></span><br><span class="line"><span class="comment">// 第一种方式</span></span><br><span class="line">make<span class="selector-class">.edges</span><span class="selector-class">.equalTo</span>(redView).inset(UIEdgeInsets(<span class="attribute">top</span>: <span class="number">30</span>, left: <span class="number">10</span>, bottom: <span class="number">30</span>, right: <span class="number">10</span>))</span><br><span class="line"><span class="comment">// 第二种方式</span></span><br><span class="line"><span class="comment">//            make.top.equalTo(redView).offset(30)</span></span><br><span class="line"><span class="comment">//            make.left.equalTo(redView).offset(10)</span></span><br><span class="line"><span class="comment">//            make.bottom.equalTo(redView).offset(-30)</span></span><br><span class="line"><span class="comment">//            make.right.equalTo(redView).offset(-10)</span></span><br><span class="line"><span class="comment">// 第三种方式</span></span><br><span class="line"><span class="comment">//            make.top.left.bottom.right.equalTo(redView).inset(UIEdgeInsets(top: 30, left: 10, bottom: 30, right: 10))</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<h5 id="详情代码，请移步到-https-github-com-liuzhongning-NNMintFurniture-中查看，如有疑问或有建议的地方，欢迎讨论。另外代码中有一个名为-guide-swift-的类，简单标出了代码的结构，更方便阅读。"><a href="#详情代码，请移步到-https-github-com-liuzhongning-NNMintFurniture-中查看，如有疑问或有建议的地方，欢迎讨论。另外代码中有一个名为-guide-swift-的类，简单标出了代码的结构，更方便阅读。" class="headerlink" title="详情代码，请移步到 https://github.com/liuzhongning/NNMintFurniture 中查看，如有疑问或有建议的地方，欢迎讨论。另外代码中有一个名为 guide.swift 的类，简单标出了代码的结构，更方便阅读。"></a>详情代码，请移步到 <a href="https://github.com/liuzhongning/NNMintFurniture" target="_blank" rel="noopener">https://github.com/liuzhongning/NNMintFurniture</a> 中查看，如有疑问或有建议的地方，欢迎讨论。另外代码中有一个名为 <code>guide.swift</code> 的类，简单标出了代码的结构，更方便阅读。</h5><h5 id="会持续更新……"><a href="#会持续更新……" class="headerlink" title="会持续更新……"></a>会持续更新……</h5>
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/iOS 开发 -《52 个有效方法》读书笔记(1)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="刘朋坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="以梦为马">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/iOS 开发 -《52 个有效方法》读书笔记(1)/" itemprop="url">
                  iOS 开发 -《Effective Objective-C 2.0:编写高质量 iOS 与 OS X 代码的 52 个有效方法》读书笔记(1)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p><strong>《Effective Objective-C 2.0: 编写高质量 iOS 与 OS X 代码的 52 个有效方法》是一本非常经典的 OC 书籍。这本书从语法、接口与 API 设计、内存管理、框架等 7 大方面总结和探讨了 OC 编程中的 52 个特性与陷阱，很值得读。</strong></p>
</blockquote>
<h5 id="文章共分为三篇："><a href="#文章共分为三篇：" class="headerlink" title="文章共分为三篇："></a>文章共分为三篇：</h5><p>第一篇：<a href="https://www.jianshu.com/p/6985ec0666cb" target="_blank" rel="noopener">iOS 开发 -《Effective Objective-C 2.0:编写高质量 iOS 与 OS X 代码的 52 个有效方法》读书笔记(1)</a><br>第二篇：<a href="https://www.jianshu.com/p/72b5525e82e3" target="_blank" rel="noopener">iOS 开发 -《Effective Objective-C 2.0:编写高质量 iOS 与 OS X 代码的 52 个有效方法》读书笔记(2)</a><br>第三篇：<a href="https://www.jianshu.com/p/43fb6ccea4b2" target="_blank" rel="noopener">iOS 开发 -《Effective Objective-C 2.0:编写高质量 iOS 与 OS X 代码的 52 个有效方法》读书笔记(3)</a></p>
<h5 id="文章目录："><a href="#文章目录：" class="headerlink" title="文章目录："></a>文章目录：</h5><blockquote>
<p>第 1 章：熟悉 OC<br>第 2 章：对象、消息、运行期<br>第 3 章：接口与 API 设计<br>第 4 章：协议与分类<br>第 5 章：内存管理<br>第 6 章：块与大中枢派发（block 与 GCD）<br>第 7 章：系统框架</p>
</blockquote>
<h2 id="第-1-章：熟悉-OC"><a href="#第-1-章：熟悉-OC" class="headerlink" title="第 1 章：熟悉 OC"></a>第 1 章：熟悉 OC</h2><h4 id="第-1-条-在类的头文件中尽量少引入其他头文件"><a href="#第-1-条-在类的头文件中尽量少引入其他头文件" class="headerlink" title="第 1 条 - 在类的头文件中尽量少引入其他头文件"></a>第 1 条 - 在类的头文件中尽量少引入其他头文件</h4><p>OC 中应尽量避免在头文件中引用其他类，即比如我们有两个类，<code>NNListViewController</code> 以及 <code>NNHomeViewController</code>，应避免在 <code>NNListViewController.h</code> 中引用 <code>NNHomeViewController</code>，如果非要在 <code>NNListViewController.h</code> 中引入 <code>NNHomeViewController</code>，如下面代码：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NNListViewController</span> : <span class="title">UIViewController</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *name;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *age;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) NNHomeViewController *homeVC;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>这时程序会报错，因为 <code>NNHomeViewController</code> 类并不可见，这时常见的做法是在 <code>NNListViewController.h</code> 中加入下面这行代码</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">import</span> <span class="string">"NNHomeViewController.h"</span></span><br></pre></td></tr></table></figure>
<p>这种方法可行，但是不够优雅。在编译 <code>NNListViewController</code> 类时，不需要知道 <code>NNHomeViewController</code> 类的全部细节，只需要知道有一个类名叫 <code>NNHomeViewController</code> 就好，所以我们应该这样写：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="class"><span class="keyword">class</span> <span class="title">NNHomeViewController</span>;</span></span><br></pre></td></tr></table></figure>
<p>这叫做<strong>“向前声明”该类</strong>。现在 <code>NNListViewController.h</code> 变成了这样：<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@class</span> <span class="title">NNHomeViewController</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NNListViewController</span> : <span class="title">UIViewController</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *name;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *age;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) NNHomeViewController *homeVC;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p><code>NNListViewController</code> 的实现文件需要引入 <code>NNHomeViewController.h</code>，因为若要使用后者，就必须知道其所有接口细节。于是 <code>NNListViewController.m</code> 就是：</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">import</span> <span class="string">"NNListViewController.h"</span></span><br><span class="line">#<span class="keyword">import</span> <span class="string">"NNHomeViewController.h"</span></span><br><span class="line"></span><br><span class="line">@<span class="keyword">implementation</span> NNListViewController</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<ul>
<li>利用向前声明这种写法，有两个好处：</li>
</ul>
<ol>
<li>减少编译时间。在头文件中使用向前声明，不会引入 <code>NNHomeViewController</code> 中的所有内容，只在确有需要的时候才引入，这样会缩减编译时间。</li>
<li>解决了两个类互相引用的问题。假设 <code>NNHomeViewController</code> 类与 <code>NNListViewController</code> 类互相引用，使用 <code>#import</code> 而非 <code>#include</code> 指令虽然不会造成死循环，但会使两个类里有一个无法被正确编译。这个时候我们使用向前声明，就可以解决这个问题。</li>
</ol>
<h4 id="第-2-条-多用字面量语法，少用与之等价的方法"><a href="#第-2-条-多用字面量语法，少用与之等价的方法" class="headerlink" title="第 2 条 - 多用字面量语法，少用与之等价的方法"></a>第 2 条 - 多用字面量语法，少用与之等价的方法</h4><p>编写 OC 代码总会用到几个类，<code>NSString</code>、<code>NSArray</code>、<code>NSNumber</code>、<code>NSDictionary</code>，从类名上即可看出各自所表达的数据结构。<code>NSString</code> 对象有一种简单的创建方式，叫做“字符串字面量”，其语法如下：</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">NSString string</span> = @<span class="string">"Liu Zhong Ning"</span>;</span><br></pre></td></tr></table></figure>
<p>如果不用这种语法，就要以常见的<code>alloc</code> 及 <code>init</code> 方法来分配并初始化 <code>NSString</code> 对象了。同样也能用字面量语法声明 <code>NSArray</code>、<code>NSNumber</code>、<code>NSDictionary</code> 类的实例。<strong>使用字面量语法可以缩减代码长度，使其更为易读。</strong></p>
<ul>
<li><p>非字面量语法：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// NSNumber</span></span><br><span class="line"><span class="built_in">NSNumber</span> *intNumber = [<span class="built_in">NSNumber</span> numberWithInt:<span class="number">1</span>];</span><br><span class="line"><span class="built_in">NSNumber</span> *floatNumber = [<span class="built_in">NSNumber</span> numberWithFloat:<span class="number">6.6</span>f];</span><br><span class="line"><span class="built_in">NSNumber</span> *charNumber = [<span class="built_in">NSNumber</span> numberWithChar:<span class="string">'a'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// NSArray</span></span><br><span class="line"><span class="built_in">NSArray</span> *animals = [<span class="built_in">NSArray</span> arrayWithObjects:<span class="string">@"cat"</span>, <span class="string">@"dog"</span>, <span class="literal">nil</span>];</span><br><span class="line"><span class="comment">// 取下标</span></span><br><span class="line"><span class="built_in">NSString</span> *dog = [animals objectAtIndex:<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// NSDictionary</span></span><br><span class="line"><span class="built_in">NSDictionary</span> *personDic = [<span class="built_in">NSDictionary</span> dictionaryWithObjectsAndKeys:<span class="string">@"Liu Zhong Ning"</span>, <span class="string">@"name"</span>, <span class="number">25</span>, <span class="string">@"age"</span>, <span class="literal">nil</span>];</span><br><span class="line"><span class="comment">// 访问字典</span></span><br><span class="line"><span class="built_in">NSString</span> *name = [personDic objectForKey:<span class="string">@"name"</span>];</span><br></pre></td></tr></table></figure>
</li>
<li><p>字面量语法：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// NSNumber</span></span><br><span class="line"><span class="built_in">NSNumber</span> *intNumber = @<span class="number">1</span>;</span><br><span class="line"><span class="built_in">NSNumber</span> *floatNumber = @<span class="number">6.6</span>f;</span><br><span class="line"><span class="built_in">NSNumber</span> *charNumber = @<span class="string">'a'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NSArray</span></span><br><span class="line"><span class="built_in">NSArray</span> *animals = @[<span class="string">@"cat"</span>, <span class="string">@"dog"</span>];</span><br><span class="line"><span class="comment">// 取下标</span></span><br><span class="line"><span class="built_in">NSString</span> *dog = animals[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// NSDictionary</span></span><br><span class="line"><span class="built_in">NSDictionary</span> *personDic = @&#123;<span class="string">@"name"</span> : <span class="string">@"Liu Zhong Ning"</span>,</span><br><span class="line"><span class="string">@"age"</span> : @<span class="number">25</span>&#125;;</span><br><span class="line"><span class="comment">// 访问字典</span></span><br><span class="line"><span class="built_in">NSString</span> *name = personDic[<span class="string">@"name"</span>];</span><br></pre></td></tr></table></figure>
</li>
<li><p>注意点：用字面量语法创建数组或字典时，若值中有 <code>nil</code>，则会抛出异常。因此，务必确保值里不包含 <code>nil</code>。</p>
</li>
</ul>
<h4 id="第-3-条-多用类型常量，少用-define-预处理指令"><a href="#第-3-条-多用类型常量，少用-define-预处理指令" class="headerlink" title="第 3 条 - 多用类型常量，少用 #define 预处理指令"></a>第 3 条 - 多用类型常量，少用 #define 预处理指令</h4><ul>
<li>定义常量时，有时会用这种方法：</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ANIMATION_DURATION 0.3</span></span><br></pre></td></tr></table></figure>
<p>用预处理指令也可以达到我们想要的效果，但这样定义出来的常量 <strong>没有类型信息</strong>；<br>另外，预处理过程会把碰到的所有 <code>ANIMATION_DURATION</code> 换成 0.3，这样的话，假设此指令声明在某头文件，那么 <strong>所有引入了这个头文件的代码，其<code>ANIMATION_DURATION</code> 都会被替换</strong>。有个办法比用预处理指令来定义常量更好：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="built_in">NSTimeInterval</span> kAnimationDuration = <span class="number">0.3</span>;</span><br></pre></td></tr></table></figure>
<p>可以看出，上面方式定义的常量包含类型信息，可知该常量类型为 <code>NSTimeInterval</code>，这种方式能令阅读代码的人更易理解其意图。另外还应注意常量名称：若常量只用在实现文件，则在前面加字母 <code>k</code>；若常量在类之外可见，则通常以类名为前缀。</p>
<p><strong>变量一定要同时用 <code>static</code> 与 <code>const</code> 来声明。如果试图修改由 <code>const</code> 修饰符所声明的变量，那么编译器就会报错。而 <code>static</code> 修饰符意味着该变量仅在定义此变量的实现文件中可见。</strong>如果不加 <code>static</code>，则编译器会为它创建一个“外部符号”，此时若另一个类中也声明了同名变量，那么编译器就会抛出一条错误消息。</p>
<ul>
<li>要点：</li>
<li><strong>不要用预处理指令定义常量。</strong>这样定义出来的常量不含类型信息，编译器只是会在编译前执行查找与替换操作。即使有人重新定义了常量值，编译器也不会产生警告信息，这将导致应用程序中的常量值不一致。</li>
<li><strong>在实现文件中使用 <code>static const</code> 定义“只在编译单元内可见的常量”。</strong>由于此类常量不再全局符号表中，所以无须为其名称加前缀。</li>
</ul>
<h4 id="第-4-条-用枚举表示状态、选项、状态码"><a href="#第-4-条-用枚举表示状态、选项、状态码" class="headerlink" title="第 4 条 - 用枚举表示状态、选项、状态码"></a>第 4 条 - 用枚举表示状态、选项、状态码</h4><ul>
<li><strong>枚举是一种常量命名方式。当一个对象如果有多种状态时，就可以定义为一个枚举集。</strong></li>
</ul>
<p>比如<code>UITableView</code> 中的 <code>UITableViewStyle</code> 就是一个枚举：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, <span class="built_in">UITableViewStyle</span>) &#123;</span><br><span class="line"><span class="built_in">UITableViewStylePlain</span>,          <span class="comment">// regular table view</span></span><br><span class="line"><span class="built_in">UITableViewStyleGrouped</span>         <span class="comment">// preferences style table view</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>由于每种状态都用一个便于理解的值来表示，所以这样写出来的代码更易读懂。编译器会为枚举分配一个独有的编号，从 <code>0</code> 开始，每个枚举递增 <code>1</code>。</strong></p>
<ul>
<li>在 switch 中使用枚举：</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> : <span class="built_in">NSUInteger</span> &#123;</span><br><span class="line">NNAccountStateInitial = <span class="number">0</span>,        <span class="comment">// 初始</span></span><br><span class="line">NNAccountStateWaitReviewed,       <span class="comment">// 待审核</span></span><br><span class="line">NNAccountStatePassed,             <span class="comment">// 已通过</span></span><br><span class="line">NNAccountStateNoPassed,           <span class="comment">// 未通过</span></span><br><span class="line">NNAccountStateDeactivated,        <span class="comment">// 停用</span></span><br><span class="line">NNAccountStateFreeze,             <span class="comment">// 冻结</span></span><br><span class="line">&#125; NNAccountState;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用</span></span><br><span class="line"><span class="keyword">switch</span> (<span class="keyword">self</span>.accountState) &#123;</span><br><span class="line"><span class="keyword">case</span> NNAccountStateInitial:</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> NNAccountStateWaitReviewed:</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> NNAccountStatePassed:</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> NNAccountStateNoPassed:</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> NNAccountStateDeactivated:</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> NNAccountStateFreeze:</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>要点：</li>
<li>应该用枚举表示状态，给这些值起个易懂的名字。</li>
<li>在处理枚举类型的 <code>switch</code> 语句中，不要实现 <code>default</code> 分支，这样，加入新枚举之后，编译器就会提示开发者：<code>switch</code> 语句并未处理所有的枚举。</li>
</ul>
<h2 id="第-2-章：对象、消息、运行期"><a href="#第-2-章：对象、消息、运行期" class="headerlink" title="第 2 章：对象、消息、运行期"></a>第 2 章：对象、消息、运行期</h2><h4 id="第-5-条-在对象内部尽量直接访问实例变量"><a href="#第-5-条-在对象内部尽量直接访问实例变量" class="headerlink" title="第 5 条 - 在对象内部尽量直接访问实例变量"></a>第 5 条 - 在对象内部尽量直接访问实例变量</h4><p>请看下边这个类。</p>
<p>.h 文件<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NNListViewController</span> : <span class="title">UIViewController</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *lastName;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *firstName;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSString</span> *)fullName;</span><br><span class="line">- (<span class="keyword">void</span>)setFullName:(<span class="built_in">NSString</span> *)fullName;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>.m 文件<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NNListViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">[<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSString</span> *)fullName &#123;</span><br><span class="line"><span class="keyword">return</span> [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@ %@"</span>, <span class="keyword">self</span>.firstName, <span class="keyword">self</span>.lastName];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setFullName:(<span class="built_in">NSString</span> *)fullName &#123;</span><br><span class="line"><span class="built_in">NSArray</span> *compoents = [fullName componentsSeparatedByString:<span class="string">@" "</span>];</span><br><span class="line"><span class="keyword">self</span>.firstName = [compoents objectAtIndex:<span class="number">0</span>];</span><br><span class="line"><span class="keyword">self</span>.firstName = [compoents objectAtIndex:<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>在 fullName 的获取方法与设置方法中，我们使用点语法，通过存取方法来访问相关的实例变量。现在假设重写这两个方法，不经由存取方法，而是直接访问实例变量：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- (NSString *)fullName &#123;</span><br><span class="line"><span class="keyword">return</span> [NSString <span class="string">stringWithFormat:</span>@<span class="string">"%@ %@"</span>, _firstName, _lastName];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)<span class="string">setFullName:</span>(NSString *)fullName &#123;</span><br><span class="line">NSArray *compoents = [fullName <span class="string">componentsSeparatedByString:</span>@<span class="string">" "</span>];</span><br><span class="line">_firstName = [compoents <span class="string">objectAtIndex:</span><span class="number">0</span>];</span><br><span class="line">_firstName = [compoents <span class="string">objectAtIndex:</span><span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>这两种写法有几个区别：</li>
<li>由于不经过 <code>OC</code> 方法派发步骤，所以直接访问实例变量的速度当然比较快，在这种情况下，编译器所生成的代码会直接访问保存对象实例变量的那块内存。</li>
<li>直接访问实例变量不会调用其“设置方法”，这就绕过了为相关属性所定义的“内存管理语义”。比方说，如果在 <code>ARC</code> 下直接访问一个声明为 <code>copy</code> 的属性，那么并不会拷贝该属性，只会保留新值并释放旧值。</li>
<li>如果直接访问实例变量，那么不会触发“键值观测”通知，这样做是否会产生问题，还取决于具体的对象行为。</li>
<li>通过属性来访问有助于排查与之相关的错误，因为可以给“获取方法”或“设置方法”中新增“断点”，监控该属性的调用者及其访问时机。</li>
</ul>
<h4 id="第-6-条-理解“对象等同性”这一概念"><a href="#第-6-条-理解“对象等同性”这一概念" class="headerlink" title="第 6 条 - 理解“对象等同性”这一概念"></a>第 6 条 - 理解“对象等同性”这一概念</h4><p>根据“等同性”来比较对象是一个非常有用的功能，请看下面这段代码，并思考会输出什么：<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">NSString *foo = @<span class="string">"Badger 123"</span><span class="comment">;</span></span><br><span class="line">NSString *<span class="keyword">bar </span>= [NSString stringWithFormat:@<span class="string">"Badger %d"</span>, <span class="number">123</span>]<span class="comment">;</span></span><br><span class="line"><span class="keyword">BOOL </span>equalA = (foo == <span class="keyword">bar);</span></span><br><span class="line"><span class="keyword">BOOL </span>equalB = [foo isEqual:<span class="keyword">bar];</span></span><br><span class="line"><span class="keyword">BOOL </span>equalC = [foo isEqualToString:<span class="keyword">bar];</span></span><br><span class="line"><span class="keyword">NSLog(@"equalA </span>= %d, equalB = %d, equalC = %d<span class="string">", equalA, equalB, equalC);</span></span><br></pre></td></tr></table></figure></p>
<p>这里是输出结果：<code>equalA = 0, equalB = 1, equalC = 1</code></p>
<p>大家可以看到 == 与等同性判断方法之间的差别(== 操作符只是比较了两个指针，而不是指针所指的对象)，NSString 实现了一个自己独有的判断方法，isEqualToString。调用该方法比调用 isEqual 方法快，后者还要执行额外的步骤，因此它不知道受测对象的类型。</p>
<h4 id="第-7-条-以“类族模式”隐藏实现细节"><a href="#第-7-条-以“类族模式”隐藏实现细节" class="headerlink" title="第 7 条 - 以“类族模式”隐藏实现细节"></a>第 7 条 - 以“类族模式”隐藏实现细节</h4><p>“类族”是一种很有用的模式，可以隐藏“抽象基类”背后的实现细节。<code>OC</code> 的系统框架中普遍使用此模式。比如创建 <code>UIButton</code> 时需要调用下面这个方法：<br><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ (instance<span class="keyword">type</span>)buttonWithType:(<span class="type">UIButtonType</span>)buttonType;</span><br></pre></td></tr></table></figure></p>
<p>该方法所返回的对象，其类型取决于传入的按钮类型，然而，不管返回什么类型的对象，它们都继承自同一个基类：<code>UIButton</code>。这么做的意义在于：<code>UIButton</code> 类的使用者无须关心创建出来的按钮具体属于哪个子类，也不用考虑按钮的绘制方式等实现细节。</p>
<ul>
<li>举例创建类族</li>
</ul>
<p>.h 文件<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> : <span class="built_in">NSUInteger</span> &#123;</span><br><span class="line">NNAccountStateInitial = <span class="number">0</span>,        <span class="comment">// 初始</span></span><br><span class="line">NNAccountStateWaitReviewed,       <span class="comment">// 待审核</span></span><br><span class="line">NNAccountStatePassed,             <span class="comment">// 已通过</span></span><br><span class="line">NNAccountStateNoPassed,           <span class="comment">// 未通过</span></span><br><span class="line">NNAccountStateDeactivated,        <span class="comment">// 停用</span></span><br><span class="line">NNAccountStateFreeze,             <span class="comment">// 冻结</span></span><br><span class="line">&#125; NNAccountState;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NNHomeViewController</span> : <span class="title">UIViewController</span></span></span><br><span class="line"></span><br><span class="line">+ (NNHomeViewController *)accountWithState:(NNAccountState)state;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>.m 文件<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">+ (NNHomeViewController *)<span class="string">accountWithState:</span>(NNAccountState)state &#123;</span><br><span class="line"><span class="keyword">switch</span> (state) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">NNAccountStateInitial:</span></span><br><span class="line"><span class="comment">// 做操作</span></span><br><span class="line"><span class="keyword">return</span> [[NNHomeViewController alloc] init];</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">NNAccountStateWaitReviewed:</span></span><br><span class="line"><span class="comment">// 做操作</span></span><br><span class="line"><span class="keyword">return</span> [[NNHomeViewController alloc] init];</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">NNAccountStatePassed:</span></span><br><span class="line"><span class="comment">// 做操作</span></span><br><span class="line"><span class="keyword">return</span> [[NNHomeViewController alloc] init];</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">NNAccountStateNoPassed:</span></span><br><span class="line"><span class="comment">// 做操作</span></span><br><span class="line"><span class="keyword">return</span> [[NNHomeViewController alloc] init];</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">NNAccountStateDeactivated:</span></span><br><span class="line"><span class="comment">// 做操作</span></span><br><span class="line"><span class="keyword">return</span> [[NNHomeViewController alloc] init];</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">NNAccountStateFreeze:</span></span><br><span class="line"><span class="comment">// 做操作</span></span><br><span class="line"><span class="keyword">return</span> [[NNHomeViewController alloc] init];</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li><p>Cocoa 里的类族<br>系统框架中有许多类族。大部分<code>collection</code> 类都是类族，例如 <code>NSArray</code> 与其可变版本 <code>NSMutableArray</code>。这样看来，实际上有两个抽象基类，一个用于不可变数组，一个用于可变数组。尽管具备公共接口的类有两个，但仍然可以合起来算作一个类族。不可变的类定义了对所有数组都通用的方法，而可变的类则定义了那些只适用于可变数组的方法。两个类共属于一类族，这意味着二者在实现各自类型的数组时可以共用实现代码，此外，还能够把可变数组复制为不可变数组，反之亦然。</p>
</li>
<li><p>请看下面这句代码:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">id</span> maybeAnArray;</span><br><span class="line"><span class="comment">// 可以对 maybeAnArray 赋任何值</span></span><br><span class="line"><span class="keyword">if</span> ([maybeAnArray <span class="keyword">class</span>] == [<span class="built_in">NSArray</span> <span class="keyword">class</span>]) &#123; <span class="comment">// 判断永远不会为真</span></span><br><span class="line"><span class="comment">// 不会执行</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>解析代码：<code>NSArray</code> 是个类族，<code>[maybeAnArray class]</code> 所返回的绝不可能是 <code>NSArray</code> 本身，因为由 <code>NSArray</code> 的初始化方法所返回的那个实例其类型是隐藏在类族公共接口后面的某个内部类型。<br>不过仍然有办法可以判断出某个实例所属的类是否位于类族之中。若想判断某对象是否位于类族中，不要直接检测两个类对象是否相同，而应该采用下列代码：<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">id maybeAnArray;</span><br><span class="line"><span class="comment">// 对 maybeAnArray 赋任何值</span></span><br><span class="line"><span class="keyword">if</span> ([maybeAnArray <span class="string">isKindOfClass:</span>[NSArray <span class="class"><span class="keyword">class</span>]]) &#123;</span></span><br><span class="line"><span class="comment">// 会执行</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="第-8-条：在既有类中使用关联对象存放自定义数据"><a href="#第-8-条：在既有类中使用关联对象存放自定义数据" class="headerlink" title="第 8 条：在既有类中使用关联对象存放自定义数据"></a>第 8 条：在既有类中使用关联对象存放自定义数据</h4><p>在 OC 中可以通过 Category 给一个现有的类添加属性，但却不能添加实例变量，这似乎成为了 OC 的一个短板。值得庆幸的是，<code>OC</code> 中有一项强大的特性可以解决此问题，这就是关联对象<code>（Associated Object）</code>。</p>
<ul>
<li><p>看下这几个方法：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 需要导入头文件</span></span><br><span class="line"><span class="meta">#import &lt;objc/runtime.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据给定的键和策略为某对象设置关联对象值</span></span><br><span class="line"><span class="function">OBJC_EXPORT <span class="keyword">void</span> <span class="title">objc_setAssociatedObject</span>(<span class="params">id <span class="keyword">object</span>, <span class="keyword">const</span> <span class="keyword">void</span> *key, id <span class="keyword">value</span>, objc_AssociationPolicy policy</span>)</span>;</span><br><span class="line"><span class="comment">// 根据给定的键从某对象获取相应的关联对象值</span></span><br><span class="line"><span class="function">OBJC_EXPORT id <span class="title">objc_getAssociatedObject</span>(<span class="params">id <span class="keyword">object</span>, <span class="keyword">const</span> <span class="keyword">void</span> *key</span>)</span>;</span><br><span class="line"><span class="comment">// 移除指定对象的全部关联对象</span></span><br><span class="line"><span class="function">OBJC_EXPORT <span class="keyword">void</span> <span class="title">objc_removeAssociatedObjects</span>(<span class="params">id <span class="keyword">object</span></span>)</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>解析代码：<code>id object</code>给谁设置关联对象；<code>const void *key</code>关联对象唯一的 key ，获取时会用到的主键；<code>id value</code>关联对象；<code>objc_AssociationPolicy</code>关联策略，关联策略以下几种：</p>
</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">typedef OBJC_ENUM(uintptr_t, objc_AssociationPolicy) &#123;</span><br><span class="line">OBJC_ASSOCIATION_ASSIGN = <span class="number">0</span>,           <span class="comment">/**&lt; Specifies a weak reference to the associated object. */</span></span><br><span class="line">OBJC_ASSOCIATION_RETAIN_NONATOMIC = <span class="number">1</span>, <span class="comment">/**&lt; Specifies a strong reference to the associated object.</span></span><br><span class="line"><span class="comment">*   The association is not made atomically. */</span></span><br><span class="line">OBJC_ASSOCIATION_COPY_NONATOMIC = <span class="number">3</span>,   <span class="comment">/**&lt; Specifies that the associated object is copied.</span></span><br><span class="line"><span class="comment">*   The association is not made atomically. */</span></span><br><span class="line">OBJC_ASSOCIATION_RETAIN = <span class="number">01401</span>,       <span class="comment">/**&lt; Specifies a strong reference to the associated object.</span></span><br><span class="line"><span class="comment">*   The association is made atomically. */</span></span><br><span class="line">OBJC_ASSOCIATION_COPY = <span class="number">01403</span>          <span class="comment">/**&lt; Specifies that the associated object is copied.</span></span><br><span class="line"><span class="comment">*   The association is made atomically. */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>关联对象有很多细节很多坑需要注意，想了解更多关联对象的童鞋请看这篇文章：<a href="http://blog.csdn.net/shaobo8910/article/details/47748727" target="_blank" rel="noopener">Objective-C Associated Objects 的实现原理。</a></p>
<h4 id="第-9-条：理解-objc-msgSend-的作用"><a href="#第-9-条：理解-objc-msgSend-的作用" class="headerlink" title="第 9 条：理解 objc_msgSend 的作用"></a>第 9 条：理解 objc_msgSend 的作用</h4><p>在 OC 中，如果向某个对象传递消息，那就会在运行时使用动态绑定<code>（dynamic binding）</code>机制来决定需要调用的方法。但是到了底层具体实现，却是普通的C语言函数实现的。这个实现的函数就是<code>objc_msgSend</code>,该函数定义如下：</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">void</span> objc_msgSend(id <span class="built_in">self</span>, SEL cmd, <span class="params">...</span>)</span><br></pre></td></tr></table></figure>
<p>第一个参数代表<code>接收者</code>，第二个参数代表<code>选择子</code>（<code>SEL是选择子的类型，选择子即方法名字</code>），后续参数就是消息中的那些<code>参数</code>，其顺序不变。</p>
<ul>
<li>举个例子:</li>
</ul>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">id returnValue</span> = [someObject messageName:parameter];</span><br></pre></td></tr></table></figure>
<p>代码解析：<code>objc_msgSend</code> 函数会依据接收者与选择子的类型来调用适当的方法。函数首先会在接收者所属的类中搜寻其方法列表，如果能找到这个跟选择子名称相同的方法，就跳转至其实现代码。若是当前类没找到，那就沿着继承体系向上查找，等找到合适方法之后再跳转 ，如果最终还是找不到，那就进入消息转发的流程去进行处理了。</p>
<h3 id="第-10-条：理解消息转发机制"><a href="#第-10-条：理解消息转发机制" class="headerlink" title="第 10 条：理解消息转发机制"></a>第 10 条：理解消息转发机制</h3><p><strong>当对象接收到无法解读的消息后，就会启动“消息转发”<code>（message forwarding）</code>机制</strong>，我们可以通过代码在消息转发的过程中告诉对象应该如何处理未知的消息，系统默认是抛出异常，控制台给出提示代码如下：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unrecognized selector sent <span class="keyword">to</span><span class="built_in"> instance </span>0x7f8c8a70a380</span><br></pre></td></tr></table></figure>
<p><strong>消息转发机制所讲的就是在抛出异常之前也就是消息转发过程中经过的一些步骤。</strong></p>
<h5 id="消息转发机制分为两个阶段："><a href="#消息转发机制分为两个阶段：" class="headerlink" title="消息转发机制分为两个阶段："></a>消息转发机制分为两个阶段：</h5><ul>
<li>第一阶段先征询接收者，所属的类，看其是否能动态添加方法，以处理当前这个“未知的选择子”<code>（unknown selector）</code>，这叫做“动态方法解析”<code>（dynamic method resolution）</code>。</li>
<li>第二阶段涉及“完整的消息转发机制”<code>（full forwarding mechanism）</code>。如果运行期系统已经把第一阶段执行完了，那么接收者自己就无法再以动态新增方法的手段来响应包含该选择子的消息了。此时，运行期系统会请求接收者以其他手段来处理与消息相关的方法调用。这又细分为两小步。</li>
<li>首先，请接收者看看有没有其他对象能处理这条消息。</li>
<li><p>若有，则运行期系统会把消息转给那个对象，于是消息转发过程结束，一切如常。若没有“备援的接收者”<code>（replacement receiver）</code>，则启动完整的消息转发机制，运行期系统会把与消息有关的全部细节都封装到 <code>NSInvocation</code> 对象中，再给接收者最后一次机会，令其设法解决当前还未处理的这条消息。</p>
</li>
<li><p>消息转发全流程：<br><img src="http://upload-images.jianshu.io/upload_images/2665449-22dab42fdda6386d.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="消息转发全流程"></p>
</li>
</ul>
<h3 id="第-11-条：用“方法调配技术”调试“黑盒方法”"><a href="#第-11-条：用“方法调配技术”调试“黑盒方法”" class="headerlink" title="第 11 条：用“方法调配技术”调试“黑盒方法”"></a>第 11 条：用“方法调配技术”调试“黑盒方法”</h3><p>这条讲的主要内容就是方法调配<code>( Method Swizzling)</code>，通过运行时用另外一种方法实现来替换掉原有的方法实现，往往被应用在向原有实现中添加新功能，打印信息等。</p>
<ul>
<li>如何互换两个方法实现？具体主要用下面两个方法</li>
</ul>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">class_getInstanceMethod(<span class="keyword">Class</span> _Nullable cls, SEL _Nonnull name)</span><br><span class="line">method_exchangeImplementations(<span class="function"><span class="keyword">Method</span> _<span class="title">Nonnull</span> <span class="title">m1</span>, <span class="title">Method</span> _<span class="title">Nonnull</span> <span class="title">m2</span>)</span></span><br></pre></td></tr></table></figure>
<p>首先我们写一个分类，比如为<code>NSString</code>写一个“分类”<code>（category）</code>：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"NSString+extension.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;objc/runtime.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NSString</span> (<span class="title">extension</span>)</span></span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)load &#123;</span><br><span class="line">Method oldMethod = class_getInstanceMethod([<span class="built_in">NSString</span> <span class="keyword">class</span>], <span class="keyword">@selector</span>(lowercaseString));</span><br><span class="line">Method newMethod = class_getInstanceMethod([<span class="built_in">NSString</span> <span class="keyword">class</span>], <span class="keyword">@selector</span>(new_lowercaseString));</span><br><span class="line">method_exchangeImplementations(oldMethod, newMethod);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSString</span> *)new_lowercaseString &#123;</span><br><span class="line"><span class="built_in">NSString</span> *lowerString = [<span class="keyword">self</span> new_myLowercaseString];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@ - %@"</span>, <span class="keyword">self</span>, lowerString);</span><br><span class="line"><span class="keyword">return</span> lowerString;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>解析代码：<code>+ (void)load</code>中会调换<code>lowercaseString</code>方法与<code>new_lowercaseString</code>方法；在方法<code>- (NSString *)new_lowercaseString</code>中，<code>[self new_myLowercaseString]</code>，我们调用<code>new_myLowercaseString</code>方法，此时不会引起死循环，因为这个方法是与<code>lowercaseString</code>方法调换的。</p>
<p>此时我们在<code>NSString</code>实例中调用<code>lowercaseString</code>方法：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">[<span class="keyword">super</span> viewDidLoad];</span><br><span class="line"><span class="built_in">NSString</span> *string = <span class="string">@"Talk is cheap, Show me the code."</span>;</span><br><span class="line"><span class="built_in">NSString</span> *lowercaseString = [string lowercaseString];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, lowercaseString);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打印效果图如下：<br><img src="http://upload-images.jianshu.io/upload_images/2665449-fc0ce6698f16a1a5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="打印效果图"></p>
<p>通过此方案，开发者可以为那些“完全不知道其具体实现的”<code>（completely opaque，“完全不透明的”）</code>黑盒方法增加日志记录功能，这非常有助于程序调试。然而，此做法只在调试程序时有用。很少有人在调试程序之外的场合用上述“方法调配技术”来永久改动某个类的功能。不能仅仅因为<code>OC</code>语言里有这个特性就一定要用它。若是滥用，反而会令代码变得不易读懂且难于维护。</p>
<h3 id="第-12-条：理解“类对象”的用意"><a href="#第-12-条：理解“类对象”的用意" class="headerlink" title="第 12 条：理解“类对象”的用意"></a>第 12 条：理解“类对象”的用意</h3><p><strong>类是一个对象，是<code>Class</code> 类型的对象，简称“类对象”。</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">objc_class</span> *<span class="title">Class</span>;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>类型查询方法：</li>
</ul>
<p>可以用类型信息查询方法来检视类继承体系。<code>“isMemberOfClass:”</code>能够判断出对象是否为某个特定类的实例，而<code>“isKindOfClass:”</code>则能够判断出对象是否为某类或其派生类的实例。例如：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableDictionary</span> *dict = [<span class="built_in">NSMutableDictionary</span> new];</span><br><span class="line">[dict isMemberOfClass:[<span class="built_in">NSDictionary</span> <span class="keyword">class</span>]]; <span class="comment">///&lt; NO</span></span><br><span class="line">[dict isMemberOfClass:[<span class="built_in">NSMutableDictionary</span> <span class="keyword">class</span>]]; <span class="comment">///&lt; YES</span></span><br><span class="line">[dict isKindOfClass:[<span class="built_in">NSDictionary</span> <span class="keyword">class</span>]]; <span class="comment">///&lt; YES</span></span><br><span class="line">[dict isKindOfClass:[<span class="built_in">NSArray</span> <span class="keyword">class</span>]]; <span class="comment">///&lt; NO</span></span><br></pre></td></tr></table></figure>
<p>比较类对象是否等同的办法来判断，使用<code>==操作符</code>，而不要使用比较<code>OC</code>对象时常用的<code>“isEqual:”</code>方法。原因在于，类对象是<code>“单例”（singleton）</code>，在应用程序范围内，每个类的<code>Class</code>仅有一个实例。</p>
<ul>
<li>要点：</li>
<li>每个实例都有一个指向<code>Class</code> 对象的指针，用以表明其类型，而这些 <code>Class</code>对象则构成了类的继承体系。</li>
<li>如果对象类型无法在编译期确定，那么就应该使用类型信息查询方法来探知。</li>
<li>尽量使用类型信息查询方法来确定对象类型，而不要直接比较类对象，因为某些对象可能实现了消息转发功能。</li>
</ul>
<p><br><br></p>
<hr>
<p>下一篇：<a href="https://www.jianshu.com/p/72b5525e82e3" target="_blank" rel="noopener">iOS 开发 -《Effective Objective-C 2.0:编写高质量 iOS 与 OS X 代码的 52 个有效方法》读书笔记(2)</a></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/iOS 开发 -《52 个有效方法》读书笔记(2)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="刘朋坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="以梦为马">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/iOS 开发 -《52 个有效方法》读书笔记(2)/" itemprop="url">
                  iOS 开发 -《Effective Objective-C 2.0:编写高质量 iOS 与 OS X 代码的 52 个有效方法》读书笔记(2)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="文章共分为三篇："><a href="#文章共分为三篇：" class="headerlink" title="文章共分为三篇："></a>文章共分为三篇：</h5><p>第一篇：<a href="https://www.jianshu.com/p/6985ec0666cb" target="_blank" rel="noopener">iOS 开发 -《Effective Objective-C 2.0:编写高质量 iOS 与 OS X 代码的 52 个有效方法》读书笔记(1)</a><br>第二篇：<a href="https://www.jianshu.com/p/72b5525e82e3" target="_blank" rel="noopener">iOS 开发 -《Effective Objective-C 2.0:编写高质量 iOS 与 OS X 代码的 52 个有效方法》读书笔记(2)</a><br>第三篇：<a href="https://www.jianshu.com/p/43fb6ccea4b2" target="_blank" rel="noopener">iOS 开发 -《Effective Objective-C 2.0:编写高质量 iOS 与 OS X 代码的 52 个有效方法》读书笔记(3)</a></p>
<p>接上篇：<a href="https://www.jianshu.com/p/6985ec0666cb" target="_blank" rel="noopener">iOS 开发 -《Effective Objective-C 2.0:编写高质量 iOS 与 OS X 代码的 52 个有效方法》读书笔记(1)</a></p>
<hr>
<h2 id="第-3-章：接口与-API-设计"><a href="#第-3-章：接口与-API-设计" class="headerlink" title="第 3 章：接口与 API 设计"></a>第 3 章：接口与 API 设计</h2><h3 id="第-13-条：用前缀避免命名空间冲突"><a href="#第-13-条：用前缀避免命名空间冲突" class="headerlink" title="第 13 条：用前缀避免命名空间冲突"></a>第 13 条：用前缀避免命名空间冲突</h3><p><code>OC</code>没有其他语言那种内置的命名空间机制。因此我们起名时要设法避免潜在的命名冲突，否则很容易重名，引发命名冲突<code>（naming clash）</code>。避免此问题的唯一方法就是变相实现命名空间：为所有名称都加上适当前缀。所选前缀可以是与公司、应用程序或二者皆有关联之名。另外，<code>Apple</code>宣称其保留使用所有“两字母前缀”，所以我们一般还是三个字母开头比较好。</p>
<h3 id="第-14-条：提供“全能初始化方法”"><a href="#第-14-条：提供“全能初始化方法”" class="headerlink" title="第 14 条：提供“全能初始化方法”"></a>第 14 条：提供“全能初始化方法”</h3><p><strong>能够为对象提供必要信息以便其完成工作的初始化方法叫做“全能初始化方法”。</strong></p>
<p>如果创建类实例的方式不止一种，那么这个类就会有多个初始化方法。这当然很好，不过仍然要在其中选定一个作为全能初始化方法，令其它初始化方法都来调用它。这样的话，当底层数据存储机制改变时，只需修改此方法的代码就好，无须改动其他初始化方法。</p>
<p><code>NSDate</code>就是一个例子，其初始化方法如下：<br><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- (instance<span class="keyword">type</span>)init <span class="type">NS_DESIGNATED_INITIALIZER</span>;</span><br><span class="line">- (instance<span class="keyword">type</span>)initWithTimeIntervalSinceReferenceDate:(<span class="type">NSTimeInterval</span>)ti <span class="type">NS_DESIGNATED_INITIALIZER</span>;</span><br><span class="line">- (nullable instance<span class="keyword">type</span>)initWithCoder:(<span class="type">NSCoder</span> *)aDecoder <span class="type">NS_DESIGNATED_INITIALIZER</span>;</span><br><span class="line">- (instance<span class="keyword">type</span>)initWithTimeIntervalSinceNow:(<span class="type">NSTimeInterval</span>)secs;</span><br><span class="line">- (instance<span class="keyword">type</span>)initWithTimeIntervalSince1970:(<span class="type">NSTimeInterval</span>)secs;</span><br><span class="line">- (instance<span class="keyword">type</span>)initWithTimeInterval:(<span class="type">NSTimeInterval</span>)secsToBeAdded sinceDate:(<span class="type">NSDate</span> *)date;</span><br></pre></td></tr></table></figure></p>
<p>在上面几个初始化方法中，<code>initWithTimeIntervalSinceReferenceDate:</code>是全能初始化方法，也就是说，其余的初始化方法都要调用它。只有在全能初始化方法中，才会存储内部数据。</p>
<h3 id="第-15-条：实现-description-方法"><a href="#第-15-条：实现-description-方法" class="headerlink" title="第 15 条：实现 description 方法"></a>第 15 条：实现 description 方法</h3><p>调试程序时，经常需要打印并查看对象信息。一种办法是编写代码把对象的全部属性都输出到日志中。不过最常用的做法还是像下面这样：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NSLog</span>(@<span class="string">"object = %@"</span>, <span class="class"><span class="keyword">object</span>)</span>;</span><br></pre></td></tr></table></figure>
<p>这样直接打印我们的对象它会输出 <code>&lt;Object:0x*****&gt;</code>，这并不是我们想要的，所以当我们重写<code>description</code>的时候才可能满足我们调试的需求。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">NSString</span> *)description &#123;</span><br><span class="line"><span class="keyword">return</span> [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@ : %@, %@"</span>, [<span class="keyword">self</span> <span class="keyword">class</span>], <span class="keyword">self</span>, <span class="string">@"你需要的属性"</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>若想在调试时打印出更详尽的对象描述信息，则应实现 <code>- (NSString *)debugDescription;</code>方法，再与<code>po</code>命令一起使用配合调试。</p>
<h3 id="第-16-条：尽量使用不可变对象"><a href="#第-16-条：尽量使用不可变对象" class="headerlink" title="第 16 条：尽量使用不可变对象"></a>第 16 条：尽量使用不可变对象</h3><p>这条主要讲的是，尽量使用不可变的对象。简单来说，我们设计出来一个类，其实是不希望别人更改其属性的，因此应该尽量把对外公布出来的属性设置为只读，而且只在确有必要时才将属性对外公布。</p>
<h3 id="第-17-条：使用清晰而协调的命名方式"><a href="#第-17-条：使用清晰而协调的命名方式" class="headerlink" title="第 17 条：使用清晰而协调的命名方式"></a>第 17 条：使用清晰而协调的命名方式</h3><p>类、方法及变量的命名是 <code>OC</code> 编程的重要环节。这点就不用多说了，具体可以看下官方的命名规则：<a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/CodingGuidelines/CodingGuidelines.html#//apple_ref/doc/uid/10000146-SW1" target="_blank" rel="noopener">Coding Guidelines for Cocoa</a></p>
<h3 id="第-18-条：为私有方法名加前缀"><a href="#第-18-条：为私有方法名加前缀" class="headerlink" title="第 18 条：为私有方法名加前缀"></a>第 18 条：为私有方法名加前缀</h3><p>这样有助于调试，也很容易让我们将公共方法和私有方法区分开，另外便于修改方法名。但是要注意不要但用一个下划线做私有方法的前缀，因为这种做法是预留给苹果公司的。</p>
<h3 id="第-19-条：理解-Objective-C-错误模型"><a href="#第-19-条：理解-Objective-C-错误模型" class="headerlink" title="第 19 条：理解 Objective-C 错误模型"></a>第 19 条：理解 Objective-C 错误模型</h3><p>当前很多种编程语言都有异常处理机制，<code>OC</code>也不例外。在<code>OC</code>中异常只用于处理<code>严重错误(fatal error)</code>，出现<code>“不那么严重的错误(nonfatal error)”</code>时，OC语言的处理方式是：令方法返回 <code>nil/0</code>，或者使用<code>NSError</code>，以表明有错误发生。</p>
<h3 id="第-20-条：理解-NSCopying-协议"><a href="#第-20-条：理解-NSCopying-协议" class="headerlink" title="第 20 条：理解 NSCopying 协议"></a>第 20 条：理解 NSCopying 协议</h3><p>在  <code>OC</code> 中，拷贝对象通过<code>copy</code>方法完成，如果想令自己的类支持拷贝操作，那就要实现<code>NSCopying</code>协议，该协议只有一个方法：<br><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- <span class="params">(id)</span>copyWithZone:<span class="params">(NSZone*)</span>zone</span><br></pre></td></tr></table></figure></p>
<p>当然如果要求返回对象是可变的类型就要用到<code>NSMutableCopying</code>协议，相应方法：</p>
<figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- <span class="params">(id)</span>mutableCopyWithZone:<span class="params">(NSZone *)</span>zone</span><br></pre></td></tr></table></figure>
<ul>
<li>在拷贝对象时，需要注意拷贝执行的是深拷贝还是浅拷贝。</li>
<li>深拷贝的意思就是：在拷贝对象自身时，会将对象的底层数据也进行复制。</li>
<li><p>浅拷贝是只拷贝容器对象本身，而不拷贝其中数据。<code>Foundation</code> 框架中所有的<code>collection</code> 类在默认情况下都执行浅拷贝。</p>
</li>
<li><p>要点：</p>
</li>
<li>若想令自己所写的对象具有拷贝功能，则需实现<code>NSCopying</code>协议。</li>
<li>如果自定义的对象分为可变版本与不可变版本，那么就要同时实现<code>NSCopying</code>与<code>NSMutableCopying</code>协议。</li>
<li>复制对象时需决定采用浅拷贝还是深拷贝，一般情况下应该尽量执行浅拷贝。</li>
<li>如果你所写的对象需要深拷贝，那么可考虑新增一个专门执行深拷贝的方法。</li>
</ul>
<h2 id="第-4-章：协议与分类"><a href="#第-4-章：协议与分类" class="headerlink" title="第 4 章：协议与分类"></a>第 4 章：协议与分类</h2><h3 id="第-21-条：通过委托与数据源协议进行对象间通信"><a href="#第-21-条：通过委托与数据源协议进行对象间通信" class="headerlink" title="第 21 条：通过委托与数据源协议进行对象间通信"></a>第 21 条：通过委托与数据源协议进行对象间通信</h3><p>简单来说，这条讲的是使用<code>delegate</code>，<code>protocal</code>进行数据传递。此模式可将数据与业务逻辑解耦。需要注意的是：修饰<code>delegate</code>的属性一定要定义成<code>weak</code>，而非<code>strong</code>，因为两者之间必须为“非拥有关系”。</p>
<h3 id="第-22-条：将类的实现代码分散到便于管理的数个分类之中"><a href="#第-22-条：将类的实现代码分散到便于管理的数个分类之中" class="headerlink" title="第 22 条：将类的实现代码分散到便于管理的数个分类之中"></a>第 22 条：将类的实现代码分散到便于管理的数个分类之中</h3><p>这条讲的是使用分类。类中经常容易填满各种方法，而这些方法的代码则全部堆在一个巨大的实现文件里。有时这么做是合理的，因为即便通过重构把这个类打散，效果也不会更好。在此情况下，可以通过<code>OC</code>的“分类”机制，将类代码按逻辑划入几个分区中，这对开发与调试都有好处。</p>
<h3 id="第-23-条：总是为第三方类的分类名称加前缀"><a href="#第-23-条：总是为第三方类的分类名称加前缀" class="headerlink" title="第 23 条：总是为第三方类的分类名称加前缀"></a>第 23 条：总是为第三方类的分类名称加前缀</h3><p>这条也很容易理解，就是给分类名加前缀，比如<code>NSString</code>分类，</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@interface</span> NSString (HTTP)</span><br><span class="line"></span><br><span class="line"><span class="variable">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 加前缀</span></span><br><span class="line"><span class="variable">@interface</span> NSString (ABC_HTTP)</span><br><span class="line"></span><br><span class="line"><span class="variable">@end</span></span><br></pre></td></tr></table></figure>
<p>给分类加上前缀，易于区分，并且能避免不必要的错误。</p>
<h3 id="第-24-条：勿在分类中声明属性"><a href="#第-24-条：勿在分类中声明属性" class="headerlink" title="第 24 条：勿在分类中声明属性"></a>第 24 条：勿在分类中声明属性</h3><p>除了 <code>Class-continuation</code>分类，其他分类无法向类中新增实例变量，这样就无法把实现属性所需要的实例变量合成出来，即无法生成实例变量，如下图：<br><img src="http://upload-images.jianshu.io/upload_images/2665449-83e1a4ac405c62c7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h3 id="第-25-条：使用-“Class-continuation分类”-隐藏实现细节"><a href="#第-25-条：使用-“Class-continuation分类”-隐藏实现细节" class="headerlink" title="第 25 条：使用 “Class-continuation分类” 隐藏实现细节"></a>第 25 条：使用 “Class-continuation分类” 隐藏实现细节</h3><p><code>Class-continuation</code>分类和普通的分类不同，它必须定义在其所接续的那个类的实现文件里。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"NNTestClass.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NNTestClass</span> ()</span></span><br><span class="line"><span class="comment">// 写你所需要的私有变量或方法</span></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NNTestClass</span></span></span><br><span class="line"><span class="comment">// 实现</span></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>这条和之前的描述也有点类似，总之就是在说尽量不要在公共接口中暴露太多内容，隐藏其实现细节。</p>
<h3 id="第-26-条：通过协议提供匿名对象"><a href="#第-26-条：通过协议提供匿名对象" class="headerlink" title="第 26 条：通过协议提供匿名对象"></a>第 26 条：通过协议提供匿名对象</h3><ul>
<li>协议可以在某种程度上提供匿名对象，例如<code>id&lt;someProtocal&gt; object</code>。<code>object</code>对象的类型不限，只要能遵从这个协议即可，在这个协议里面定义了这个对象所应该实现的方法。</li>
<li>使用匿名对象来隐藏类型名称（或类名）。</li>
<li>如果具体类型不重要，重要的是对象能否处理好一些特定的方法，那么就可以使用这种协议匿名对象来完成。</li>
</ul>
<h2 id="第-5-章：内存管理"><a href="#第-5-章：内存管理" class="headerlink" title="第 5 章：内存管理"></a>第 5 章：内存管理</h2><h3 id="第-27-条：理解引用计数"><a href="#第-27-条：理解引用计数" class="headerlink" title="第 27 条：理解引用计数"></a>第 27 条：理解引用计数</h3><p><code>OC</code> 使用引用计数器来管理内存，每个对象都有个可以递增或递减的计数器。对象创建好之后，其保留计数至少为<code>1</code>，若保留计数为正，则对象继续存活，当保留计数降为<code>0</code>时，对象被销毁。<br>在对象的生命周期中，其余对象通过引用来保留或释放此对象。保留或释放操作分别会递增或递减保留计数。</p>
<p>注意<code>retain</code>,<code>release</code>,<code>autorelease</code>,这三个方法操作计数器。</p>
<ul>
<li><code>retain</code>递增保留计数。</li>
<li><code>release</code>递减保留计数。</li>
<li><code>autorelease</code>待稍后清理“自动释放池”时，再递减保留计数。</li>
</ul>
<h3 id="第-28-条：以-ARC-简化引用计数"><a href="#第-28-条：以-ARC-简化引用计数" class="headerlink" title="第 28 条：以 ARC 简化引用计数"></a>第 28 条：以 ARC 简化引用计数</h3><p><code>ARC</code>，即自动管理计数器，理解起来很容易。<br><code>ARC</code>会自动执行<code>retain</code>,<code>release</code>,<code>autorelease</code>等操作，所以直接在<code>ARC</code>中调用这些内存管理方法是非法的。具体来说，<code>ARC</code>不能调用以下方法:</p>
<ul>
<li>retain</li>
<li>release</li>
<li>autorelease</li>
<li>dealloc</li>
</ul>
<p>在<code>ARC</code>中，变量的内存管理语义可以通过修饰符指明，而原来则需手工执行”保留“及释放操作;(<code>__strong</code>,<code>__weak</code>,一个保留值，一个不保留值)。<br>注意的是<code>ARC</code>只负责管理<code>OC</code>对象的内存。注意：<code>CoreFoundation</code>对象不归<code>ARC</code>管理，必须适时调用<code>CFRetain/CFRelease</code>。</p>
<h3 id="第-29-条：在-dealloc-方法中只释放引用并解除监听"><a href="#第-29-条：在-dealloc-方法中只释放引用并解除监听" class="headerlink" title="第 29 条：在 dealloc 方法中只释放引用并解除监听"></a>第 29 条：在 dealloc 方法中只释放引用并解除监听</h3><p>不要在<code>delloc</code>方法中调用其它方法，尤其是需要异步执行某些任务又要回调的方法，这样是很危险的行为，很可能异步执行完回调的时候该对象已经被销毁了，<code>crash</code>了。</p>
<p>在<code>delloc</code>方法里，应该做的事情就是释放指向其他对象的引用，并取消原来订阅的键值观测（<code>KVO</code>）或<code>NSNotificationCenter</code>等通知，不要做其它事情。</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">dealloc</span> &#123;</span><br><span class="line"><span class="selector-attr">[[NSNotificationCenter defaultCenter]</span> <span class="selector-tag">removeObserver</span><span class="selector-pseudo">:self</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="第-30-条：编写-“异常安全代码”-时留意内存管理问题"><a href="#第-30-条：编写-“异常安全代码”-时留意内存管理问题" class="headerlink" title="第 30 条：编写 “异常安全代码” 时留意内存管理问题"></a>第 30 条：编写 “异常安全代码” 时留意内存管理问题</h3><p>这条也和上面说过的类似，有两点需要注意：</p>
<ul>
<li><p>捕获异常时，一定要注意将<code>try</code>块内所创立的对象清理干净。</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@try</span> &#123; <span class="comment">// 可能会出现崩溃的代码</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">@catch</span> (NSException *exception) &#123; <span class="comment">// 捕获到的异常 exception</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">@finally</span> &#123; <span class="comment">// 结果处理,也可以去掉</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在默认情况下，<code>ARC</code> 不生成安全处理异常所需的清理代码。开启编译器标志后，可生成这种代码，不过会导致应用程序变大，而且会降低运行效率。</p>
</li>
</ul>
<h3 id="第-31-条：以弱引用避免保留环"><a href="#第-31-条：以弱引用避免保留环" class="headerlink" title="第 31 条：以弱引用避免保留环"></a>第 31 条：以弱引用避免保留环</h3><p>这个也很容易理解，保留环就是我们常说的循环引用。就是有时候我们需要将某些引用设为<code>weak</code>，避免出现“保留环”。</p>
<h3 id="第-32-条：以“自动释放池块”降低内存峰值"><a href="#第-32-条：以“自动释放池块”降低内存峰值" class="headerlink" title="第 32 条：以“自动释放池块”降低内存峰值"></a>第 32 条：以“自动释放池块”降低内存峰值</h3><p><strong>合理运用自动释放池，可降低应用程序的内存峰值。</strong></p>
<ul>
<li>请看下面几行代码：<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSArray</span> *dataArray = <span class="comment">/*****/</span>;</span><br><span class="line"><span class="built_in">NSMutableArray</span> *testArray = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">NSDictionary</span> *recordDic <span class="keyword">in</span> dataArray) &#123;</span><br><span class="line">TestPerson *person = [[TestPerson alloc] initWithRecord:recordDic];</span><br><span class="line">[testArray addObject:person];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>当循环长度无法预估，需要创建很多对象时，上面代码会创造数量无法预估的临时对象，即内存中会出现很多不必要的临时对象，他们本该提早回收的。这时我们可以给这段代码增加一个释放池：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSArray</span> *dataArray = <span class="comment">/*****/</span>;</span><br><span class="line"><span class="built_in">NSMutableArray</span> *testArray = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">NSDictionary</span> *recordDic <span class="keyword">in</span> dataArray) &#123;</span><br><span class="line"><span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">TestPerson *person = [[TestPerson alloc] initWithRecord:recordDic];</span><br><span class="line">[testArray addObject:person];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样临时对象就可以及时回收了，有一点需要注意：<strong>不要把<code>for</code>循环放到释放池里面，特别是循环长度特别长的时候。</strong></p>
<h3 id="第-33-条：用“僵尸对象”调试内存管理问题"><a href="#第-33-条：用“僵尸对象”调试内存管理问题" class="headerlink" title="第 33 条：用“僵尸对象”调试内存管理问题"></a>第 33 条：用“僵尸对象”调试内存管理问题</h3><p><img src="http://upload-images.jianshu.io/upload_images/2665449-0d8e02375074cf0c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="僵尸对象"></p>
<p>如上图，启动这项调试功能之后，运行期系统在回收对象时，会把它的<code>isa</code>指针指向特殊的僵尸类，而不是真正的回收他们。系统会修改对象的<code>isa</code>指针，令其指向特殊的僵尸类，从而使该对象变为僵尸对象。僵尸类能够响应所有的选择子，响应方式为：打印一条包含消息内容以及其接收者的消息，然后终止应用程序。</p>
<h3 id="第-34-条：不要使用-retainCount"><a href="#第-34-条：不要使用-retainCount" class="headerlink" title="第 34 条：不要使用 retainCount"></a>第 34 条：不要使用 retainCount</h3><p><code>retainCount</code>，对象的保留计数，<code>ARC</code>环境下已经正式废弃，在<code>MRC</code>下还可以正常使用。</p>
<p><br><br></p>
<hr>
<p>下一篇：<a href="https://www.jianshu.com/p/43fb6ccea4b2" target="_blank" rel="noopener">iOS 开发 -《Effective Objective-C 2.0:编写高质量 iOS 与 OS X 代码的 52 个有效方法》读书笔记(3)</a></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/iOS 开发中导航栏渐变的两种方法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="刘朋坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="以梦为马">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/iOS 开发中导航栏渐变的两种方法/" itemprop="url">
                  iOS 开发中导航栏渐变的两种方法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>很多 APP 都有导航栏颜色渐变的效果，各位开发者也都八仙过海各显神通，各有各的方法，我这里提供两种思路：<strong>第一种是通过设置 navigationBar 的 alpha；第二种是在 navigationBar 上加入一个 view，再设置 view 的 alpha。</strong></p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-d8f9e18b30189a3b.gif?imageMogr2/auto-orient/strip" alt="导航栏渐变"><br>两种方法的核心代码：</p>
<h4 id="一、设置-navigationBar-的-alpha"><a href="#一、设置-navigationBar-的-alpha" class="headerlink" title="一、设置 navigationBar 的 alpha"></a>一、设置 navigationBar 的 alpha</h4><p>向上滑和向下滑时分别对 navigationBar 的透明度进行设置。<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#pragma mark - UIScrollViewDelegate</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidScroll:(<span class="built_in">UIScrollView</span> *)scrollView &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">self</span>.currentPostion = scrollView.contentOffset.y;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.currentPostion &gt; <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.currentPostion - <span class="keyword">self</span>.lastPosition &gt;= <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.topBool) &#123;</span><br><span class="line"><span class="keyword">self</span>.topBool = <span class="literal">NO</span>;</span><br><span class="line"><span class="keyword">self</span>.bottomBool = <span class="literal">YES</span>;</span><br><span class="line"><span class="keyword">self</span>.stopPosition = <span class="keyword">self</span>.currentPostion + <span class="number">64</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">self</span>.lastPosition = <span class="keyword">self</span>.currentPostion;</span><br><span class="line"><span class="keyword">self</span>.navigationController.navigationBar.alpha = <span class="number">1</span> - <span class="keyword">self</span>.currentPostion / <span class="number">500</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.bottomBool) &#123;</span><br><span class="line"><span class="keyword">self</span>.bottomBool = <span class="literal">NO</span>;</span><br><span class="line"><span class="keyword">self</span>.topBool = <span class="literal">YES</span>;</span><br><span class="line"><span class="keyword">self</span>.stopPosition = <span class="keyword">self</span>.currentPostion + <span class="number">64</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">self</span>.lastPosition = <span class="keyword">self</span>.currentPostion;</span><br><span class="line"><span class="keyword">self</span>.navigationController.navigationBar.alpha = (<span class="keyword">self</span>.stopPosition - <span class="keyword">self</span>.currentPostion) / <span class="number">200</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这里要说明一点，<strong>如果你不希望自己 navigationBar 上的按钮也被改变透明度，可以通过自定义 UINavigationController 实现。用系统的 navigationBar 时，navigationBar上的按钮的透明度也会被更改。</strong></p>
<hr>
<h4 id="二、在-navigationBar-上加入一个-view"><a href="#二、在-navigationBar-上加入一个-view" class="headerlink" title="二、在 navigationBar 上加入一个 view"></a>二、在 navigationBar 上加入一个 view</h4><p>在 navigationBar 上加一个 view，然后设置 view 的 alpha。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">CGSize</span> customSize = <span class="keyword">self</span>.navigationController.navigationBar.frame.size;</span><br><span class="line"><span class="keyword">self</span>.customView = [[<span class="built_in">UIView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">-20</span>, customSize.width, customSize.height + <span class="number">20</span>)];</span><br><span class="line"><span class="keyword">self</span>.customView.backgroundColor = [<span class="built_in">UIColor</span> orangeColor];</span><br><span class="line"><span class="keyword">self</span>.customView.userInteractionEnabled = <span class="literal">NO</span>;</span><br><span class="line">[<span class="keyword">self</span>.navigationController.navigationBar insertSubview: <span class="keyword">self</span>.customView atIndex:<span class="number">0</span>];</span><br></pre></td></tr></table></figure>
<p>这里也要说明一点，<strong>View 的 userInteractionEnabled 属性要设置为 NO，不然会出现问题。</strong></p>
<p>UIScrollViewDelegate 的这个代理方法与上面的一样。<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#pragma mark - UIScrollViewDelegate</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidScroll:(<span class="built_in">UIScrollView</span> *)scrollView &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">self</span>.currentPostion = scrollView.contentOffset.y;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.currentPostion &gt; <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.currentPostion - <span class="keyword">self</span>.lastPosition &gt;= <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.topBool) &#123;</span><br><span class="line"><span class="keyword">self</span>.topBool = <span class="literal">NO</span>;</span><br><span class="line"><span class="keyword">self</span>.bottomBool = <span class="literal">YES</span>;</span><br><span class="line"><span class="keyword">self</span>.stopPosition = <span class="keyword">self</span>.currentPostion + <span class="number">64</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">self</span>.lastPosition = <span class="keyword">self</span>.currentPostion;</span><br><span class="line"><span class="keyword">self</span>.customView.alpha = <span class="number">1</span> - <span class="keyword">self</span>.currentPostion / <span class="number">500</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.bottomBool) &#123;</span><br><span class="line"><span class="keyword">self</span>.bottomBool = <span class="literal">NO</span>;</span><br><span class="line"><span class="keyword">self</span>.topBool = <span class="literal">YES</span>;</span><br><span class="line"><span class="keyword">self</span>.stopPosition = <span class="keyword">self</span>.currentPostion + <span class="number">64</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">self</span>.lastPosition = <span class="keyword">self</span>.currentPostion;</span><br><span class="line"><span class="keyword">self</span>.customView.alpha = (<span class="keyword">self</span>.stopPosition - <span class="keyword">self</span>.currentPostion) / <span class="number">200</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>上面的两种方法都可以实现导航栏渐变，只是思路不同，一个是改变系统的导航栏，一个是在导航栏上插入 View，另外还可以自定义导航控制器这个类来实现，各位道友可以试试哦！</p>
<h4 id="代码传送门-欢迎各位道友交流或指出错误！"><a href="#代码传送门-欢迎各位道友交流或指出错误！" class="headerlink" title="代码传送门 欢迎各位道友交流或指出错误！"></a><a href="https://github.com/liuzhongning/NNJaneBook" target="_blank" rel="noopener">代码传送门</a> 欢迎各位道友交流或指出错误！</h4>
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/iOS 开发 -《52 个有效方法》读书笔记(3)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="刘朋坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="以梦为马">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/iOS 开发 -《52 个有效方法》读书笔记(3)/" itemprop="url">
                  iOS开发之 - 银联支付
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="文章共分为三篇："><a href="#文章共分为三篇：" class="headerlink" title="文章共分为三篇："></a>文章共分为三篇：</h5><p>第一篇：<a href="https://www.jianshu.com/p/6985ec0666cb" target="_blank" rel="noopener">iOS 开发 -《Effective Objective-C 2.0:编写高质量 iOS 与 OS X 代码的 52 个有效方法》读书笔记(1)</a><br>第二篇：<a href="https://www.jianshu.com/p/72b5525e82e3" target="_blank" rel="noopener">iOS 开发 -《Effective Objective-C 2.0:编写高质量 iOS 与 OS X 代码的 52 个有效方法》读书笔记(2)</a><br>第三篇：<a href="https://www.jianshu.com/p/43fb6ccea4b2" target="_blank" rel="noopener">iOS 开发 -《Effective Objective-C 2.0:编写高质量 iOS 与 OS X 代码的 52 个有效方法》读书笔记(3)</a></p>
<p>接上篇：<a href="https://www.jianshu.com/p/72b5525e82e3" target="_blank" rel="noopener">iOS 开发 -《Effective Objective-C 2.0:编写高质量 iOS 与 OS X 代码的 52 个有效方法》读书笔记(2)</a></p>
<h2 id="第-6-章-块与大中枢派发"><a href="#第-6-章-块与大中枢派发" class="headerlink" title="第 6 章 块与大中枢派发"></a>第 6 章 块与大中枢派发</h2><h3 id="第-35-条：理解-“块”这一概念"><a href="#第-35-条：理解-“块”这一概念" class="headerlink" title="第 35 条：理解 “块”这一概念"></a>第 35 条：理解 “块”这一概念</h3><p><code>blcok</code>和函数类似，它是直接定义在另一个函数里的，和定义它的那个函数共享同一个范围的东西。用<code>^</code>来表示，后面接一对大括号，括号里是<code>blcok</code>的实现代码。</p>
<ul>
<li>格式： 返回类型 （^blockName）(参数){实现代码};</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 无返回值无参数</span></span><br><span class="line"><span class="keyword">void</span>(^testBlcok)(<span class="keyword">void</span>) = ^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"testBlcok"</span>);</span><br><span class="line">&#125;;</span><br><span class="line">testBlcok(); <span class="comment">// print："testBlcok"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 无返回值有参数</span></span><br><span class="line"><span class="keyword">void</span>(^testBlcok)(<span class="keyword">int</span> a) = ^(<span class="keyword">int</span> a) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%d"</span>, a);</span><br><span class="line">&#125;;</span><br><span class="line">testBlcok(<span class="number">5</span>); <span class="comment">// print："5"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 有返回值有参数</span></span><br><span class="line"><span class="keyword">int</span> (^addBlock)(<span class="keyword">int</span> a, <span class="keyword">int</span> b) = ^(<span class="keyword">int</span> a, <span class="keyword">int</span> b) &#123;</span><br><span class="line"><span class="keyword">return</span> a + b;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%d"</span>, addBlock(<span class="number">13</span>, <span class="number">6</span>)); <span class="comment">// print："19"</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>block</code>可以访问局部变量，但是不能修改，如果修改局部变量，需要加<code>__block</code></p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">__block NSInteger <span class="built_in">count</span> = <span class="number">0</span><span class="comment">;</span></span><br><span class="line">int <span class="keyword">additional </span>= <span class="number">5</span><span class="comment">;</span></span><br><span class="line">int (^<span class="keyword">addBlock)(int </span>a, int <span class="keyword">b) </span>= ^(int a, int <span class="keyword">b) </span>&#123;</span><br><span class="line"><span class="built_in">count</span> = <span class="built_in">count</span> + <span class="number">10</span><span class="comment">;</span></span><br><span class="line">return a + <span class="keyword">b </span>+ <span class="keyword">additional;</span></span><br><span class="line"><span class="keyword">&#125;;</span></span><br><span class="line"><span class="keyword">NSLog(@"addBlock </span>= %d<span class="string">", addBlock(13, 6)); // print："</span><span class="number">24</span><span class="string">"</span></span><br><span class="line"><span class="string">NSLog(@"</span><span class="built_in">count</span> = %ld<span class="string">", count); // print："</span><span class="number">10</span><span class="string">"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>另外关于<code>block</code>的修饰符应该注意：<br>1.如果用<code>copy</code>修饰<code>Block</code>，该<code>Block</code>就会存储在堆空间。则会对<code>Block</code>的内部对象进行强引用，导致循环引用。内存无法释放。<br>解决方法：新建一个指针<code>(__weak typeof(Target) weakTarget = Target )</code>指向<code>Block</code>代码块里的对象，然后用<code>weakTarget</code>进行操作。就可以解决循环引用问题。<br>2.如果用<code>weak</code>修饰<code>Block</code>，该<code>Block</code>就会存放在栈空间。不会出现循环引用问题。</p>
</li>
</ul>
<h3 id="第-36-条：为常用的块类型创建-typedef"><a href="#第-36-条：为常用的块类型创建-typedef" class="headerlink" title="第 36 条：为常用的块类型创建 typedef"></a>第 36 条：为常用的块类型创建 typedef</h3><p>为常用的块类型创建 <code>typedef</code>，主要是为了代码的易读性，用的时候也较为方便。请看下面代码对比：<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一种写法</span></span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">testWithBlockString</span><span class="selector-pseudo">:(NSString</span> *)<span class="selector-tag">string</span> <span class="selector-tag">withBlock</span><span class="selector-pseudo">:(void(</span>^)(id dataSource))<span class="selector-tag">block</span>;</span><br><span class="line"><span class="comment">/* 这种写法非常难记，也很难懂，用的时候不方便 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二种写法</span></span><br><span class="line"><span class="selector-tag">typedef</span> <span class="selector-tag">void</span> (^testBlock)(id dataSource);</span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">testWithBlockString</span><span class="selector-pseudo">:(NSString</span> *)<span class="selector-tag">string</span> <span class="selector-tag">withBlockName</span><span class="selector-pseudo">:(testBlock)block</span>;</span><br><span class="line"><span class="comment">/* 用 typedef 关键字，为常用的块类型起个别名，方便易懂 */</span></span><br></pre></td></tr></table></figure></p>
<h3 id="第-37-条：用-handler-块降低代码分散程度"><a href="#第-37-条：用-handler-块降低代码分散程度" class="headerlink" title="第 37 条：用 handler 块降低代码分散程度"></a>第 37 条：用 handler 块降低代码分散程度</h3><p>在<code>iOS</code>开发中，我们经常会异步处理一些任务，然后等任务执行结束后通知相关方法。实现此需求的方法有很多，比如可以选择代理委托，也可以选择<code>block</code>。<code>block</code>更轻型，使用更简单，能够直接访问上下文，这样类中不需要存储临时数据，使用<code>block</code>的代码通常会在同一个地方，这样使代码更连贯，可读性好。<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">typedef</span> <span class="selector-tag">void</span> (^testBlock)(id dataSource);</span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">testWithBlockString</span><span class="selector-pseudo">:(NSString</span> *)<span class="selector-tag">string</span> <span class="selector-tag">withBlockName</span><span class="selector-pseudo">:(testBlock)block</span>;</span><br></pre></td></tr></table></figure></p>
<h3 id="第-38-条：用块引用其所属对象时不要出现保留环"><a href="#第-38-条：用块引用其所属对象时不要出现保留环" class="headerlink" title="第 38 条：用块引用其所属对象时不要出现保留环"></a>第 38 条：用块引用其所属对象时不要出现保留环</h3><p>这条讲的比较基础，是<code>iOS</code>中<code>block</code>的循环引用问题。所谓循环引用，就是两个对象相互持有，这样就会造成循环引用。</p>
<ul>
<li><p>请看下面代码：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">void</span> (^testBlock)(<span class="keyword">id</span> dataSource);</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) testBlock block;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *blockString;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)testBlock &#123;</span><br><span class="line"><span class="keyword">self</span>.block = ^(<span class="keyword">id</span> dataSource) &#123;</span><br><span class="line"><span class="built_in">NSString</span> *blockString = <span class="keyword">self</span>.blockString;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"blockString = %@"</span>, blockString);</span><br><span class="line">&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>代码截图：</p>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-92afc35d076a4c15.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="block 循环引用"></p>
<ul>
<li>解决方法：<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)testBlock &#123;</span><br><span class="line">__<span class="keyword">weak</span> <span class="keyword">typeof</span>(<span class="keyword">self</span>) weakSelf = <span class="keyword">self</span>;</span><br><span class="line"><span class="keyword">self</span>.block = ^(<span class="keyword">id</span> dataSource) &#123;</span><br><span class="line"><span class="built_in">NSString</span> *blockString = weakSelf.blockString;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"blockString = %@"</span>, blockString);</span><br><span class="line">&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>但并非所有 block 都会造成循环引用</strong>，在开发中，一些同学只要有<code>block</code>的地方就会用<code>__weak</code>来修饰对象，其实没有必要，以下几种<code>block</code>是不会造成循环引用的：</p>
<ul>
<li>大部分<code>GCD</code>方法<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">dispatch_async(dispatch_get_main_queue(), </span>^&#123;</span><br><span class="line">NSString *<span class="keyword">blockString </span>= self.<span class="keyword">blockString;</span></span><br><span class="line"><span class="keyword">NSLog(@"blockString </span>= %@<span class="string">", blockString);</span></span><br><span class="line"><span class="string">&#125;);</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>代码解读：因为<code>self</code>并没有对<code>GCD</code>中的<code>block</code>进行持有，所以不会形成循环引用。</p>
<ul>
<li><code>block</code> 属于另外一个类</li>
</ul>
<figure class="highlight hy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[NNHomeViewController testWithBlockName:^(<span class="name"><span class="builtin-name">id</span></span> dataSource) &#123;</span><br><span class="line">NSString *blockString = self.blockString;</span><br><span class="line">NSLog(@<span class="string">"blockString = %@"</span>, blockString)<span class="comment">;</span></span><br><span class="line">&#125;]<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>代码解读：同上，<code>block</code>不是被<code>self</code>所持有的。</p>
<ul>
<li><code>block</code>并不是属性值，而是临时变量<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">[<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">[<span class="keyword">self</span> testWithBlock:^&#123;</span><br><span class="line"><span class="built_in">NSString</span> *blockString = <span class="keyword">self</span>.blockString;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"blockString = %@"</span>, blockString);</span><br><span class="line">&#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)testWithBlock:(<span class="keyword">void</span>(^)(<span class="keyword">void</span>))block &#123;</span><br><span class="line">block();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="第-39-条：多用派发队列，少用同步锁"><a href="#第-39-条：多用派发队列，少用同步锁" class="headerlink" title="第 39 条：多用派发队列，少用同步锁"></a>第 39 条：多用派发队列，少用同步锁</h3><p><strong>在 OC 中，如果有多个线程要执行同一份代码，有时可能会出问题。这种情况下，通常要使用锁来实现某种同步机制。</strong></p>
<ul>
<li>GCD 出现之前通常使用两种方法：</li>
</ul>
<p>第一种：内置的“同步块”</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">synchronizedMethod</span> &#123;</span><br><span class="line"><span class="variable">@synchronized</span>(self) &#123;</span><br><span class="line"><span class="comment">// safe</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这种写法会根据给定的对象，自动创建一个锁，并等待块中代码执行完毕。执行到这段代码结尾处，锁就释放了。但滥用<code>@synchronized(self)</code>会很大程度上降低代码效率，因此不推荐使用。</p>
<p>第二种：直接使用 NSLock 对象(也可以使用 NSRecursiveLock 递归锁)<br><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">_lock</span> = [[NSLock alloc] init];</span><br><span class="line"></span><br><span class="line">- (void)synchronizedMethod &#123;</span><br><span class="line">[<span class="variable">_lock</span> <span class="built_in">lock</span>];</span><br><span class="line"><span class="comment">// safe</span></span><br><span class="line">[<span class="variable">_lock</span> unlock];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这种写法也有缺陷，在极端情况下，同步块会导致死锁，另外与 GCD 相比效率也很低。</p>
<ul>
<li>推荐：GCD 方式<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="name">NSString</span> *)testString &#123;</span><br><span class="line">__block NSString *localTestString<span class="comment">;</span></span><br><span class="line">dispatch_sync(<span class="name">dispatch_get_global_queue</span>(<span class="name">DISPATCH_QUEUE_PRIORITY_DEFAULT</span>, <span class="number">0</span>), ^&#123;</span><br><span class="line">localTestString = self.testString<span class="comment">;</span></span><br><span class="line">&#125;)<span class="comment">;</span></span><br><span class="line">return localTestString<span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="name">void</span>)setTestString:(<span class="name">NSString</span> *)testString &#123;</span><br><span class="line">dispatch_barrier_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</span><br><span class="line">self.testString = testString;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>使用同步队列及栅栏块，可以令同步行为更加高效。</p>
<h3 id="第-40-条：多用-GCD，少用-performSelector-系列方法"><a href="#第-40-条：多用-GCD，少用-performSelector-系列方法" class="headerlink" title="第 40 条：多用 GCD，少用 performSelector 系列方法"></a>第 40 条：多用 GCD，少用 performSelector 系列方法</h3><p>在 <code>GCD</code> 出现之前，开发者延迟调用一些方法，或者指定运行方法的线程会用 <code>performSelector</code>，但是在 <code>GCD</code> 出来之后就不需要再使用<code>performSelector</code>了。</p>
<ul>
<li>performSelector 系列的方法：</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">id</span>)performSelector:(SEL)aSelector;</span><br><span class="line">- (<span class="keyword">id</span>)performSelector:(SEL)aSelector withObject:(<span class="keyword">id</span>)object;</span><br><span class="line">- (<span class="keyword">id</span>)performSelector:(SEL)aSelector withObject:(<span class="keyword">id</span>)object1 withObject:(<span class="keyword">id</span>)object2;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)performSelector:(SEL)aSelector withObject:(<span class="keyword">nullable</span> <span class="keyword">id</span>)anArgument afterDelay:(<span class="built_in">NSTimeInterval</span>)delay inModes:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSRunLoopMode</span>&gt; *)modes;</span><br><span class="line">- (<span class="keyword">void</span>)performSelector:(SEL)aSelector withObject:(<span class="keyword">nullable</span> <span class="keyword">id</span>)anArgument afterDelay:(<span class="built_in">NSTimeInterval</span>)delay;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)performSelectorOnMainThread:(SEL)aSelector withObject:(<span class="keyword">nullable</span> <span class="keyword">id</span>)arg waitUntilDone:(<span class="built_in">BOOL</span>)wait modes:(<span class="keyword">nullable</span> <span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)array;</span><br><span class="line">- (<span class="keyword">void</span>)performSelectorOnMainThread:(SEL)aSelector withObject:(<span class="keyword">nullable</span> <span class="keyword">id</span>)arg waitUntilDone:(<span class="built_in">BOOL</span>)wait;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)performSelector:(SEL)aSelector onThread:(<span class="built_in">NSThread</span> *)thr withObject:(<span class="keyword">nullable</span> <span class="keyword">id</span>)arg waitUntilDone:(<span class="built_in">BOOL</span>)wait modes:(<span class="keyword">nullable</span> <span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)array;</span><br><span class="line">- (<span class="keyword">void</span>)performSelector:(SEL)aSelector onThread:(<span class="built_in">NSThread</span> *)thr withObject:(<span class="keyword">nullable</span> <span class="keyword">id</span>)arg waitUntilDone:(<span class="built_in">BOOL</span>)wait;</span><br><span class="line">- (<span class="keyword">void</span>)performSelectorInBackground:(SEL)aSelector withObject:(<span class="keyword">nullable</span> <span class="keyword">id</span>)arg;</span><br></pre></td></tr></table></figure>
<ul>
<li>performSelector 方法存在的缺点</li>
<li>内存管理问题：在<code>ARC</code>下使用<code>performSelector</code>编译器经常出现警告，因为它无法确定将要执行的选择子具体是什么，因而<code>ARC</code>编译器也就无法插入适当的内存管理方法。</li>
<li><p><code>performSelector</code>系列方法所能处理的选择子太过于局限，<code>performSelector</code>的返回值只能是<code>void</code>或对象类型；而且它无法处理带有多个参数的选择子，最多只能处理两个参数。</p>
</li>
<li><p>用 GCD 代替 performSelector 系列方法</p>
</li>
</ul>
<ol>
<li><p>延迟调用方法：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// GCD</span></span><br><span class="line">dispatch_time_t time = dispatch_time(DISPATCH_TIME_NOW, (int64_t)(<span class="number">5.0</span> * <span class="built_in">NSEC_PER_SEC</span>)); dispatch_after(time, dispatch_get_main_queue(), ^(<span class="keyword">void</span>)&#123;</span><br><span class="line">[<span class="keyword">self</span> doSomething];</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// performSelector</span></span><br><span class="line">[<span class="keyword">self</span> performSelector:<span class="keyword">@selector</span>(doSomething) withObject:<span class="literal">nil</span>  afterDelay:<span class="number">5.0</span>];</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定运行方法的线程：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// GCD</span></span><br><span class="line"><span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">[<span class="keyword">self</span> doSomething];</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// performSelector</span></span><br><span class="line">[<span class="keyword">self</span> performSelectorOnMainThread:<span class="keyword">@selector</span>(doSomething) withObject:<span class="literal">nil</span> waitUntilDone:<span class="literal">NO</span>];</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="第-41-条：掌握-GCD-及操作队列的使用时机"><a href="#第-41-条：掌握-GCD-及操作队列的使用时机" class="headerlink" title="第 41 条：掌握 GCD 及操作队列的使用时机"></a>第 41 条：掌握 GCD 及操作队列的使用时机</h3><p>这条讲的是什么时候该用 <code>GCD</code>，什么时候不该用<code>GCD</code>。<code>GCD</code>技术确实很棒，但<code>GCD</code>并不总是最佳解决方案。比如<strong>当我们想取消队列中的某个操作时，或者需要后台执行任务时</strong>，这时我们可以用<code>NSOperationQueue</code>，其实<code>NSOperationQueue</code>跟<code>GCD</code>有很多相像之处。<code>NSOperationQueue</code>在<code>GCD</code>之前就已经有了，<code>GCD</code>就是在其某些原理上构建的。<strong><code>GCD</code>是<code>C</code>层次的<code>API</code>，而<code>NSOperation</code>是重量级的<code>OC</code>对象。</strong></p>
<ul>
<li>使用<code>NSOperation</code>及<code>NSOperationQueue</code>的好处如下：</li>
<li>取消某个操作。</li>
<li>指定操作间的依赖关系。</li>
<li>通过键值观察机制监控NSOperation对象的属性。</li>
<li>指定操作的优先级。</li>
<li>重用NSOperation对象。</li>
</ul>
<h3 id="第-42-条：通过-Dispatch-Group-机制，根据系统资源状况来执行任务"><a href="#第-42-条：通过-Dispatch-Group-机制，根据系统资源状况来执行任务" class="headerlink" title="第 42 条：通过 Dispatch Group 机制，根据系统资源状况来执行任务"></a>第 42 条：通过 Dispatch Group 机制，根据系统资源状况来执行任务</h3><p><code>dispatch group</code>是<code>GCD</code>的一项特性，能够把任务分组。调用者可以等待这组任务执行完毕，也可以在提供回调函数之后继续往下执行，这组任务完成时，调用者会得到通知，开发者可以拿到结果然后继续下一步操作。</p>
<p>请看以下代码：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// 创建一个队列组</span></span><br><span class="line">dispatch_group_t group = dispatch_group_create();</span><br><span class="line">dispatch_group_async(group, queue, ^&#123;</span><br><span class="line"><span class="comment">// 添加操作...</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"1%@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;);</span><br><span class="line">dispatch_group_async(group, queue, ^&#123;</span><br><span class="line"><span class="comment">// 添加操作...</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"2%@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;);</span><br><span class="line">dispatch_group_async(group, queue, ^&#123;</span><br><span class="line"><span class="comment">// 添加操作...</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"3%@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 收到通知，回到主线程刷新UI</span></span><br><span class="line">dispatch_group_notify(group, dispatch_get_main_queue(), ^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"回到主线程刷新UI"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>多个任务可归入一个<code>dispatch group</code>之中。开发者可以在这组任务执行完毕时获得通知。</p>
<h3 id="第-43-条：使用-dispatch-once-来执行只需运行一次的线程安全代码"><a href="#第-43-条：使用-dispatch-once-来执行只需运行一次的线程安全代码" class="headerlink" title="第 43 条：使用 dispatch_once 来执行只需运行一次的线程安全代码"></a>第 43 条：使用 dispatch_once 来执行只需运行一次的线程安全代码</h3><p>这条讲的单例模式，即常用的<code>dispatch_once</code>。使用 <code>dispatch_once</code> 可以简化代码并且彻底保证线程安全，我们根本无须担心加锁或同步，另外它没有使用重量级的同步机制，所以也更高效。</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+ (id)<span class="keyword">shareInstance </span>&#123;</span><br><span class="line">static EOCClass *<span class="keyword">sharedInstance </span>= nil<span class="comment">;</span></span><br><span class="line">static <span class="keyword">dispatch_once_t </span>onceToken<span class="comment">;</span></span><br><span class="line"><span class="keyword">dispatch_once(&amp;onceToken, </span>^&#123;</span><br><span class="line"><span class="keyword">sharedInstance </span>= [[self alloc] init]<span class="comment">;</span></span><br><span class="line">&#125;)<span class="comment">;</span></span><br><span class="line">return <span class="keyword">sharedInstance;</span></span><br><span class="line"><span class="keyword">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="第-44-条：不要使用-dispatch-get-current-queue"><a href="#第-44-条：不要使用-dispatch-get-current-queue" class="headerlink" title="第 44 条：不要使用 dispatch_get_current_queue"></a>第 44 条：不要使用 dispatch_get_current_queue</h3><ul>
<li><code>dispatch_get_current_queue</code> 函数的行为常常与开发者所预期的不同，此函数已经废弃，只应做调试之用。</li>
<li>由于<code>GCD</code>是按层级来组织的，所以无法单用某个队列对象来描述”当前队列”这一概念。</li>
<li><code>dispatch_get_current_queue</code> 函数用于解决由不可以重入的代码所引发的死锁，然后能用此函数解决的问题，通常也可以用”队列特定数据”来解决。</li>
</ul>
<h2 id="第-7-章-系统框架"><a href="#第-7-章-系统框架" class="headerlink" title="第 7 章 系统框架"></a>第 7 章 系统框架</h2><h3 id="第-45-条：熟悉系统框架"><a href="#第-45-条：熟悉系统框架" class="headerlink" title="第 45 条：熟悉系统框架"></a>第 45 条：熟悉系统框架</h3><p>开发者会碰到的主要框架就是<code>Fundation</code>。另外还有个与<code>Fundation</code>相伴的框架，叫做<code>CoreFoundation</code>。除了<code>Fundation</code>与<code>CoreFoundation</code>，还有很多系统库，其中包括但不限于下面列出的这些：</p>
<ul>
<li>CFNetwork：此框架提供了 C 语言级别的网络通信能力，它将 BSD 套接字<code>(BSD socket)</code>抽象成易于使用的网络接口。而 <code>Foundation</code> 则将该框架里的部分内容封装为<code>OC</code>语言的接口，以便进行网络通信。</li>
<li>CoreAudio：此框架所提供的<code>C</code>语言<code>API</code>可以用来操作设备上的音频硬件。</li>
<li>AVFoundation：此框架所提供的<code>OC</code>对象可用来回访并录制音频及视频，比如能够在UI视图类里播放视频。</li>
<li>CoreData：此框架所提供的<code>OC</code>接口可以将对象放入数据库，将数持久保存。</li>
<li><p>CoreText：此框架提供的C语言接口可以高效执行文字排版以及渲染操作。</p>
</li>
<li><p>要点：</p>
</li>
<li>许多系统框架都可以直接使用。其中最重要的是<code>Fundation</code>与<code>CoreFoundation</code>，这两个框架提供了构架应用程序所需的许多核心功能。</li>
<li>很多常见任务都能用框架来做。例如音频与视频处理、网络通信、数据管理等。</li>
<li>用纯<code>C</code>写成的框架与用<code>OC</code>写成的一样重要，若想成为优秀的<code>OC</code>开发者，应该掌握<code>C</code>语言的核心概念。</li>
</ul>
<h3 id="第-46-条：多用块枚举，少用-for-循环"><a href="#第-46-条：多用块枚举，少用-for-循环" class="headerlink" title="第 46 条：多用块枚举，少用 for 循环"></a>第 46 条：多用块枚举，少用 for 循环</h3><p>遍历<code>collection</code>有四种方式。最基本的办法是<code>for循环</code>，其次是<code>NSEnumerator遍历法</code>及<code>快速遍历法</code>，最新最先进的方式则是<code>“块枚举法”</code>。</p>
<ul>
<li>四种遍历方法：<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSArray</span> *testArray = @[@<span class="number">1</span>, @<span class="number">2</span>, @<span class="number">3</span>, @<span class="number">4</span>, @<span class="number">5</span>];</span><br><span class="line"><span class="comment">// for 循环遍历</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; testArray.count; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"testArray[%d] = %@"</span>, i, testArray[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NSEnumerator遍历法</span></span><br><span class="line"><span class="built_in">NSEnumerator</span> *enumerator = [testArray objectEnumerator];</span><br><span class="line"><span class="keyword">id</span> object;</span><br><span class="line"><span class="keyword">while</span> ((object = [enumerator nextObject]) != <span class="literal">nil</span>) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"object = %@"</span>, object);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 快速遍历</span></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSObject</span> *obj <span class="keyword">in</span> testArray) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"obj = %@"</span>, obj);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 块枚举遍历数组</span></span><br><span class="line">[testArray enumerateObjectsUsingBlock:^(<span class="keyword">id</span>  _Nonnull obj, <span class="built_in">NSUInteger</span> idx, <span class="built_in">BOOL</span> * _Nonnull stop) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"idx = %zd, obj = %@"</span>, idx, obj);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 块枚举遍历字典</span></span><br><span class="line"><span class="built_in">NSDictionary</span> *testDic = @&#123;<span class="string">@"name"</span>:<span class="string">@"liu zhong ning"</span>,<span class="string">@"age"</span>:<span class="string">@"25"</span>&#125;;</span><br><span class="line">[testDic enumerateKeysAndObjectsUsingBlock:^(<span class="built_in">NSString</span> * key,<span class="keyword">id</span> object,<span class="built_in">BOOL</span> * stop)&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"testDic[%@] = %@"</span>, key, object);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>块枚举法拥有其他遍历方式都具备的优势，而且还能带来更多好处，在遍历字典的时候，还可以同时提供键和值，而且还有选项可以开启并发迭代功能，所以多写点代码还是值的。</p>
<h3 id="第-47-条：对自定义其内存管理语义的collection使用无缝桥接"><a href="#第-47-条：对自定义其内存管理语义的collection使用无缝桥接" class="headerlink" title="第 47 条：对自定义其内存管理语义的collection使用无缝桥接"></a>第 47 条：对自定义其内存管理语义的<code>collection</code>使用无缝桥接</h3><p>通过无缝桥接技术，可以在<code>Foundation</code>框架中的<code>OC</code>对象与<code>CoreFoundation</code>框架中的<code>C</code>语言数据结构之间来回转换。</p>
<ul>
<li>简单的无缝桥接示例：</li>
</ul>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">NSArray *testNSArray = @[@1, @2, @3, @4, @5];</span><br><span class="line">CFArrayRef testCFArray = (__bridge CFArrayRef)testNSArray;</span><br><span class="line">NSLog(@<span class="string">"Size of array = %li"</span>, CFArrayGetCount(testCFArray));</span><br><span class="line">// Output：Size of<span class="built_in"> array </span>= 5</span><br></pre></td></tr></table></figure>
<ul>
<li>__bridge：ARC仍然具备这个Objective对象的所有权。</li>
<li>__bridge_retained:ARC将交出对象的所有权。</li>
<li>__bridge_transfer：C转化为OC</li>
</ul>
<p>想深入了解无缝桥接技术的童鞋可以点击这里：<a href="https://developer.apple.com/library/content/documentation/CoreFoundation/Conceptual/CFDesignConcepts/Articles/tollFreeBridgedTypes.html" target="_blank" rel="noopener">iOS无缝桥接官方文档</a></p>
<h3 id="第-48-条：构建缓存时选用-NSCache-而非-NSDictionary"><a href="#第-48-条：构建缓存时选用-NSCache-而非-NSDictionary" class="headerlink" title="第 48 条：构建缓存时选用 NSCache 而非 NSDictionary"></a>第 48 条：构建缓存时选用 NSCache 而非 NSDictionary</h3><ul>
<li>实现缓存时应选用<code>NSCache</code>而非<code>NSDictionary</code>对象。因为<code>NSCache</code>可以提供优雅的自动删减功能，而且是“线程安全的”，此外，它与字典不同，并不会拷贝键。</li>
<li>可以给<code>NSCache</code>对象设置上限，用以限制缓存中的对象总个数及“总成本”，而这些尺度则定义了缓存删减其中对象的时机。但是绝对不要把这些尺度当成可靠的“硬限制”，他们仅对<code>NSCache</code>起指导作用。</li>
<li>将<code>NSPurgeableData</code>与<code>NSCache</code>搭配使用，可实现自动清除数据的功能，也就是说，当<code>NSPurgeableData</code>对象所占内存为系统所丢弃时，该对象自身也会从缓存中移除。</li>
<li>如果缓存使用得当，那么应用程序的相应速度就能提高。只有那种“重新计算起来很费事的”数据，才值得放入缓存，比如那些需要从网络获取或从磁盘读取的数据。</li>
</ul>
<h3 id="第-49-条：精简-initialize-与-load-的实现代码"><a href="#第-49-条：精简-initialize-与-load-的实现代码" class="headerlink" title="第 49 条：精简 initialize 与 load 的实现代码"></a>第 49 条：精简 initialize 与 load 的实现代码</h3><ul>
<li>当程序启动的时候，类和分类，必定会调动且仅调用一次<code>load</code>方法。先调用类的<code>load</code>方法，再调用分类的<code>load</code>方法。先调用超类的<code>load</code>方法，再调用子类的<code>load</code>方法。<code>load</code>方法需要实现得精简一些，因为整个应用程序会在执行<code>load</code>方法时都会阻塞。</li>
<li><code>initialize</code>方法会在程序首次用该类之前调用，且只调用一次。<code>initialize</code>是“懒加载”的，如果某个类一直都没有使用，就不会执行该类的<code>initialize</code>方法。<code>initialize</code>方法可以安全使用并调用任意类中的任意方法。<code>initialize</code>方法只应该用来设置内部数据，不应该在其中调用其他方法。</li>
<li>在加载阶段，如果类实现了<code>load</code>方法，那么系统就会调用它。分类里也可以定义此方法，类的<code>load</code>方法要比分类中的先调用。与其他方法不同，<code>load</code>方法不参与覆写机制。</li>
<li>首次使用某个类之前，系统会向其发送<code>initialize</code>消息。由于此方法遵从普通的覆写规则，所以通常应该在里面判断当前要初始化的是哪个类。</li>
<li><code>load</code>与<code>initialize</code> 方法都应该实现的精简一点，这样有助于保持应用程序的响应能力，也可以减少引入依赖环的几率。</li>
<li>无法在编译器设定的全局变量，可以放在<code>initialize</code>方法里初始化。</li>
</ul>
<h3 id="第-50-条：别忘了-NSTimer-会保留其目标对象"><a href="#第-50-条：别忘了-NSTimer-会保留其目标对象" class="headerlink" title="第 50 条：别忘了 NSTimer 会保留其目标对象"></a>第 50 条：别忘了 NSTimer 会保留其目标对象</h3><p>开发中经常会用到NSTimer，由于定时器NSTimer会保留其目标对象，所以反复执行任务通常会导致应用程序出问题，也就是说很容易造成循环引用。请看以下代码：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NNTimer</span>: <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)startPolling;</span><br><span class="line">- (<span class="keyword">void</span>)stopPolling;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NNTimer</span> </span>&#123;</span><br><span class="line"><span class="built_in">NSTimer</span> *_pollTimer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)init &#123;</span><br><span class="line"><span class="keyword">return</span> [<span class="keyword">super</span> init];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)dealloc &#123;</span><br><span class="line">[_pollTimer invalidate];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)stopPolling &#123;</span><br><span class="line"></span><br><span class="line">[_pollTimer invalidate];</span><br><span class="line">_pollTimer = <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)startPolling &#123;</span><br><span class="line">_pollTimer = [<span class="built_in">NSTimer</span> scheduledTimerWithTimeInterval:<span class="number">5.0</span></span><br><span class="line">target:<span class="keyword">self</span></span><br><span class="line">selector:<span class="keyword">@selector</span>(p_doPoll)</span><br><span class="line">userInfo:<span class="literal">nil</span></span><br><span class="line">repeats:<span class="literal">YES</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)p_doPoll &#123;</span><br><span class="line"><span class="comment">// Poll the resource</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>上面这段代码是存在问题的。如果创建了本类的实例，并调用其startPolling方法，那么会如何呢？创建计时器的时候，由于目标对象是self，所以要保留此实例。然而，因为计时器是用实例变量存放的，所以实例也保留了计时器，于是就产生了保留环。</p>
<p>单从计时器本身入手，你会发现很难解决这个问题，那么如何解决这个问题呢？我们可以通过“块”来解决。虽然计时器当前不直接支持块，但是可以用下面这段代码为其添加此功能：<br>.h文件：<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSTimer</span> (<span class="title">NNBlocksSupport</span>)</span></span><br><span class="line">+ (<span class="built_in">NSTimer</span> *)nn_scheduledTimerWithTimeInterval:(<span class="built_in">NSTimeInterval</span>)interval</span><br><span class="line">block:(<span class="keyword">void</span>(^)(<span class="keyword">void</span>))block</span><br><span class="line">repeats:(<span class="built_in">BOOL</span>)repeats;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>.m文件：<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"NSTimer+NNBlocksSupport.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NSTimer</span> (<span class="title">NNBlocksSupport</span>)</span></span><br><span class="line"></span><br><span class="line">+ (<span class="built_in">NSTimer</span> *)nn_scheduledTimerWithTimeInterval:(<span class="built_in">NSTimeInterval</span>)interval</span><br><span class="line">block:(<span class="keyword">void</span>(^)(<span class="keyword">void</span>))block</span><br><span class="line">repeats:(<span class="built_in">BOOL</span>)repeats &#123;</span><br><span class="line"><span class="keyword">return</span> [<span class="keyword">self</span> scheduledTimerWithTimeInterval:interval</span><br><span class="line">target:<span class="keyword">self</span></span><br><span class="line">selector:<span class="keyword">@selector</span>(nn_blockInvoke:)</span><br><span class="line">userInfo:[block <span class="keyword">copy</span>]</span><br><span class="line">repeats:repeats];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)nn_blockInvoke:(<span class="built_in">NSTimer</span> *)timer &#123;</span><br><span class="line"><span class="keyword">void</span> (^block)(<span class="keyword">void</span>) = timer.userInfo;</span><br><span class="line"><span class="keyword">if</span> (block) &#123;</span><br><span class="line">block();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>结束语：由于个人能力有限，这三篇读书笔记难免有错误或不足之处，还望各位道友能不吝赐教，谢谢。</p>
<p>最后安利一下这本书：<a href="https://pan.baidu.com/s/1eT3gfzs" target="_blank" rel="noopener">PDF版</a></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/iOS 获取设备的各种信息/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="刘朋坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="以梦为马">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/iOS 获取设备的各种信息/" itemprop="url">
                  iOS 获取设备的各种信息
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="iOS-获取设备的各种信息"><a href="#iOS-获取设备的各种信息" class="headerlink" title="iOS 获取设备的各种信息"></a><a href="https://github.com/liuzhongning/NNDeviceInformation" target="_blank" rel="noopener">iOS 获取设备的各种信息</a></h5><h3 id="一、目录结构"><a href="#一、目录结构" class="headerlink" title="一、目录结构:"></a>一、目录结构:</h3><ol>
<li>获取屏幕宽度与高度</li>
<li>获取设备版本号</li>
<li>获取iPhone名称</li>
<li>获取app版本号</li>
<li>获取电池电量</li>
<li>获取当前系统名称</li>
<li>获取当前系统版本号</li>
<li>获取通用的唯一识别码UUID</li>
<li>获取当前设备IP</li>
<li>获取总内存大小</li>
<li>获取当前可用内存</li>
<li>获取精准电池电量</li>
<li>获取电池当前的状态（共有4种状态）</li>
<li>获取设备当前的语言</li>
</ol>
<h3 id="二、具体内容"><a href="#二、具体内容" class="headerlink" title="二、具体内容"></a>二、具体内容</h3><h5 id="1-获取屏幕宽度与高度"><a href="#1-获取屏幕宽度与高度" class="headerlink" title="1. 获取屏幕宽度与高度"></a>1. 获取屏幕宽度与高度</h5><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 屏幕宽度</span></span><br><span class="line">+ (CGFloat)getDeviceScreenWidth &#123;</span><br><span class="line"><span class="built_in">return</span> [UIScreen mainScreen].bounds.<span class="built_in">size</span>.<span class="built_in">width</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// 屏幕高度</span></span><br><span class="line">+ (CGFloat)getDeviceScreenHeight &#123;</span><br><span class="line"><span class="built_in">return</span> [UIScreen mainScreen].bounds.<span class="built_in">size</span>.<span class="built_in">height</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>[UIScreen mainScreen].bounds.size.width</code>用的很普遍，一般来说定义成宏更好，然后根据屏幕宽高进行尺寸的适配。</p>
<h5 id="2-获取设备版本号"><a href="#2-获取设备版本号" class="headerlink" title="2. 获取设备版本号"></a>2. 获取设备版本号</h5><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">+ (NSString *)getDeviceName &#123;</span><br><span class="line"><span class="comment">// 需要#import "sys/utsname.h"</span></span><br><span class="line">struct utsname systemInfo;</span><br><span class="line">uname(&amp;systemInfo);</span><br><span class="line">NSString *deviceString = [NSString <span class="string">stringWithCString:</span>systemInfo.machine <span class="string">encoding:</span>NSUTF8StringEncoding];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPhone3,1"</span>])    <span class="keyword">return</span> @<span class="string">"iPhone 4"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPhone3,2"</span>])    <span class="keyword">return</span> @<span class="string">"iPhone 4"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPhone3,3"</span>])    <span class="keyword">return</span> @<span class="string">"iPhone 4"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPhone4,1"</span>])    <span class="keyword">return</span> @<span class="string">"iPhone 4S"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPhone5,1"</span>])    <span class="keyword">return</span> @<span class="string">"iPhone 5"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPhone5,2"</span>])    <span class="keyword">return</span> @<span class="string">"iPhone 5 (GSM+CDMA)"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPhone5,3"</span>])    <span class="keyword">return</span> @<span class="string">"iPhone 5c (GSM)"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPhone5,4"</span>])    <span class="keyword">return</span> @<span class="string">"iPhone 5c (GSM+CDMA)"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPhone6,1"</span>])    <span class="keyword">return</span> @<span class="string">"iPhone 5s (GSM)"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPhone6,2"</span>])    <span class="keyword">return</span> @<span class="string">"iPhone 5s (GSM+CDMA)"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPhone7,1"</span>])    <span class="keyword">return</span> @<span class="string">"iPhone 6 Plus"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPhone7,2"</span>])    <span class="keyword">return</span> @<span class="string">"iPhone 6"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPhone8,1"</span>])    <span class="keyword">return</span> @<span class="string">"iPhone 6s"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPhone8,2"</span>])    <span class="keyword">return</span> @<span class="string">"iPhone 6s Plus"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPhone8,4"</span>])    <span class="keyword">return</span> @<span class="string">"iPhone SE"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPod1,1"</span>])      <span class="keyword">return</span> @<span class="string">"iPod Touch 1G"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPod2,1"</span>])      <span class="keyword">return</span> @<span class="string">"iPod Touch 2G"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPod3,1"</span>])      <span class="keyword">return</span> @<span class="string">"iPod Touch 3G"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPod4,1"</span>])      <span class="keyword">return</span> @<span class="string">"iPod Touch 4G"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPod5,1"</span>])      <span class="keyword">return</span> @<span class="string">"iPod Touch (5 Gen)"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad1,1"</span>])      <span class="keyword">return</span> @<span class="string">"iPad"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad1,2"</span>])      <span class="keyword">return</span> @<span class="string">"iPad 3G"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad2,1"</span>])      <span class="keyword">return</span> @<span class="string">"iPad 2 (WiFi)"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad2,2"</span>])      <span class="keyword">return</span> @<span class="string">"iPad 2"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad2,3"</span>])      <span class="keyword">return</span> @<span class="string">"iPad 2 (CDMA)"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad2,4"</span>])      <span class="keyword">return</span> @<span class="string">"iPad 2"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad2,5"</span>])      <span class="keyword">return</span> @<span class="string">"iPad Mini (WiFi)"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad2,6"</span>])      <span class="keyword">return</span> @<span class="string">"iPad Mini"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad2,7"</span>])      <span class="keyword">return</span> @<span class="string">"iPad Mini (GSM+CDMA)"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad3,1"</span>])      <span class="keyword">return</span> @<span class="string">"iPad 3 (WiFi)"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad3,2"</span>])      <span class="keyword">return</span> @<span class="string">"iPad 3 (GSM+CDMA)"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad3,3"</span>])      <span class="keyword">return</span> @<span class="string">"iPad 3"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad3,4"</span>])      <span class="keyword">return</span> @<span class="string">"iPad 4 (WiFi)"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad3,5"</span>])      <span class="keyword">return</span> @<span class="string">"iPad 4"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad3,6"</span>])      <span class="keyword">return</span> @<span class="string">"iPad 4 (GSM+CDMA)"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad4,1"</span>])      <span class="keyword">return</span> @<span class="string">"iPad Air (WiFi)"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad4,2"</span>])      <span class="keyword">return</span> @<span class="string">"iPad Air (Cellular)"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad4,4"</span>])      <span class="keyword">return</span> @<span class="string">"iPad Mini 2 (WiFi)"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad4,5"</span>])      <span class="keyword">return</span> @<span class="string">"iPad Mini 2 (Cellular)"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad4,6"</span>])      <span class="keyword">return</span> @<span class="string">"iPad Mini 2"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad4,7"</span>])      <span class="keyword">return</span> @<span class="string">"iPad Mini 3"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad4,8"</span>])      <span class="keyword">return</span> @<span class="string">"iPad Mini 3"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad4,9"</span>])      <span class="keyword">return</span> @<span class="string">"iPad Mini 3"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad5,1"</span>])      <span class="keyword">return</span> @<span class="string">"iPad Mini 4 (WiFi)"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad5,2"</span>])      <span class="keyword">return</span> @<span class="string">"iPad Mini 4 (LTE)"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad5,3"</span>])      <span class="keyword">return</span> @<span class="string">"iPad Air 2"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad5,4"</span>])      <span class="keyword">return</span> @<span class="string">"iPad Air 2"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad6,3"</span>])      <span class="keyword">return</span> @<span class="string">"iPad Pro 9.7"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad6,4"</span>])      <span class="keyword">return</span> @<span class="string">"iPad Pro 9.7"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad6,7"</span>])      <span class="keyword">return</span> @<span class="string">"iPad Pro 12.9"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"iPad6,8"</span>])      <span class="keyword">return</span> @<span class="string">"iPad Pro 12.9"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"i386"</span>])         <span class="keyword">return</span> @<span class="string">"Simulator"</span>;</span><br><span class="line"><span class="keyword">if</span> ([deviceString <span class="string">isEqualToString:</span>@<span class="string">"x86_64"</span>])       <span class="keyword">return</span> @<span class="string">"Simulator"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> deviceString;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="3-获取iPhone名称"><a href="#3-获取iPhone名称" class="headerlink" title="3. 获取iPhone名称"></a>3. 获取iPhone名称</h5><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 获取iPhone名称</span></span><br><span class="line">+ (<span class="built_in">NSString</span> *)getiPhoneName &#123;</span><br><span class="line"><span class="keyword">return</span> [<span class="built_in">UIDevice</span> currentDevice].name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>获取的是你 iPhone 的名字。</p>
<h5 id="4-获取app版本号"><a href="#4-获取app版本号" class="headerlink" title="4. 获取app版本号"></a>4. 获取app版本号</h5><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 获取app版本号</span></span><br><span class="line">+ (<span class="built_in">NSString</span> *)getAPPVerion &#123;</span><br><span class="line"><span class="keyword">return</span> [[[<span class="built_in">NSBundle</span> mainBundle] infoDictionary] objectForKey:<span class="string">@"CFBundleShortVersionString"</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="5-获取电池电量"><a href="#5-获取电池电量" class="headerlink" title="5. 获取电池电量"></a>5. 获取电池电量</h5><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 获取电池电量</span></span><br><span class="line">+ (<span class="built_in">CGFloat</span>)getBatteryLevel &#123;</span><br><span class="line"><span class="keyword">return</span> [<span class="built_in">UIDevice</span> currentDevice].batteryLevel;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个方法获取电池电量不是很精确，下边会介绍一个获取精确电池电量的。</p>
<h5 id="6-获取当前系统名称"><a href="#6-获取当前系统名称" class="headerlink" title="6. 获取当前系统名称"></a>6. 获取当前系统名称</h5><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 当前系统名称</span></span><br><span class="line">+ (<span class="built_in">NSString</span> *)getSystemName &#123;</span><br><span class="line"><span class="keyword">return</span> [<span class="built_in">UIDevice</span> currentDevice].systemName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="7-获取当前系统版本号"><a href="#7-获取当前系统版本号" class="headerlink" title="7. 获取当前系统版本号"></a>7. 获取当前系统版本号</h5><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 当前系统版本号</span></span><br><span class="line">+ (<span class="built_in">NSString</span> *)getSystemVersion &#123;</span><br><span class="line"><span class="keyword">return</span> [<span class="built_in">UIDevice</span> currentDevice].systemVersion;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="8-获取通用的唯一识别码UUID"><a href="#8-获取通用的唯一识别码UUID" class="headerlink" title="8. 获取通用的唯一识别码UUID"></a>8. 获取通用的唯一识别码UUID</h5><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 通用唯一识别码UUID</span></span><br><span class="line">+ (<span class="built_in">NSString</span> *)getUUID &#123;</span><br><span class="line"><span class="keyword">return</span> [[<span class="built_in">UIDevice</span> currentDevice] identifierForVendor].UUIDString;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="9-获取当前设备IP"><a href="#9-获取当前设备IP" class="headerlink" title="9. 获取当前设备IP"></a>9. 获取当前设备IP</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取当前设备IP</span></span><br><span class="line">+ (NSString *)getDeviceIPAdress &#123;</span><br><span class="line">NSString *address = @<span class="string">"an error occurred when obtaining ip address"</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ifaddrs</span></span> *interfaces = NULL;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ifaddrs</span></span> *temp_addr = NULL;</span><br><span class="line">int success = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">success = getifaddrs(&amp;interfaces);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (success == <span class="number">0</span>) &#123; <span class="comment">// 0 表示获取成功</span></span><br><span class="line"></span><br><span class="line">temp_addr = interfaces;</span><br><span class="line"><span class="keyword">while</span> (temp_addr != NULL) &#123;</span><br><span class="line"><span class="keyword">if</span>( temp_addr-&gt;ifa_addr-&gt;sa_family == AF_INET) &#123;</span><br><span class="line"><span class="comment">// Check if interface is en0 which is the wifi connection on the iPhone</span></span><br><span class="line"><span class="keyword">if</span> ([[NSString stringWithUTF8String:temp_addr-&gt;ifa_name] isEqualToString:@<span class="string">"en0"</span>]) &#123;</span><br><span class="line"><span class="comment">// Get NSString from C String</span></span><br><span class="line">address = [NSString stringWithUTF8String:inet_ntoa(((<span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span></span> *)temp_addr-&gt;ifa_addr)-&gt;sin_addr)];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">temp_addr = temp_addr-&gt;ifa_next;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">freeifaddrs(interfaces);</span><br><span class="line"><span class="keyword">return</span> address;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="10-获取总内存大小"><a href="#10-获取总内存大小" class="headerlink" title="10. 获取总内存大小"></a>10. 获取总内存大小</h5><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 获取总内存大小</span></span><br><span class="line">+ (<span class="keyword">long</span> <span class="keyword">long</span>)getTotalMemorySize &#123;</span><br><span class="line"><span class="keyword">return</span> [<span class="built_in">NSProcessInfo</span> processInfo].physicalMemory;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="11-获取当前可用内存"><a href="#11-获取当前可用内存" class="headerlink" title="11. 获取当前可用内存"></a>11. 获取当前可用内存</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 获取当前可用内存</span></span><br><span class="line">+ (<span class="keyword">long</span> <span class="keyword">long</span>)getAvailableMemorySize &#123;</span><br><span class="line"><span class="keyword">vm_statistics_data_t</span> vmStats;</span><br><span class="line"><span class="keyword">mach_msg_type_number_t</span> infoCount = HOST_VM_INFO_COUNT;</span><br><span class="line"><span class="keyword">kern_return_t</span> kernReturn = host_statistics(mach_host_self(), HOST_VM_INFO, (<span class="keyword">host_info_t</span>)&amp;vmStats, &amp;infoCount);</span><br><span class="line"><span class="keyword">if</span> (kernReturn != KERN_SUCCESS)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> NSNotFound;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> ((vm_page_size * vmStats.free_count + vm_page_size * vmStats.inactive_count));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="12-获取精准电池电量"><a href="#12-获取精准电池电量" class="headerlink" title="12. 获取精准电池电量"></a>12. 获取精准电池电量</h5><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 获取精准电池电量</span></span><br><span class="line">+ (<span class="built_in">CGFloat</span>)getCurrentBatteryLevel &#123;</span><br><span class="line"><span class="built_in">UIApplication</span> *app = [<span class="built_in">UIApplication</span> sharedApplication];</span><br><span class="line"><span class="keyword">if</span> (app.applicationState == <span class="built_in">UIApplicationStateActive</span>||app.applicationState==<span class="built_in">UIApplicationStateInactive</span>) &#123;</span><br><span class="line">Ivar ivar=  class_getInstanceVariable([app <span class="keyword">class</span>],<span class="string">"_statusBar"</span>);</span><br><span class="line"><span class="keyword">id</span> status  = object_getIvar(app, ivar);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">id</span> aview <span class="keyword">in</span> [status subviews]) &#123;</span><br><span class="line"><span class="keyword">int</span> batteryLevel = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">id</span> bview <span class="keyword">in</span> [aview subviews]) &#123;</span><br><span class="line"><span class="keyword">if</span> ([<span class="built_in">NSStringFromClass</span>([bview <span class="keyword">class</span>]) caseInsensitiveCompare:<span class="string">@"UIStatusBarBatteryItemView"</span>] == <span class="built_in">NSOrderedSame</span>&amp;&amp;[[[<span class="built_in">UIDevice</span> currentDevice] systemVersion] floatValue] &gt;=<span class="number">6.0</span>) &#123;</span><br><span class="line"></span><br><span class="line">Ivar ivar=  class_getInstanceVariable([bview <span class="keyword">class</span>],<span class="string">"_capacity"</span>);</span><br><span class="line"><span class="keyword">if</span>(ivar) &#123;</span><br><span class="line">batteryLevel = ((<span class="keyword">int</span> (*)(<span class="keyword">id</span>, Ivar))object_getIvar)(bview, ivar);</span><br><span class="line"><span class="keyword">if</span> (batteryLevel &gt; <span class="number">0</span> &amp;&amp; batteryLevel &lt;= <span class="number">100</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> batteryLevel;</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面这个方法是通过 runtime 获取电池电量控件类私有变量的值，较为精确。</p>
<h5 id="13-获取电池当前的状态（共有4种状态）"><a href="#13-获取电池当前的状态（共有4种状态）" class="headerlink" title="13. 获取电池当前的状态（共有4种状态）"></a>13. 获取电池当前的状态（共有4种状态）</h5><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 获取电池当前的状态，共有4种状态</span></span><br><span class="line">+ (<span class="built_in">NSString</span> *) getBatteryState &#123;</span><br><span class="line"><span class="built_in">UIDevice</span> *device = [<span class="built_in">UIDevice</span> currentDevice];</span><br><span class="line"><span class="keyword">if</span> (device.batteryState == <span class="built_in">UIDeviceBatteryStateUnknown</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">@"UnKnow"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (device.batteryState == <span class="built_in">UIDeviceBatteryStateUnplugged</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">@"Unplugged"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (device.batteryState == <span class="built_in">UIDeviceBatteryStateCharging</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">@"Charging"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (device.batteryState == <span class="built_in">UIDeviceBatteryStateFull</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">@"Full"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="14-获取设备当前的语言"><a href="#14-获取设备当前的语言" class="headerlink" title="14. 获取设备当前的语言"></a>14. 获取设备当前的语言</h5><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 获取当前语言</span></span><br><span class="line">+ (<span class="built_in">NSString</span> *)getDeviceLanguage &#123;</span><br><span class="line"><span class="built_in">NSArray</span> *languageArray = [<span class="built_in">NSLocale</span> preferredLanguages];</span><br><span class="line"><span class="keyword">return</span> [languageArray objectAtIndex:<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="提示：上面代码如果直接复制的话有些会报错，这是因为需要导入头文件，详细代码请点击-iOS-获取设备的各种信息。"><a href="#提示：上面代码如果直接复制的话有些会报错，这是因为需要导入头文件，详细代码请点击-iOS-获取设备的各种信息。" class="headerlink" title="提示：上面代码如果直接复制的话有些会报错，这是因为需要导入头文件，详细代码请点击 iOS 获取设备的各种信息。"></a>提示：上面代码如果直接复制的话有些会报错，这是因为需要导入头文件，详细代码请点击 <a href="https://github.com/liuzhongning/NNDeviceInformation" target="_blank" rel="noopener">iOS 获取设备的各种信息</a>。</h4>
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/iOS开发 - 仿简书个人主页多页面滑动视图/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="刘朋坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="以梦为马">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/iOS开发 - 仿简书个人主页多页面滑动视图/" itemprop="url">
                  iOS开发 - 仿简书个人主页多页面滑动视图
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>之前项目中很多地方用到了滑动视图，三个界面五个界面或界面个数不定的情况都有，这里以简书 APP 的个人主页为例，总结一下，一则对自己也有好处，二则希望对看到的朋友有所帮助。</p>
</blockquote>
<ul>
<li><p>简书APP个人主页：<br><img src="http://upload-images.jianshu.io/upload_images/2665449-5b13d9033bba3752.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="简书APP个人主页"></p>
</li>
<li><p>demo 效果图：</p>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-64f7bc0e3b50267d.gif?imageMogr2/auto-orient/strip" alt="demo 效果图"></p>
<ul>
<li>demo 地址：<a href="https://github.com/liuzhongning/NNJaneBookView" target="_blank" rel="noopener">https://github.com/liuzhongning/NNJaneBookView</a></li>
</ul>
<h4 id="简单说下思路及核心代码："><a href="#简单说下思路及核心代码：" class="headerlink" title="简单说下思路及核心代码："></a>简单说下思路及核心代码：</h4><h5 id="思路："><a href="#思路：" class="headerlink" title="思路："></a>思路：</h5><ul>
<li>导航栏上面的头像会随着视图的上下滑动而变大变小，这里注册了一个通知，用来监听视图的上下滑动，可以根据偏移量的值来改变头像的大小。</li>
<li>此 UI 页面分为三部分，第一部分是信息展示，用来显示昵称签名等；第二部分是标签栏，即“动态”，“文章”，“更多”这三个标签；第三部分是主要显示内容；</li>
<li>我这里用了这样的思路：页面底部是一个 UIScrollView; 接着 UIScrollView 上面 add 了三个 UITableView ；信息展示以及标签栏放在 UITableView 的 tableHeaderView 中；接着挨个实现其功能即可。</li>
</ul>
<h5 id="核心代码："><a href="#核心代码：" class="headerlink" title="核心代码："></a>核心代码：</h5><ul>
<li>头像跟随页面上下滑动而变大变小</li>
<li><p>这里是头像变大变小时调用的代码，如果你的项目中用到了此功能，可以直接把这个类拿过去，然后调用下面这几句代码就可以实现了。另外点击头像的回调也通过 block 传了出来，你可以在此处做些操作，比如更改头像等等。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.headerImageView          = [[NNPersonalHomePageHeaderImageView alloc] initWithImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"header"</span>]];</span><br><span class="line">[<span class="keyword">self</span>.headerImageView reloadSizeWithScrollView:<span class="keyword">self</span>.dynamicTableView];</span><br><span class="line"><span class="keyword">self</span>.navigationItem.titleView = <span class="keyword">self</span>.headerImageView;</span><br><span class="line">[<span class="keyword">self</span>.headerImageView handleClickActionWithBlock:^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"你点击了头像按钮"</span>);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
</li>
<li><p>tableView 的头部视图</p>
</li>
<li>这里另外建了两个 UIView 类，一个用来显示基本信息（昵称签名等），一个用来显示标签栏（动态，文章等标签），额外建这两个 UIView 类是为了减少控制器中的代码。</li>
</ul>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">- (void)setupHeaderView &#123;</span><br><span class="line">UIView *headerView                     = [[NNPersonalHomePageHeaderView alloc] init]<span class="comment">;</span></span><br><span class="line">headerView.frame                       = CGRectMake(<span class="number">0</span>, <span class="number">0</span>, NNScreenWidth, NNHeadViewHeight + NNTitleHeight)<span class="comment">;</span></span><br><span class="line">[self.view <span class="keyword">addSubview:headerView];</span></span><br><span class="line"><span class="keyword">self.headerView </span>                       = headerView<span class="comment">;</span></span><br><span class="line">NNPersonalHomePageTitleView *titleView = [[NNPersonalHomePageTitleView alloc] init]<span class="comment">;</span></span><br><span class="line">[headerView <span class="keyword">addSubview:titleView];</span></span><br><span class="line"><span class="keyword">self.titleView </span>                        = titleView<span class="comment">;</span></span><br><span class="line">titleView.<span class="keyword">backgroundColor </span>             = [UIColor whiteColor]<span class="comment">;</span></span><br><span class="line">[titleView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">make.left.right.mas_equalTo(headerView)<span class="comment">;</span></span><br><span class="line">make.<span class="keyword">bottom.equalTo(headerView.mas_bottom);</span></span><br><span class="line"><span class="keyword">make.height.mas_equalTo(NNTitleHeight);</span></span><br><span class="line"><span class="keyword">&#125;];</span></span><br><span class="line"><span class="keyword">[self.scrollView </span>mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">make.left.right.<span class="keyword">bottom.equalTo(self.view);</span></span><br><span class="line"><span class="keyword">make.top.mas_equalTo(headerView.top);</span></span><br><span class="line"><span class="keyword">&#125;];</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">__weak </span>typeof(self) weakSelf = self<span class="comment">;</span></span><br><span class="line">titleView.titles             = @[@<span class="string">"动态"</span>, @<span class="string">"文章"</span>, @<span class="string">"更多"</span>]<span class="comment">;</span></span><br><span class="line">titleView.selectedIndex      = <span class="number">0</span><span class="comment">;</span></span><br><span class="line">titleView.<span class="keyword">buttonSelected </span>    = ^(NSInteger index)&#123;</span><br><span class="line">[weakSelf.<span class="keyword">scrollView </span>setContentOffset:CGPointMake(NNScreenWidth * index, <span class="number">0</span>) animated:YES]<span class="comment">;</span></span><br><span class="line">&#125;<span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>主要内容</li>
<li><p>主要内容就是页面下部展示的具体内容，这里用了三个 UITableView ，依次添加到 UIScrollView 中，这里代码有些臃肿，后期再做优化，有兴趣的童鞋也可以帮忙改一下哈。</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">/// 主要内容</span><br><span class="line">- (void)setupContentView &#123;</span><br><span class="line">NNContentScrollView *<span class="attr">scrollView</span>           = [[NNContentScrollView alloc] init];</span><br><span class="line">scrollView.<span class="attr">delaysContentTouches</span>           = NO;</span><br><span class="line">[self.view addSubview:scrollView];</span><br><span class="line">self.<span class="attr">scrollView</span>                           = scrollView;</span><br><span class="line">scrollView.<span class="attr">pagingEnabled</span>                  = YES;</span><br><span class="line">scrollView.<span class="attr">showsVerticalScrollIndicator</span>   = NO;</span><br><span class="line">scrollView.<span class="attr">showsHorizontalScrollIndicator</span> = NO;</span><br><span class="line">scrollView.<span class="attr">delegate</span>                       = self;</span><br><span class="line">scrollView.<span class="attr">contentSize</span>                    = CGSizeMake(NNScreenWidth * <span class="number">3</span>, <span class="number">0</span>);</span><br><span class="line">UIView *<span class="attr">headView</span>                          = [[UIView alloc] init];</span><br><span class="line">headView.<span class="attr">frame</span>                            = CGRectMake(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, NNHeadViewHeight + NNTitleHeight);</span><br><span class="line">self.<span class="attr">tableViewHeadView</span> = headView;</span><br><span class="line"></span><br><span class="line">NNContentTableView *<span class="attr">dynamicTableView</span> = [[NNContentTableView alloc] init];</span><br><span class="line">dynamicTableView.<span class="attr">delegate</span>            = self;</span><br><span class="line">dynamicTableView.<span class="attr">separatorStyle</span>      = UITableViewCellSeparatorStyleNone;</span><br><span class="line">self.<span class="attr">dynamicTableView</span>                = dynamicTableView;</span><br><span class="line">dynamicTableView.<span class="attr">tableHeaderView</span>     = headView;</span><br><span class="line">[scrollView addSubview:dynamicTableView];</span><br><span class="line">[dynamicTableView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">make.left.equalTo(scrollView);</span><br><span class="line">make.width.mas_equalTo(NNScreenWidth);</span><br><span class="line">make.top.equalTo(self.view);</span><br><span class="line">make.bottom.equalTo(self.view);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">NNContentTableView *<span class="attr">articleTableView</span> = [[NNContentTableView alloc] init];</span><br><span class="line">articleTableView.<span class="attr">delegate</span>            = self;</span><br><span class="line">articleTableView.<span class="attr">separatorStyle</span>      = UITableViewCellSeparatorStyleNone;</span><br><span class="line">self.<span class="attr">articleTableView</span>                = articleTableView;</span><br><span class="line">articleTableView.<span class="attr">tableHeaderView</span>     = headView;</span><br><span class="line">[scrollView addSubview:articleTableView];</span><br><span class="line">[articleTableView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">make.left.equalTo(scrollView).offset(NNScreenWidth);</span><br><span class="line">make.width.equalTo(dynamicTableView);</span><br><span class="line">make.top.bottom.equalTo(dynamicTableView);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">NNContentTableView *<span class="attr">moreTableView</span> = [[NNContentTableView alloc] init];</span><br><span class="line">moreTableView.<span class="attr">delegate</span>            = self;</span><br><span class="line">moreTableView.<span class="attr">separatorStyle</span>      = UITableViewCellSeparatorStyleNone;</span><br><span class="line">self.<span class="attr">moreTableView</span>                = moreTableView;</span><br><span class="line">moreTableView.<span class="attr">tableHeaderView</span>     = headView;</span><br><span class="line">[scrollView addSubview:moreTableView];</span><br><span class="line">[moreTableView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">make.left.equalTo(scrollView).offset(NNScreenWidth * <span class="number">2</span>);</span><br><span class="line">make.width.equalTo(dynamicTableView);</span><br><span class="line">make.top.bottom.equalTo(dynamicTableView);</span><br><span class="line">&#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>左右或上下滑动页面</p>
</li>
<li>这里为 UIScrollView 添加了代理，一旦滑动视图，便会调用下面这两个方法。为了区分是左右滑动还是上下滑动，这里做了简单的判断，<code>if (scrollView == self.scrollView)</code>，那么这就是左右滑动，因为 UITableView 是上下滑动的，所有左右滑动就是 UIScrollView 的滑动，需要切换 UITableView 的显示内容，在这里做相应的操作即可；如果 <code>if (scrollView == self.scrollView || !scrollView.window)</code>这个条件不成立，那么就是 UITableView 的滑动，就是上下滑动，在这里需要改变“标签栏”的frame，因为“标签栏”需要显示在导航栏下边位置。<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#pragma mark - UIScrollViewDelegate</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidEndDecelerating:(<span class="built_in">UIScrollView</span> *)scrollView &#123;</span><br><span class="line"><span class="keyword">if</span> (scrollView == <span class="keyword">self</span>.scrollView) &#123;</span><br><span class="line"><span class="built_in">CGFloat</span> contentOffsetX       = scrollView.contentOffset.x;</span><br><span class="line"><span class="built_in">NSInteger</span> pageNum            = contentOffsetX / NNScreenWidth + <span class="number">0.5</span>;</span><br><span class="line"><span class="keyword">self</span>.titleView.selectedIndex = pageNum;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidScroll:(<span class="built_in">UIScrollView</span> *)scrollView &#123;</span><br><span class="line"><span class="keyword">if</span> (scrollView == <span class="keyword">self</span>.scrollView || !scrollView.window) &#123;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">CGFloat</span> offsetY      = scrollView.contentOffset.y;</span><br><span class="line"><span class="built_in">CGFloat</span> originY      = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">CGFloat</span> otherOffsetY = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (offsetY &lt;= NNHeadViewHeight) &#123;</span><br><span class="line">originY              = -offsetY;</span><br><span class="line"><span class="keyword">if</span> (offsetY &lt; <span class="number">0</span>) &#123;</span><br><span class="line">otherOffsetY         = <span class="number">0</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">otherOffsetY         = offsetY;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">originY              = -NNHeadViewHeight;</span><br><span class="line">otherOffsetY         = NNHeadViewHeight;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">self</span>.headerView.frame = <span class="built_in">CGRectMake</span>(<span class="number">0</span>, originY, NNScreenWidth, NNHeadViewHeight + NNTitleHeight);</span><br><span class="line"><span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">self</span>.titleView.titles.count; i++ ) &#123;</span><br><span class="line"><span class="keyword">if</span> (i != <span class="keyword">self</span>.titleView.selectedIndex) &#123;</span><br><span class="line"><span class="built_in">UITableView</span> *contentView = <span class="keyword">self</span>.scrollView.subviews[i];</span><br><span class="line"><span class="built_in">CGPoint</span> offset = <span class="built_in">CGPointMake</span>(<span class="number">0</span>, otherOffsetY);</span><br><span class="line"><span class="keyword">if</span> ([contentView isKindOfClass:[<span class="built_in">UITableView</span> <span class="keyword">class</span>]]) &#123;</span><br><span class="line"><span class="keyword">if</span> (contentView.contentOffset.y &lt; NNHeadViewHeight || offset.y &lt; NNHeadViewHeight) &#123;</span><br><span class="line">[contentView setContentOffset:offset animated:<span class="literal">NO</span>];</span><br><span class="line"><span class="keyword">self</span>.scrollView.offset = offset;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>上面只是简单的介绍下，具体的代码还请到 <a href="https://github.com/liuzhongning/NNJaneBookView" target="_blank" rel="noopener">demo 中</a> 查看，如有疑问或有建议的地方，欢迎讨论。</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">刘朋坤</p>
              <p class="site-description motion-element" itemprop="description">iOS 修炼中...</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives">
                
                    <span class="site-state-item-count">44</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              

              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">刘朋坤</span>

  

  
</div>




  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Muse</a> v6.1.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.1.0"></script>



  



	





  





  










  





  

  

  

  

  
  

  

  

  

  

</body>
</html>
