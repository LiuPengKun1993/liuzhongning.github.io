<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.1.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.1.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.1.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="iOS ä¿®ç‚¼ä¸­...">
<meta property="og:type" content="website">
<meta property="og:title" content="ä»¥æ¢¦ä¸ºé©¬">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="ä»¥æ¢¦ä¸ºé©¬">
<meta property="og:description" content="iOS ä¿®ç‚¼ä¸­...">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ä»¥æ¢¦ä¸ºé©¬">
<meta name="twitter:description" content="iOS ä¿®ç‚¼ä¸­...">






  <link rel="canonical" href="http://yoursite.com/page/3/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>ä»¥æ¢¦ä¸ºé©¬</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ä»¥æ¢¦ä¸ºé©¬</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">è°¨ä»¥æ­¤çºªå¿µå²æœˆ</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>




<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-ä¸»é¡µ">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />ä¸»é¡µ</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-å½’æ¡£">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />å½’æ¡£</a>
  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/iOSå¼€å‘ä¹‹ - Runtime/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="åˆ˜æœ‹å¤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ä»¥æ¢¦ä¸ºé©¬">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/iOSå¼€å‘ä¹‹ - Runtime/" itemprop="url">
                  iOSå¼€å‘ä¹‹ - Runtime
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://upload-images.jianshu.io/upload_images/2665449-59759f8fb21bb6a9.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOSå¼€å‘ä¹‹ - Runtime"></p>
<blockquote>
<p>æƒ³æ€»ç»“ Runtime ä¸æ˜¯ä¸€å¤©ä¸¤å¤©äº†ï¼Œå‰å‡ å¤©åˆ©ç”¨ç©ºé—²æ—¶é—´å·²ç»æ‰“å¥½æ–‡ç¨¿ï¼Œä½†è§‰å¾—è¿˜æœ‰éœ€è¦æ”¹è¿›çš„åœ°æ–¹ï¼Œç°åœ¨å·²ç»æ”¹è¿‡æ¥äº†ï¼Œè¿™é‡Œè´´å‡ºæ¥ä¸å¤§å®¶åˆ†äº«ä¸‹ï¼ˆå¦‚æœè¿˜æœ‰ä»€ä¹ˆå°é—®é¢˜ï¼Œè¿˜æœ›å„ä½æœ‹å‹æŒ‡å‡ºæ¥å“ˆï¼‰! ä¸‹é¢æˆ‘ä»¬å°±å¼€å§‹è¿›å…¥è¿è¡Œæ—¶ Runtime çš„ä¸–ç•Œå§ï¼</p>
</blockquote>
<h2 id="ä¸€ã€Runtimeç®€ä»‹"><a href="#ä¸€ã€Runtimeç®€ä»‹" class="headerlink" title="ä¸€ã€Runtimeç®€ä»‹"></a>ä¸€ã€Runtimeç®€ä»‹</h2><p>Runtimeç®€ç§°è¿è¡Œæ—¶ï¼Œæ˜¯ç³»ç»Ÿåœ¨è¿è¡Œçš„æ—¶å€™çš„ä¸€äº›æœºåˆ¶ï¼Œå…¶ä¸­æœ€ä¸»è¦çš„æ˜¯æ¶ˆæ¯æœºåˆ¶ã€‚å®ƒæ˜¯ä¸€å¥—æ¯”è¾ƒåº•å±‚çš„çº¯ C è¯­è¨€ API, å±äºä¸€ä¸ª C è¯­è¨€åº“ï¼ŒåŒ…å«äº†å¾ˆå¤šåº•å±‚çš„ C è¯­è¨€ APIã€‚æˆ‘ä»¬å¹³æ—¶ç¼–å†™çš„ OC ä»£ç ï¼Œåœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹æ—¶ï¼Œå…¶å®æœ€ç»ˆéƒ½æ˜¯è½¬æˆäº† Runtime çš„ C è¯­è¨€ä»£ç ã€‚å¦‚ä¸‹æ‰€ç¤º:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// OCä»£ç :</span></span><br><span class="line"><span class="selector-attr">[Person coding]</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿è¡Œæ—¶ runtime ä¼šå°†å®ƒè½¬åŒ–æˆ C è¯­è¨€çš„ä»£ç :</span></span><br><span class="line"><span class="selector-tag">objc_msgSend</span>(Person, <span class="variable">@selector</span>(coding));</span><br></pre></td></tr></table></figure>
<h2 id="äºŒã€ç›¸å…³å‡½æ•°"><a href="#äºŒã€ç›¸å…³å‡½æ•°" class="headerlink" title="äºŒã€ç›¸å…³å‡½æ•°"></a>äºŒã€ç›¸å…³å‡½æ•°</h2><figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// éå†æŸä¸ªç±»æ‰€æœ‰çš„æˆå‘˜å˜é‡</span></span><br><span class="line"><span class="keyword">class</span><span class="number">_</span>copyIvarList</span><br><span class="line"></span><br><span class="line"><span class="comment">// éå†æŸä¸ªç±»æ‰€æœ‰çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">class</span><span class="number">_</span>copyMethodList</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–æŒ‡å®šåç§°çš„æˆå‘˜å˜é‡</span></span><br><span class="line"><span class="keyword">class</span><span class="number">_</span>getInstanceVariable</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–æˆå‘˜å˜é‡å</span></span><br><span class="line">ivar<span class="number">_</span>getName</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–æˆå‘˜å˜é‡ç±»å‹ç¼–ç </span></span><br><span class="line">ivar<span class="number">_</span>getTypeEncoding</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–æŸä¸ªå¯¹è±¡æˆå‘˜å˜é‡çš„å€¼</span></span><br><span class="line"><span class="keyword">object</span><span class="number">_</span>getIvar</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®æŸä¸ªå¯¹è±¡æˆå‘˜å˜é‡çš„å€¼</span></span><br><span class="line"><span class="keyword">object</span><span class="number">_</span>setIvar</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»™å¯¹è±¡å‘é€æ¶ˆæ¯</span></span><br><span class="line">objc<span class="number">_m</span>sgSend</span><br></pre></td></tr></table></figure>
<h2 id="ä¸‰ã€ç›¸å…³åº”ç”¨"><a href="#ä¸‰ã€ç›¸å…³åº”ç”¨" class="headerlink" title="ä¸‰ã€ç›¸å…³åº”ç”¨"></a>ä¸‰ã€ç›¸å…³åº”ç”¨</h2><ul>
<li>1.åˆ©ç”¨Runtimeéå†æ¨¡å‹å¯¹è±¡çš„æ‰€æœ‰å±æ€§</li>
<li>2.å½’æ¡£ä¸è§£æ¡£</li>
<li>3.å­—å…¸æ¨¡å‹äº’è½¬(åˆ©ç”¨ Runtime éå†æ¨¡å‹å¯¹è±¡çš„æ‰€æœ‰å±æ€§, æ ¹æ®å±æ€§åä»å­—å…¸ä¸­å–å‡ºå¯¹çš„å€¼,è®¾ç½®åˆ°æ¨¡å‹çš„å±æ€§ä¸Š)</li>
<li>4.åŠ¨æ€æ·»åŠ /ä¿®æ”¹å±æ€§ã€åŠ¨æ€æ·»åŠ /ä¿®æ”¹/æ›¿æ¢æ–¹æ³•(ä¿®æ”¹Personçš„èº«é«˜ä½“é‡ç­‰ï¼›æ›¿æ¢ coding æ–¹æ³•ä¸º eating ç­‰)</li>
</ul>
<h2 id="å››ã€æ¼”ç¤ºä»£ç "><a href="#å››ã€æ¼”ç¤ºä»£ç " class="headerlink" title="å››ã€æ¼”ç¤ºä»£ç "></a>å››ã€æ¼”ç¤ºä»£ç </h2><h3 id="æ¼”ç¤ºä»£ç ä¸€ï¼šéå†å¯¹è±¡çš„å±æ€§"><a href="#æ¼”ç¤ºä»£ç ä¸€ï¼šéå†å¯¹è±¡çš„å±æ€§" class="headerlink" title="æ¼”ç¤ºä»£ç ä¸€ï¼šéå†å¯¹è±¡çš„å±æ€§"></a>æ¼”ç¤ºä»£ç ä¸€ï¼šéå†å¯¹è±¡çš„å±æ€§</h3><p>æ–°å»ºä¸€ä¸ªPersonç±»ï¼Œç»§æ‰¿è‡ªNSObjectï¼Œåœ¨.hæ–‡ä»¶ä¸­è®¾ç½®å®ƒçš„å±æ€§å¦‚ä¸‹</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NNPerson</span> : <span class="title">NSObject</span> </span>&#123;</span><br><span class="line"><span class="built_in">NSString</span> * _str1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> <span class="built_in">NSString</span> * str2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *str3;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSDictionary</span> * dict;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSArray</span> *ary;</span><br></pre></td></tr></table></figure>
<p>åœ¨ ViewController ä¸­è·å–å®ƒçš„å±æ€§ï¼Œä»£ç å¦‚ä¸‹</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;objc/runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"NNPerson.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">[<span class="keyword">super</span> viewDidLoad];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å– NNModel ä¸­æ‰€æœ‰çš„å˜é‡å¹¶ä¸”è¾“å‡ºå˜é‡ååŠç±»å‹</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">Ivar * ivars = class_copyIvarList([NNPerson <span class="keyword">class</span>], &amp;count);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">unsigned</span> <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i ++) &#123;</span><br><span class="line">Ivar ivar = ivars[i];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"ç±»å‹: %s -åå­—: %s "</span>, ivar_getTypeEncoding(ivar), ivar_getName(ivar));</span><br><span class="line">&#125;</span><br><span class="line">free(ivars);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ¼”ç¤ºä»£ç äºŒï¼šå½’æ¡£è§£æ¡£"><a href="#æ¼”ç¤ºä»£ç äºŒï¼šå½’æ¡£è§£æ¡£" class="headerlink" title="æ¼”ç¤ºä»£ç äºŒï¼šå½’æ¡£è§£æ¡£"></a>æ¼”ç¤ºä»£ç äºŒï¼šå½’æ¡£è§£æ¡£</h3><p>æ–°å»ºä¸€ä¸ªç±»ï¼Œç»§æ‰¿è‡ª NSObject ã€‚.mä¸­çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#pragma mark -å½’æ¡£</span></span><br><span class="line">- (<span class="keyword">void</span>)encodeWithCoder:(<span class="built_in">NSCoder</span> *)aCoder &#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//è·å–ç±»ä¸­æ‰€æœ‰å±æ€§</span></span><br><span class="line">Ivar *vars = class_copyIvarList([<span class="keyword">self</span> <span class="keyword">class</span>], &amp;count);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">unsigned</span> <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i ++) &#123;</span><br><span class="line">Ivar var = vars[i];</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *name = ivar_getName(var);</span><br><span class="line"><span class="built_in">NSString</span> *key = [<span class="built_in">NSString</span> stringWithUTF8String:name];</span><br><span class="line"><span class="comment">//åˆ©ç”¨ KVC è¿›è¡Œå–å€¼ï¼Œæ ¹æ®å±æ€§åç§°è·å–å¯¹åº”çš„å€¼</span></span><br><span class="line"><span class="keyword">id</span> value = [<span class="keyword">self</span> valueForKey:key];</span><br><span class="line">[aCoder encodeObject:value forKey:key];</span><br><span class="line">&#125;</span><br><span class="line">free(vars);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark -è§£æ¡£</span></span><br><span class="line">- (<span class="keyword">nullable</span> <span class="keyword">instancetype</span>)initWithCoder:(<span class="built_in">NSCoder</span> *)aDecoder &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span> = [<span class="keyword">super</span> init]) &#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//è·å–ç±»ä¸­æ‰€æœ‰å±æ€§</span></span><br><span class="line">Ivar *vars = class_copyIvarList([<span class="keyword">self</span> <span class="keyword">class</span>], &amp;count);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">unsigned</span> <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i ++) &#123;</span><br><span class="line">Ivar var = vars[i];</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *name = ivar_getName(var);</span><br><span class="line"><span class="built_in">NSString</span> *key = [<span class="built_in">NSString</span> stringWithUTF8String:name];</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿›è¡Œè§£æ¡£å–å€¼</span></span><br><span class="line"><span class="keyword">id</span> value = [aDecoder decodeObjectForKey:key];</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ©ç”¨ KVC å¯¹å±æ€§èµ‹å€¼</span></span><br><span class="line">[<span class="keyword">self</span> setValue:value forKey:key];</span><br><span class="line">&#125;</span><br><span class="line">free(vars);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ViewControllerä¸­çš„ä»£ç ï¼š<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">[<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">LZNArchive *archive = [LZNArchive objectWithKeyValues:<span class="keyword">self</span>.Mydictionary];</span><br><span class="line"><span class="built_in">NSString</span> *path = <span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSDocumentDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>).lastObject;</span><br><span class="line">path = [path stringByAppendingPathComponent:<span class="string">@"hello"</span>];</span><br><span class="line">[<span class="built_in">NSKeyedArchiver</span> archiveRootObject:archive toFile:path];</span><br><span class="line">LZNArchive *m = [<span class="built_in">NSKeyedUnarchiver</span> unarchiveObjectWithFile:path];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="æ¼”ç¤ºä»£ç ä¸‰ï¼šå­—å…¸ä¸æ¨¡å‹äº’è½¬"><a href="#æ¼”ç¤ºä»£ç ä¸‰ï¼šå­—å…¸ä¸æ¨¡å‹äº’è½¬" class="headerlink" title="æ¼”ç¤ºä»£ç ä¸‰ï¼šå­—å…¸ä¸æ¨¡å‹äº’è½¬"></a>æ¼”ç¤ºä»£ç ä¸‰ï¼šå­—å…¸ä¸æ¨¡å‹äº’è½¬</h3><p>é¦–å…ˆåº”å¯¼å…¥ä¸€ä¸ª plist æ–‡ä»¶ï¼Œå°†æ–‡ä»¶ä¸­çš„å†…å®¹è¯»å–åˆ°å­—å…¸ä¸­ï¼›ç„¶åæ–°å»ºä¸€ä¸ªåˆ†ç±»å¦‚: NSObject+KeyValues<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#pragma mark -å­—å…¸è½¬æ¨¡å‹</span></span><br><span class="line"></span><br><span class="line">+(<span class="keyword">instancetype</span>)objectWithDict:(<span class="built_in">NSDictionary</span> *)dict &#123;</span><br><span class="line"><span class="keyword">id</span> objc = [[<span class="keyword">self</span> alloc] init];</span><br><span class="line"></span><br><span class="line"><span class="comment">//éå†å­—å…¸ä¸­çš„å±æ€§</span></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSString</span> *key <span class="keyword">in</span> dict.allKeys) &#123;</span><br><span class="line"><span class="keyword">id</span> value = dict[key];</span><br><span class="line">objc_property_t property = class_getProperty(<span class="keyword">self</span>, key.UTF8String);</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">objc_property_attribute_t *attributeList = property_copyAttributeList(property, &amp;count);</span><br><span class="line">objc_property_attribute_t attribute = attributeList[<span class="number">0</span>];</span><br><span class="line"><span class="built_in">NSString</span> *string = [<span class="built_in">NSString</span> stringWithUTF8String:attribute.value];</span><br><span class="line"><span class="keyword">if</span> ([string isEqualToString:<span class="string">@"@\"LZNArchive\""</span>]) &#123;</span><br><span class="line">value = [<span class="keyword">self</span> objectWithDict:value];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”Ÿæˆ setter æ–¹æ³•ï¼Œå¹¶ç”¨ objc_msgSend è°ƒç”¨</span></span><br><span class="line"><span class="built_in">NSString</span> *methodName = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"set%@%@:"</span>,[key substringToIndex:<span class="number">1</span>].uppercaseString,[key substringFromIndex:<span class="number">1</span>]];</span><br><span class="line">SEL <span class="keyword">setter</span> = sel_registerName(methodName.UTF8String);</span><br><span class="line"><span class="keyword">if</span> ([objc respondsToSelector:<span class="keyword">setter</span>]) &#123;</span><br><span class="line">((<span class="keyword">void</span> (*) (<span class="keyword">id</span>,SEL,<span class="keyword">id</span>)) objc_msgSend) (objc,<span class="keyword">setter</span>,value);</span><br><span class="line">&#125;</span><br><span class="line">free(attributeList);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> objc;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark -æ¨¡å‹è½¬å­—å…¸</span></span><br><span class="line">-(<span class="built_in">NSDictionary</span> *)keyValuesWithObject &#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">objc_property_t *propertyList = class_copyPropertyList([<span class="keyword">self</span> <span class="keyword">class</span>], &amp;count);</span><br><span class="line"><span class="built_in">NSMutableDictionary</span> *dict = [<span class="built_in">NSMutableDictionary</span> dictionary];</span><br><span class="line"></span><br><span class="line"><span class="comment">//éå†æ¨¡å‹ä¸­å±æ€§</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i ++) &#123;</span><br><span class="line">objc_property_t property = propertyList[i];</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”Ÿæˆ getter æ–¹æ³•ï¼Œå¹¶ç”¨ objc_msgSend è°ƒç”¨</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *propertyName = property_getName(property);</span><br><span class="line">SEL <span class="keyword">getter</span> = sel_registerName(propertyName);</span><br><span class="line"><span class="keyword">if</span> ([<span class="keyword">self</span> respondsToSelector:<span class="keyword">getter</span>]) &#123;</span><br><span class="line"><span class="keyword">id</span> value = ((<span class="keyword">id</span> (*) (<span class="keyword">id</span>,SEL)) objc_msgSend) (<span class="keyword">self</span>,<span class="keyword">getter</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ¤æ–­å½“å‰å±æ€§</span></span><br><span class="line"><span class="keyword">if</span> ([value isKindOfClass:[<span class="keyword">self</span> <span class="keyword">class</span>]] &amp;&amp; value) &#123;</span><br><span class="line">value = [value keyValuesWithObject];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (value) &#123;</span><br><span class="line"><span class="built_in">NSString</span> *key = [<span class="built_in">NSString</span> stringWithUTF8String:propertyName];</span><br><span class="line">[dict setObject:value forKey:key];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">free(propertyList);</span><br><span class="line"><span class="keyword">return</span> dict;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="æ¼”ç¤ºä»£ç å››ï¼šobjc-msgSend-æ¶ˆæ¯ä¼ é€’"><a href="#æ¼”ç¤ºä»£ç å››ï¼šobjc-msgSend-æ¶ˆæ¯ä¼ é€’" class="headerlink" title="æ¼”ç¤ºä»£ç å››ï¼šobjc_msgSend æ¶ˆæ¯ä¼ é€’"></a>æ¼”ç¤ºä»£ç å››ï¼šobjc_msgSend æ¶ˆæ¯ä¼ é€’</h3><p>æ–°å»ºä¸€ä¸ªç±»ï¼Œç»§æ‰¿è‡ªNSObjectï¼Œ.mä¸­çš„ä»£ç å¦‚ä¸‹:<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)sayHello &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"Hello!"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)showName:(<span class="built_in">NSString</span> *)name &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"My name is %@"</span>,name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)showAge:(<span class="built_in">NSInteger</span>)age &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"My age is %ld"</span>, age);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">float</span>)showHeight&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">180.0</span>f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="built_in">NSString</span> *)showInformation &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">@"Nice to meet you!"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ViewControllerä¸­çš„ä»£ç :<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">LZN_msgSend *msgSend = [[LZN_msgSend alloc] init];</span><br><span class="line">((<span class="keyword">void</span> (*) (<span class="keyword">id</span>, SEL)) objc_msgSend) (msgSend, sel_registerName(<span class="string">"sayHello"</span>));</span><br><span class="line"></span><br><span class="line">((<span class="keyword">void</span> (*) (<span class="keyword">id</span>, SEL, <span class="built_in">NSString</span> *)) objc_msgSend) (msgSend, sel_registerName(<span class="string">"showName:"</span>), <span class="string">@"Liu Zhong Ning"</span>);</span><br><span class="line"></span><br><span class="line">((<span class="keyword">void</span> (*) (<span class="keyword">id</span>, SEL, <span class="built_in">NSInteger</span>)) objc_msgSend) (msgSend, sel_registerName(<span class="string">"showAge:"</span>), <span class="number">23</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">float</span> f = ((<span class="keyword">float</span> (*) (<span class="keyword">id</span>, SEL)) objc_msgSend_fpret) (msgSend, sel_registerName(<span class="string">"showHeight"</span>));</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"and height is %.2fcm"</span>,f);</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSString</span> *information = ((<span class="built_in">NSString</span>* (*) (<span class="keyword">id</span>, SEL)) objc_msgSend) (msgSend, sel_registerName(<span class="string">"showInformation"</span>));</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,information);</span><br></pre></td></tr></table></figure></p>
<p><em>the end</em></p>
<hr>
<p><strong>ç»“æŸè¯­ï¼šRuntime ç›¸å…³çš„çŸ¥è¯†å°±æ•´ç†äº†è¿™ä¹ˆäº›ï¼Œå¸Œæœ›å¯¹çœ‹åˆ°çš„æœ‹å‹ä»¬æœ‰ç”¨ï¼å¦å¤–å¦‚æœ demo æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œè¿˜çƒ¦è¯·å¤§å®¶å‘ŠçŸ¥ï¼Œä¸€èµ·è¿›æ­¥ï¼è°¢è°¢O(âˆ©_âˆ©)O~! å¦ç¥å¤§å®¶å‘¨æœ«æ„‰å¿«å“ˆï¼</strong></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/iOSå¼€å‘ä¹‹ - SDWebImage çš„ä½¿ç”¨/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="åˆ˜æœ‹å¤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ä»¥æ¢¦ä¸ºé©¬">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/iOSå¼€å‘ä¹‹ - SDWebImage çš„ä½¿ç”¨/" itemprop="url">
                  iOSå¼€å‘ä¹‹ - SDWebImage çš„ä½¿ç”¨
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://upload-images.jianshu.io/upload_images/2665449-6e9f0fccaeeca1e8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="SDWebImage"></p>
<blockquote>
<p><a href="https://github.com/rs/SDWebImage" target="_blank" rel="noopener">SDWebImage</a> æ˜¯ä¸€ä¸ªå¼€æºçš„ç¬¬ä¸‰æ–¹åº“ï¼Œåœ¨æˆ‘ä»¬ iOS å¼€å‘ä¸­ç”¨åˆ° SDWebImage çš„åœ°æ–¹æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚åœ¨ tableView ä¸­ï¼Œåœ¨ collectionView ä¸­â€¦â€¦ä¸ç„¶å®ƒä¹Ÿä¸ä¼šé«˜è¾¾ 16000+ è¿™ä¹ˆå¤šçš„ Star äº†ğŸ˜„ã€‚ä¸‹é¢æ˜¯æ€»ç»“çš„ä¸€äº› SDWebImage ç›¸å…³çš„å…·ä½“ç”¨æ³•ã€‚</p>
</blockquote>
<p>é¦–å…ˆç”¨ cocoapods å¯¼å…¥ SDWebImage æ¡†æ¶ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šå®‰è£…ä»¥åŠä½¿ç”¨ cocoapods çš„æ•™ç¨‹ï¼Œåœ¨æ­¤å°±ä¸ç´¯è¿°äº†ï¼Œè¿™ç¯‡æ–‡ç« çš„å†…å®¹æ˜¯åœ¨å¯¼å…¥ SDWebImage åŸºç¡€ä¹‹ä¸Šçš„ï¼Œä¸»è¦æ˜¯æ€»ç»“äº†ä¸€äº› SDWebImage çš„å…·ä½“ç”¨æ³•ã€‚</p>
<ul>
<li><p>ç®€å•ä¸‹è½½å›¾ç‰‡</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">æ–¹å¼ä¸€ï¼š</span><br><span class="line"><span class="comment">// åªä¸‹è½½å›¾ç‰‡</span></span><br><span class="line">[self.imageView <span class="string">sd_setImageWithURL:</span>@<span class="string">"URLåœ°å€"</span>]];</span><br><span class="line"></span><br><span class="line">æ–¹å¼äºŒï¼š</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">ç¬¬ä¸€ä¸ªå‚æ•°:å›¾ç‰‡çš„url</span></span><br><span class="line"><span class="comment">ç¬¬äºŒä¸ªå‚æ•°:å ä½å›¾ç‰‡</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">[self.imageView <span class="string">sd_setImageWithURL:</span>[NSURL <span class="string">URLWithString:</span>@<span class="string">"URLåœ°å€"</span>]</span><br><span class="line"><span class="string">placeholderImage:</span>[UIImage <span class="string">imageNamed:</span> @<span class="string">"å ä½å›¾ç‰‡å"</span>]];</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¸‹è½½æˆåŠŸæˆ–å¤±è´¥ä¹‹ååšçš„äº‹æƒ…</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">æ–¹å¼ä¸€ï¼š</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">ç¬¬ä¸€ä¸ªå‚æ•°:å›¾ç‰‡çš„url</span></span><br><span class="line"><span class="comment">block:ä¸‹è½½æˆåŠŸæˆ–å¤±è´¥ä¹‹åçš„å›è°ƒ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">[<span class="keyword">self</span>.imageView sd_setImageWithURL:[<span class="built_in">NSURL</span> URLWithString:<span class="string">@"URLåœ°å€"</span>]</span><br><span class="line">completed:^(<span class="built_in">UIImage</span> *image, <span class="built_in">NSError</span> *error, SDImageCacheType cacheType, <span class="built_in">NSURL</span> *imageURL) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"ä¸‹è½½æˆåŠŸæˆ–å¤±è´¥ä¹‹åçš„å›è°ƒ"</span>);</span><br><span class="line">&#125;];</span><br><span class="line">æ–¹å¼äºŒï¼š</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">ç¬¬ä¸€ä¸ªå‚æ•°:å›¾ç‰‡çš„url</span></span><br><span class="line"><span class="comment">ç¬¬äºŒä¸ªå‚æ•°:å ä½å›¾ç‰‡</span></span><br><span class="line"><span class="comment">block:ä¸‹è½½æˆåŠŸæˆ–å¤±è´¥ä¹‹åçš„å›è°ƒ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">[<span class="keyword">self</span>.imageView sd_setImageWithURL:[<span class="built_in">NSURL</span> URLWithString:<span class="string">@"URLåœ°å€"</span>]</span><br><span class="line">placeholderImage:[<span class="built_in">UIImage</span> imageNamed: <span class="string">@"å ä½å›¾ç‰‡å"</span>]</span><br><span class="line">completed:^(<span class="built_in">UIImage</span> *image, <span class="built_in">NSError</span> *error, SDImageCacheType cacheType, <span class="built_in">NSURL</span> *imageURL) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"ä¸‹è½½æˆåŠŸæˆ–å¤±è´¥ä¹‹åçš„å›è°ƒ"</span>);</span><br><span class="line">&#125;];</span><br><span class="line">æ–¹å¼ä¸‰ï¼š</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">ç¬¬ä¸€ä¸ªå‚æ•°:å›¾ç‰‡çš„url</span></span><br><span class="line"><span class="comment">ç¬¬äºŒä¸ªå‚æ•°:å ä½å›¾ç‰‡</span></span><br><span class="line"><span class="comment">ç¬¬ä¸‰ä¸ªå‚æ•°:ä¸‹è½½å›¾ç‰‡çš„ç­–ç•¥</span></span><br><span class="line"><span class="comment">ç¬¬å››ä¸ªå‚æ•°:progressè¿›åº¦</span></span><br><span class="line"><span class="comment">ç¬¬äº”ä¸ªå‚æ•°:completed ä¸‹è½½å®Œæˆä¹‹åçš„å›è°ƒ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">[<span class="keyword">self</span>.imageView sd_setImageWithURL:[<span class="built_in">NSURL</span> URLWithString:<span class="string">@"URLåœ°å€"</span>]</span><br><span class="line">placeholderImage:[<span class="built_in">UIImage</span> imageNamed: <span class="string">@"å ä½å›¾ç‰‡å"</span>]</span><br><span class="line">options:SDWebImageRetryFailed</span><br><span class="line">progress:^(<span class="built_in">NSInteger</span> receivedSize, <span class="built_in">NSInteger</span> expectedSize) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"progressè¿›åº¦"</span>);</span><br><span class="line">&#125;</span><br><span class="line">completed:^(<span class="built_in">UIImage</span> *image, <span class="built_in">NSError</span> *error, SDImageCacheType cacheType, <span class="built_in">NSURL</span> *imageURL) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"ä¸‹è½½æˆåŠŸæˆ–å¤±è´¥ä¹‹åçš„å›è°ƒ"</span>);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
</li>
<li><p>å€Ÿç”¨ä¸€ä¸ªæ–¹æ³•ç®€å•çš„ä»‹ç»ä¸€ä¸‹ options ä¸­çš„é€‰é¡¹</p>
<figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"><span class="comment">//å¤±è´¥åé‡è¯•</span></span><br><span class="line">SDWebImageRetryFailed = <span class="number">1</span> &lt;&lt; <span class="number">0</span>,</span><br><span class="line"><span class="comment">//UIäº¤äº’æœŸé—´å¼€å§‹ä¸‹è½½ï¼Œå¯¼è‡´å»¶è¿Ÿä¸‹è½½æ¯”å¦‚UIScrollViewå‡é€Ÿã€‚</span></span><br><span class="line">SDWebImageLowPriority = <span class="number">1</span> &lt;&lt; <span class="number">1</span>,</span><br><span class="line"><span class="comment">//åªè¿›è¡Œå†…å­˜ç¼“å­˜</span></span><br><span class="line">SDWebImageCacheMemoryOnly = <span class="number">1</span> &lt;&lt; <span class="number">2</span>,</span><br><span class="line"><span class="comment">//è¿™ä¸ªæ ‡å¿—å¯ä»¥æ¸è¿›å¼ä¸‹è½½,æ˜¾ç¤ºçš„å›¾åƒæ˜¯é€æ­¥åœ¨ä¸‹è½½</span></span><br><span class="line">SDWebImageProgressiveDownload = <span class="number">1</span> &lt;&lt; <span class="number">3</span>,</span><br><span class="line"><span class="comment">//åˆ·æ–°ç¼“å­˜</span></span><br><span class="line">SDWebImageRefreshCached = <span class="number">1</span> &lt;&lt; <span class="number">4</span>,</span><br><span class="line"><span class="comment">//åå°ä¸‹è½½</span></span><br><span class="line">SDWebImageContinueInBackground = <span class="number">1</span> &lt;&lt; <span class="number">5</span>,</span><br><span class="line"><span class="comment">//NSMutableURLRequest.HTTPShouldHandleCookies = YES;</span></span><br><span class="line">SDWebImageHandleCookies = <span class="number">1</span> &lt;&lt; <span class="number">6</span>,</span><br><span class="line"><span class="comment">//å…è®¸ä½¿ç”¨æ— æ•ˆçš„SSLè¯ä¹¦</span></span><br><span class="line"><span class="comment">//SDWebImageAllowInvalidSSLCertificates = 1 &lt;&lt; 7,</span></span><br><span class="line"><span class="comment">//ä¼˜å…ˆä¸‹è½½</span></span><br><span class="line">SDWebImageHighPriority = <span class="number">1</span> &lt;&lt; <span class="number">8</span>,</span><br><span class="line"><span class="comment">//å»¶è¿Ÿå ä½ç¬¦</span></span><br><span class="line">SDWebImageDelayPlaceholder = <span class="number">1</span> &lt;&lt; <span class="number">9</span>,</span><br><span class="line"><span class="comment">//æ”¹å˜åŠ¨ç”»å½¢è±¡</span></span><br><span class="line">SDWebImageTransformAnimatedImage = <span class="number">1</span> &lt;&lt; <span class="number">10</span>,</span><br><span class="line">*/</span><br><span class="line">[self.imageView sd_setImageWithURL:[NSURL URLWithString:@<span class="string">"URLåœ°å€"</span>]</span><br><span class="line">placeholderImage:[UIImage imageNamed: @<span class="string">"å ä½å›¾ç‰‡å"</span>]</span><br><span class="line">options:SDWebImageRetryFailed];</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨ SDWebImageManager ä¸‹è½½å›¾ç‰‡</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">SDWebImageManager *imageManager = [SDWebImageManager sharedManager];</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">ç¬¬ä¸€ä¸ªå‚æ•°:å›¾ç‰‡çš„url</span></span><br><span class="line"><span class="comment">ç¬¬äºŒä¸ªå‚æ•°:ä¸‹è½½å›¾ç‰‡çš„(ç­–ç•¥)</span></span><br><span class="line"><span class="comment">ç¬¬ä¸‰ä¸ªå‚æ•°:progressè¿›åº¦</span></span><br><span class="line"><span class="comment">ç¬¬å››ä¸ªå‚æ•°:completed ä¸‹è½½å®Œæˆä¹‹åçš„å›è°ƒ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">[imageManager downloadImageWithURL:[<span class="built_in">NSURL</span> URLWithString:<span class="string">@"URLåœ°å€"</span>]</span><br><span class="line">options:SDWebImageRetryFailed</span><br><span class="line">progress:^(<span class="built_in">NSInteger</span> receivedSize, <span class="built_in">NSInteger</span> expectedSize) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"progressè¿›åº¦"</span>);</span><br><span class="line">&#125;</span><br><span class="line">completed:^(<span class="built_in">UIImage</span> *image, <span class="built_in">NSError</span> *error, SDImageCacheType cacheType, <span class="built_in">BOOL</span> finished, <span class="built_in">NSURL</span> *imageURL) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"ä¸‹è½½æˆåŠŸæˆ–å¤±è´¥ä¹‹åçš„å›è°ƒ"</span>);</span><br><span class="line"><span class="keyword">if</span> (image) &#123;</span><br><span class="line"><span class="keyword">self</span>.image = image;</span><br><span class="line">&#125;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨ SDWebImageDownloader ä¸‹è½½å›¾ç‰‡</p>
</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">SDWebImageDownloader *imageDownloader = [SDWebImageDownloader sharedDownloader];</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ç¬¬ä¸€ä¸ªå‚æ•°:å›¾ç‰‡çš„url</span></span><br><span class="line"><span class="comment">ç¬¬äºŒä¸ªå‚æ•°:ä¸‹è½½å›¾ç‰‡çš„ç­–ç•¥</span></span><br><span class="line"><span class="comment">ç¬¬ä¸‰ä¸ªå‚æ•°:progressBlock è¿›åº¦</span></span><br><span class="line"><span class="comment">ç¬¬å››ä¸ªå‚æ•°:completedBlock ä¸‹è½½å®Œæˆä¹‹åçš„å›è°ƒ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">[imageDownloader downloadImageWithURL:[<span class="built_in">NSURL</span> URLWithString:<span class="string">@"URLåœ°å€"</span>]</span><br><span class="line">options:SDWebImageDownloaderLowPriority</span><br><span class="line">progress:^(<span class="built_in">NSInteger</span> receivedSize, <span class="built_in">NSInteger</span> expectedSize) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"progressè¿›åº¦"</span>);</span><br><span class="line">&#125;</span><br><span class="line">completed:^(<span class="built_in">UIImage</span> *image, <span class="built_in">NSData</span> *data, <span class="built_in">NSError</span> *error, <span class="built_in">BOOL</span> finished) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"ä¸‹è½½æˆåŠŸæˆ–å¤±è´¥ä¹‹åçš„å›è°ƒ"</span>);</span><br><span class="line"><span class="keyword">if</span> (image) &#123;</span><br><span class="line"><span class="keyword">self</span>.image = image;</span><br><span class="line">&#125;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<ul>
<li>å†…å­˜è­¦å‘Šæ—¶è°ƒç”¨</li>
</ul>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å½“ç¨‹åºæ”¶åˆ°å†…å­˜è­¦å‘Šæ—¶ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•</span></span><br><span class="line">- (<span class="keyword">void</span>)didReceiveMemoryWarning &#123;</span><br><span class="line">[<span class="meta">super didReceiveMemoryWarning</span>];</span><br><span class="line"><span class="comment">// æ¸…é™¤ç¼“å­˜</span></span><br><span class="line">[<span class="meta">[SDWebImageManager sharedManager</span>].imageCache clearDisk]; <span class="comment">// clean:åˆ é™¤è¿‡æœŸç¼“å­˜</span></span><br><span class="line">[<span class="meta">[SDWebImageManager sharedManager</span>].imageCache cleanDisk]; <span class="comment">// clear:ç›´æ¥åˆ é™¤ç„¶åé‡æ–°åˆ›å»º</span></span><br><span class="line"><span class="comment">// å–æ¶ˆä¸‹è½½</span></span><br><span class="line">[<span class="meta">[SDWebImageManager sharedManager</span>] cancelAll];</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>å…¶å®ƒä¸€äº›å¾ˆæœ‰ç”¨çš„æ–¹æ³•</li>
</ul>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å–æ¶ˆæ‰å½“å‰æ‰€æœ‰çš„ä¸‹è½½</span></span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">cancelAll</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ£€æŸ¥æ˜¯å¦æœ‰å›¾ç‰‡åœ¨ä¸‹è½½</span></span><br><span class="line"><span class="selector-tag">-</span> (BOOL)<span class="selector-tag">isRunning</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†å›¾ç‰‡å­˜å…¥cacheçš„æ–¹æ³•</span></span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">saveImageToCache</span><span class="selector-pseudo">:(UIImage</span> *)<span class="selector-tag">image</span> <span class="selector-tag">forURL</span><span class="selector-pseudo">:(NSURL</span> *)<span class="selector-tag">url</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šè¿‡å›¾ç‰‡çš„urlåˆ¤æ–­å…¶æ˜¯å¦å·²ç»å­˜åœ¨</span></span><br><span class="line"><span class="selector-tag">-</span> (BOOL)<span class="selector-tag">cachedImageExistsForURL</span><span class="selector-pseudo">:(NSURL</span> *)<span class="selector-tag">url</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ£€æµ‹ä¸€ä¸ªimageæ˜¯å¦å·²ç»è¢«ç¼“å­˜åˆ°ç£ç›˜(æ˜¯å¦å­˜ä¸”ä»…å­˜åœ¨diské‡Œ).</span></span><br><span class="line"><span class="selector-tag">-</span> (BOOL)<span class="selector-tag">diskImageExistsForURL</span><span class="selector-pseudo">:(NSURL</span> *)<span class="selector-tag">url</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœæ£€æµ‹åˆ°å›¾ç‰‡å·²ç»è¢«ç¼“å­˜,é‚£ä¹ˆæ‰§è¡Œå›è°ƒblock</span></span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">cachedImageExistsForURL</span><span class="selector-pseudo">:(NSURL</span> *)<span class="selector-tag">url</span></span><br><span class="line"><span class="selector-tag">completion</span><span class="selector-pseudo">:(SDWebImageCheckCacheCompletionBlock)completionBlock</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœæ£€æµ‹åˆ°å›¾ç‰‡å·²ç»åœ¨ç£ç›˜ä¸­,é‚£ä¹ˆæ‰§è¡Œå›è°ƒblock</span></span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">diskImageExistsForURL</span><span class="selector-pseudo">:(NSURL</span> *)<span class="selector-tag">url</span></span><br><span class="line"><span class="selector-tag">completion</span><span class="selector-pseudo">:(SDWebImageCheckCacheCompletionBlock)completionBlock</span>;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šæ˜¯å…³äº SDWebImage çš„ä¸€äº›ç”¨æ³•æ€»ç»“ï¼Œä»¥åå†ç”¨åˆ°å…¶å®ƒçš„äº†ï¼Œä¼šå†æ¥è¡¥å……ã€‚å¦å¤–å¦‚æœæœ‰å†™é”™çš„åœ°æ–¹ï¼Œæ¬¢è¿æœ‹å‹ä»¬æŒ‡æ­£ï¼è°¢è°¢ğŸ˜Šï¼</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/ å‰ç«¯ç¬”è®° - Webstormå¸¸ç”¨å¿«æ·é”®/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="åˆ˜æœ‹å¤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ä»¥æ¢¦ä¸ºé©¬">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/ å‰ç«¯ç¬”è®° - Webstormå¸¸ç”¨å¿«æ·é”®/" itemprop="url">
                  å‰ç«¯ç¬”è®° - Webstormå¸¸ç”¨å¿«æ·é”®
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>éœ€è¦åšä¸€äº›å‰ç«¯çš„ä¸œè¥¿ï¼Œâ€¦â€¦æœ‹å‹æ¨èäº† Webstorm ç¼–è¾‘å™¨ï¼Œæ®è¯´å¾ˆä¸é”™ï¼Œåœ¨å¼€å§‹ç ä»£ç ä¹‹å‰ï¼Œæƒ³ç€å¦‚æœè¦æé«˜æ•ˆç‡ï¼Œé‚£æŒæ¡ä¸€äº›å¸¸ç”¨çš„å¿«æ·é”®åº”è¯¥æ˜¯å°‘ä¸äº†çš„ï¼Œäºæ˜¯å°±æŸ¥äº†ä¸€ä¸‹ï¼Œæ•´ç†å‡ºæ¥ã€‚ç”¨çš„æ˜¯ Mac ç³»ç»Ÿï¼Œè€Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œcommand å³ Ctrlã€‚</p>
</blockquote>
<h3 id="ä¸€ã€å¿…å¤‡å¿«æ·é”®"><a href="#ä¸€ã€å¿…å¤‡å¿«æ·é”®" class="headerlink" title="ä¸€ã€å¿…å¤‡å¿«æ·é”®"></a>ä¸€ã€å¿…å¤‡å¿«æ·é”®</h3><ul>
<li>command+/ï¼šæ³¨é‡Šå½“å‰è¡Œ</li>
<li>command+Shift+/ï¼šå½“å‰ä½ç½®æ’å…¥æ³¨é‡Š</li>
<li>command+Alt+/ï¼šå—æ³¨é‡Šï¼Œå¹¶Focusåˆ°é¦–è¡Œï¼Œå†™æ³¨é‡Šè¯´æ˜ç”¨çš„</li>
<li>command+Shift+Aï¼šé€‰æ‹©å½“å‰æ ‡ç­¾å‰åï¼Œä¿®æ”¹æ ‡ç­¾ç”¨çš„</li>
<li>F11ï¼šå…¨å±</li>
<li>Shift+F11ï¼šå…¨å±å…æ‰“æ‰°æ¨¡å¼ï¼Œåªç¼–è¾‘å½“å‰æ–‡ä»¶</li>
<li>Alt+F3ï¼šé€‰æ‹©æ‰€æœ‰ç›¸åŒçš„è¯</li>
<li>Alt+.ï¼šé—­åˆæ ‡ç­¾</li>
<li>Alt+Shift+æ•°å­—ï¼šåˆ†å±æ˜¾ç¤º</li>
<li>Alt+æ•°å­—ï¼šåˆ‡æ¢æ‰“å¼€ç¬¬Nä¸ªæ–‡ä»¶</li>
<li>Shift+å³é”®æ‹–åŠ¨ï¼šå…‰æ ‡å¤šä¸ï¼Œç”¨æ¥æ›´æ”¹æˆ–æ’å…¥åˆ—å†…å®¹</li>
<li>é¼ æ ‡çš„å‰è¿›åé€€é”®å¯åˆ‡æ¢Tabæ–‡ä»¶</li>
<li>æŒ‰ commandï¼Œä¾æ¬¡ç‚¹å‡»æˆ–é€‰å–ï¼Œå¯éœ€è¦ç¼–è¾‘çš„å¤šä¸ªä½ç½®</li>
<li>æŒ‰ command+Shift+ä¸Šä¸‹é”®ï¼Œå¯æ›¿æ¢è¡Œ</li>
<li>command+Shift+Pï¼šæ‰“å¼€å‘½ä»¤é¢æ¿</li>
<li>command+Pï¼šæœç´¢é¡¹ç›®ä¸­çš„æ–‡ä»¶</li>
<li>command+Gï¼šè·³è½¬åˆ°ç¬¬å‡ è¡Œ</li>
<li>command+Wï¼šå…³é—­å½“å‰æ‰“å¼€æ–‡ä»¶</li>
<li>command+Shift+Wï¼šå…³é—­æ‰€æœ‰æ‰“å¼€æ–‡ä»¶</li>
<li>command+Shift+Vï¼šç²˜è´´å¹¶æ ¼å¼åŒ–</li>
<li>command+Dï¼šé€‰æ‹©å•è¯ï¼Œé‡å¤å¯å¢åŠ é€‰æ‹©ä¸‹ä¸€ä¸ªç›¸åŒçš„å•è¯</li>
<li>command+Lï¼šé€‰æ‹©è¡Œï¼Œé‡å¤å¯ä¾æ¬¡å¢åŠ é€‰æ‹©ä¸‹ä¸€è¡Œ</li>
<li>command+Shift+Lï¼šé€‰æ‹©å¤šè¡Œ</li>
<li>command+Shift+Enterï¼šåœ¨å½“å‰è¡Œå‰æ’å…¥æ–°è¡Œ</li>
<li>command+Xï¼šåˆ é™¤å½“å‰è¡Œ</li>
<li>command+Mï¼šè·³è½¬åˆ°å¯¹åº”æ‹¬å·</li>
<li>command+Uï¼šè½¯æ’¤é”€ï¼Œæ’¤é”€å…‰æ ‡ä½ç½®</li>
<li>command+Jï¼šé€‰æ‹©æ ‡ç­¾å†…å®¹</li>
<li>command+Fï¼šæŸ¥æ‰¾å†…å®¹</li>
<li>command+Shift+Fï¼šæŸ¥æ‰¾å¹¶æ›¿æ¢</li>
<li>command+Hï¼šæ›¿æ¢</li>
<li>command+Rï¼šå‰å¾€ method</li>
<li>command+Nï¼šæ–°å»ºçª—å£</li>
<li>command+K+Bï¼šå¼€å…³ä¾§æ </li>
<li>command+Shift+Mï¼šé€‰ä¸­å½“å‰æ‹¬å·å†…å®¹ï¼Œé‡å¤å¯é€‰ç€æ‹¬å·æœ¬èº«</li>
<li>command+F2ï¼šè®¾ç½®/åˆ é™¤æ ‡è®°</li>
</ul>
<h3 id="äºŒã€é€‰æ‹©ç±»å¿«æ·é”®"><a href="#äºŒã€é€‰æ‹©ç±»å¿«æ·é”®" class="headerlink" title="äºŒã€é€‰æ‹©ç±»å¿«æ·é”®"></a>äºŒã€é€‰æ‹©ç±»å¿«æ·é”®</h3><ul>
<li>command+â† å‘å·¦å•ä½æ€§åœ°ç§»åŠ¨å…‰æ ‡ï¼Œå¿«é€Ÿç§»åŠ¨å…‰æ ‡ã€‚</li>
<li>command+â†’ å‘å³å•ä½æ€§åœ°ç§»åŠ¨å…‰æ ‡ï¼Œå¿«é€Ÿç§»åŠ¨å…‰æ ‡ã€‚</li>
<li>shift+â†‘ å‘ä¸Šé€‰ä¸­å¤šè¡Œã€‚</li>
<li>shift+â†“ å‘ä¸‹é€‰ä¸­å¤šè¡Œã€‚</li>
<li>Shift+â† å‘å·¦é€‰ä¸­æ–‡æœ¬ã€‚</li>
<li>Shift+â†’ å‘å³é€‰ä¸­æ–‡æœ¬ã€‚</li>
<li>command+Shift+â† å‘å·¦å•ä½æ€§åœ°é€‰ä¸­æ–‡æœ¬ã€‚</li>
<li>command+Shift+â†’ å‘å³å•ä½æ€§åœ°é€‰ä¸­æ–‡æœ¬ã€‚</li>
<li>command+Shift+â†‘ å°†å…‰æ ‡æ‰€åœ¨è¡Œå’Œä¸Šä¸€è¡Œä»£ç äº’æ¢ï¼ˆå°†å…‰æ ‡æ‰€åœ¨è¡Œæ’å…¥åˆ°ä¸Šä¸€è¡Œä¹‹å‰ï¼‰ã€‚</li>
<li>command+Shift+â†“ å°†å…‰æ ‡æ‰€åœ¨è¡Œå’Œä¸‹ä¸€è¡Œä»£ç äº’æ¢ï¼ˆå°†å…‰æ ‡æ‰€åœ¨è¡Œæ’å…¥åˆ°ä¸‹ä¸€è¡Œä¹‹åï¼‰ã€‚</li>
<li>command+Alt+â†‘ å‘ä¸Šæ·»åŠ å¤šè¡Œå…‰æ ‡ï¼Œå¯åŒæ—¶ç¼–è¾‘å¤šè¡Œã€‚</li>
<li>command+Alt+â†“ å‘ä¸‹æ·»åŠ å¤šè¡Œå…‰æ ‡ï¼Œå¯åŒæ—¶ç¼–è¾‘å¤šè¡Œã€‚</li>
<li>command+D é€‰ä¸­å…‰æ ‡æ‰€å çš„æ–‡æœ¬ï¼Œç»§ç»­æ“ä½œåˆ™ä¼šé€‰ä¸­ä¸‹ä¸€ä¸ªç›¸åŒçš„æ–‡æœ¬ã€‚</li>
<li>Alt+F3 é€‰ä¸­æ–‡æœ¬æŒ‰ä¸‹å¿«æ·é”®ï¼Œå³å¯ä¸€æ¬¡æ€§é€‰æ‹©å…¨éƒ¨çš„ç›¸åŒæ–‡æœ¬è¿›è¡ŒåŒæ—¶ç¼–è¾‘ã€‚ä¸¾ä¸ªæ —å­ï¼šå¿«é€Ÿé€‰ä¸­å¹¶æ›´æ”¹æ‰€æœ‰ç›¸åŒçš„å˜é‡åã€å‡½æ•°åç­‰ã€‚</li>
<li>command+L é€‰ä¸­æ•´è¡Œï¼Œç»§ç»­æ“ä½œåˆ™ç»§ç»­é€‰æ‹©ä¸‹ä¸€è¡Œï¼Œæ•ˆæœå’Œ Shift+â†“ æ•ˆæœä¸€æ ·ã€‚</li>
<li>command+Shift+L å…ˆé€‰ä¸­å¤šè¡Œï¼Œå†æŒ‰ä¸‹å¿«æ·é”®ï¼Œä¼šåœ¨æ¯è¡Œè¡Œå°¾æ’å…¥å…‰æ ‡ï¼Œå³å¯åŒæ—¶ç¼–è¾‘è¿™äº›è¡Œã€‚</li>
<li>command+Shift+M é€‰æ‹©æ‹¬å·å†…çš„å†…å®¹ï¼ˆç»§ç»­é€‰æ‹©çˆ¶æ‹¬å·ï¼‰ã€‚ä¸¾ä¸ªæ —å­ï¼šå¿«é€Ÿé€‰ä¸­åˆ é™¤å‡½æ•°ä¸­çš„ä»£ç ï¼Œé‡å†™å‡½æ•°ä½“ä»£ç æˆ–é‡å†™æ‹¬å·å†…é‡Œçš„å†…å®¹ã€‚</li>
<li>command+M å…‰æ ‡ç§»åŠ¨è‡³æ‹¬å·å†…ç»“æŸæˆ–å¼€å§‹çš„ä½ç½®ã€‚</li>
<li>command+Enter åœ¨ä¸‹ä¸€è¡Œæ’å…¥æ–°è¡Œã€‚ä¸¾ä¸ªæ —å­ï¼šå³ä½¿å…‰æ ‡ä¸åœ¨è¡Œå°¾ï¼Œä¹Ÿèƒ½å¿«é€Ÿå‘ä¸‹æ’å…¥ä¸€è¡Œã€‚</li>
<li>command+Shift+Enter åœ¨ä¸Šä¸€è¡Œæ’å…¥æ–°è¡Œã€‚ä¸¾ä¸ªæ —å­ï¼šå³ä½¿å…‰æ ‡ä¸åœ¨è¡Œé¦–ï¼Œä¹Ÿèƒ½å¿«é€Ÿå‘ä¸Šæ’å…¥ä¸€è¡Œã€‚</li>
<li>command+Shift+[ é€‰ä¸­ä»£ç ï¼ŒæŒ‰ä¸‹å¿«æ·é”®ï¼ŒæŠ˜å ä»£ç ã€‚</li>
<li>command+Shift+] é€‰ä¸­ä»£ç ï¼ŒæŒ‰ä¸‹å¿«æ·é”®ï¼Œå±•å¼€ä»£ç ã€‚</li>
<li>command+K+0 å±•å¼€æ‰€æœ‰æŠ˜å ä»£ç ã€‚</li>
</ul>
<h3 id="ä¸‰ã€ç¼–è¾‘ç±»å¿«æ·é”®"><a href="#ä¸‰ã€ç¼–è¾‘ç±»å¿«æ·é”®" class="headerlink" title="ä¸‰ã€ç¼–è¾‘ç±»å¿«æ·é”®"></a>ä¸‰ã€ç¼–è¾‘ç±»å¿«æ·é”®</h3><ul>
<li>command+K+K ä»å…‰æ ‡å¤„å¼€å§‹åˆ é™¤ä»£ç è‡³è¡Œå°¾ã€‚</li>
<li>command+Shift+K åˆ é™¤æ•´è¡Œã€‚</li>
<li>command+/ æ³¨é‡Šå•è¡Œã€‚</li>
<li>command+Shift+/ æ³¨é‡Šå¤šè¡Œã€‚</li>
<li>command+J åˆå¹¶é€‰ä¸­çš„å¤šè¡Œä»£ç ä¸ºä¸€è¡Œã€‚ä¸¾ä¸ªæ —å­ï¼šå°†å¤šè¡Œæ ¼å¼çš„CSSå±æ€§åˆå¹¶ä¸ºä¸€è¡Œã€‚</li>
<li>command+Shift+D å¤åˆ¶å…‰æ ‡æ‰€åœ¨æ•´è¡Œï¼Œæ’å…¥åˆ°ä¸‹ä¸€è¡Œã€‚</li>
<li>Tab å‘å³ç¼©è¿›ã€‚</li>
<li>Shift+Tab å‘å·¦ç¼©è¿›ã€‚</li>
<li>command+K+U è½¬æ¢å¤§å†™ã€‚</li>
<li>command+K+L è½¬æ¢å°å†™ã€‚</li>
<li>command+Z æ’¤é”€ã€‚</li>
<li>command+Y æ¢å¤æ’¤é”€ã€‚</li>
<li>command+U è½¯æ’¤é”€ï¼Œæ„Ÿè§‰å’Œ Gtrl+Z ä¸€æ ·ã€‚</li>
<li>command+F2 è®¾ç½®ä¹¦ç­¾</li>
<li>command+T å·¦å³å­—æ¯äº’æ¢ã€‚</li>
<li>F6 å•è¯æ£€æµ‹æ‹¼å†™</li>
</ul>
<h3 id="å››ã€æœç´¢ç±»å¿«æ·é”®"><a href="#å››ã€æœç´¢ç±»å¿«æ·é”®" class="headerlink" title="å››ã€æœç´¢ç±»å¿«æ·é”®"></a>å››ã€æœç´¢ç±»å¿«æ·é”®</h3><ul>
<li>command+F æ‰“å¼€åº•éƒ¨æœç´¢æ¡†ï¼ŒæŸ¥æ‰¾å…³é”®å­—ã€‚</li>
<li>command+shift+F åœ¨æ–‡ä»¶å¤¹å†…æŸ¥æ‰¾ï¼Œä¸æ™®é€šç¼–è¾‘å™¨ä¸åŒçš„åœ°æ–¹æ˜¯sublimeå…è®¸æ·»åŠ å¤šä¸ªæ–‡ä»¶å¤¹è¿›è¡ŒæŸ¥æ‰¾ï¼Œç•¥é«˜ç«¯ï¼Œæœªç ”ç©¶ã€‚</li>
<li>command+P æ‰“å¼€æœç´¢æ¡†ã€‚ä¸¾ä¸ªæ —å­ï¼š1ã€è¾“å…¥å½“å‰é¡¹ç›®ä¸­çš„æ–‡ä»¶åï¼Œå¿«é€Ÿæœç´¢æ–‡ä»¶ï¼Œ2ã€è¾“å…¥@å’Œå…³é”®å­—ï¼ŒæŸ¥æ‰¾æ–‡ä»¶ä¸­å‡½æ•°åï¼Œ3ã€è¾“å…¥ï¼šå’Œæ•°å­—ï¼Œè·³è½¬åˆ°æ–‡ä»¶ä¸­è¯¥è¡Œä»£ç ï¼Œ4ã€è¾“å…¥#å’Œå…³é”®å­—ï¼ŒæŸ¥æ‰¾å˜é‡åã€‚</li>
<li>command+G æ‰“å¼€æœç´¢æ¡†ï¼Œè‡ªåŠ¨å¸¦ï¼šï¼Œè¾“å…¥æ•°å­—è·³è½¬åˆ°è¯¥è¡Œä»£ç ã€‚ä¸¾ä¸ªæ —å­ï¼šåœ¨é¡µé¢ä»£ç æ¯”è¾ƒé•¿çš„æ–‡ä»¶ä¸­å¿«é€Ÿå®šä½ã€‚</li>
<li>command+R æ‰“å¼€æœç´¢æ¡†ï¼Œè‡ªåŠ¨å¸¦@ï¼Œè¾“å…¥å…³é”®å­—ï¼ŒæŸ¥æ‰¾æ–‡ä»¶ä¸­çš„å‡½æ•°åã€‚ä¸¾ä¸ªæ —å­ï¼šåœ¨å‡½æ•°è¾ƒå¤šçš„é¡µé¢å¿«é€ŸæŸ¥æ‰¾æŸä¸ªå‡½æ•°ã€‚</li>
<li>command+ï¼š æ‰“å¼€æœç´¢æ¡†ï¼Œè‡ªåŠ¨å¸¦#ï¼Œè¾“å…¥å…³é”®å­—ï¼ŒæŸ¥æ‰¾æ–‡ä»¶ä¸­çš„å˜é‡åã€å±æ€§åç­‰ã€‚</li>
<li>command+Shift+P æ‰“å¼€å‘½ä»¤æ¡†ã€‚åœºæ™¯æ —å­ï¼šæ‰“å¼€å‘½åæ¡†ï¼Œè¾“å…¥å…³é”®å­—ï¼Œè°ƒç”¨sublime textæˆ–æ’ä»¶çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ä½¿ç”¨packageå®‰è£…æ’ä»¶ã€‚</li>
<li>Esc é€€å‡ºå…‰æ ‡å¤šè¡Œé€‰æ‹©ï¼Œé€€å‡ºæœç´¢æ¡†ï¼Œå‘½ä»¤æ¡†ç­‰ã€‚</li>
</ul>
<h3 id="äº”ã€æ˜¾ç¤ºç±»å¿«æ·é”®"><a href="#äº”ã€æ˜¾ç¤ºç±»å¿«æ·é”®" class="headerlink" title="äº”ã€æ˜¾ç¤ºç±»å¿«æ·é”®"></a>äº”ã€æ˜¾ç¤ºç±»å¿«æ·é”®</h3><ul>
<li>Alt+Shift+1 çª—å£åˆ†å±ï¼Œæ¢å¤é»˜è®¤1å±ï¼ˆéå°é”®ç›˜çš„æ•°å­—ï¼‰</li>
<li>Alt+Shift+2 å·¦å³åˆ†å±-2åˆ—</li>
<li>Alt+Shift+3 å·¦å³åˆ†å±-3åˆ—</li>
<li>Alt+Shift+4 å·¦å³åˆ†å±-4åˆ—</li>
<li>Alt+Shift+5 ç­‰åˆ†4å±</li>
<li>Alt+Shift+8 å‚ç›´åˆ†å±-2å±</li>
<li>Alt+Shift+9 å‚ç›´åˆ†å±-3å±</li>
<li>Ctrl+K+B å¼€å¯/å…³é—­ä¾§è¾¹æ ã€‚</li>
<li>F11 å…¨å±æ¨¡å¼</li>
<li>Shift+F11 å…æ‰“æ‰°æ¨¡å¼</li>
<li>command+Tab æŒ‰æ–‡ä»¶æµè§ˆè¿‡çš„é¡ºåºï¼Œåˆ‡æ¢å½“å‰çª—å£çš„æ ‡ç­¾é¡µã€‚</li>
<li>command+PageDown å‘å·¦åˆ‡æ¢å½“å‰çª—å£çš„æ ‡ç­¾é¡µã€‚</li>
<li>command+PageUp å‘å³åˆ‡æ¢å½“å‰çª—å£çš„æ ‡ç­¾é¡µã€‚</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/iOSå¼€å‘ä¹‹ - äºŒç»´ç /">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="åˆ˜æœ‹å¤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ä»¥æ¢¦ä¸ºé©¬">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/iOSå¼€å‘ä¹‹ - äºŒç»´ç /" itemprop="url">
                  iOSå¼€å‘ä¹‹ - äºŒç»´ç 
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>åœ¨æˆ‘ä»¬çš„æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼ŒäºŒç»´ç æ‰«æè¶Šæ¥è¶Šå¸¸è§ï¼Œæ¯”å¦‚æ”¯ä»˜å®æ”¯ä»˜æ‰«æã€å¾®ä¿¡æ”¯ä»˜æ‰«æã€ä¿¡æ¯è·å–ç­‰ç­‰ï¼Œæ‰€ä»¥ç®€å•çš„æ•´ç†äº†äºŒç»´ç ç›¸å…³çš„çŸ¥è¯†ï¼Œæ€»å…±åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šç”ŸæˆäºŒç»´ç ï¼›æ‰«æäºŒç»´ç ã€‚</p>
</blockquote>
<h4 id="ä¸€ã€ç”ŸæˆäºŒç»´ç "><a href="#ä¸€ã€ç”ŸæˆäºŒç»´ç " class="headerlink" title="ä¸€ã€ç”ŸæˆäºŒç»´ç "></a>ä¸€ã€ç”ŸæˆäºŒç»´ç </h4><ul>
<li><p>ç®€å•çš„ç”ŸæˆäºŒç»´ç ï¼Œå…ˆçœ‹æ•ˆæœå›¾<br>å¦‚å›¾æ‰€ç¤ºï¼Œè¿™ä¸ªæ•ˆæœä¸å¤ªå¥½ï¼Œæœ‰äº›æ¨¡ç³Š<br><img src="http://upload-images.jianshu.io/upload_images/2665449-a0c118e13587ec11.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç®€å•ç”ŸæˆäºŒç»´ç "></p>
</li>
<li><p>ç”Ÿæˆç®€å•äºŒç»´ç çš„ä»£ç å¦‚ä¸‹ï¼š</p>
</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="comment">// éœ€è¦å¯¼å…¥æ­¤æ¡†æ¶</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;CoreImage/CoreImage.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">UIImageView</span> *imageView;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UIImageView</span> *)imageView &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!_imageView) &#123;</span><br><span class="line">_imageView = [[<span class="built_in">UIImageView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">200</span>, <span class="number">200</span>)];</span><br><span class="line">_imageView.center = <span class="keyword">self</span>.view.center;</span><br><span class="line">[<span class="keyword">self</span>.view addSubview:_imageView];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> _imageView;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">[<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">[<span class="keyword">self</span> creatQRCode];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”ŸæˆäºŒç»´ç </span></span><br><span class="line">- (<span class="keyword">void</span>)creatQRCode &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºäºŒç»´ç æ»¤é•œ</span></span><br><span class="line"><span class="built_in">CIFilter</span> *filter = [<span class="built_in">CIFilter</span> filterWithName:<span class="string">@"CIQRCodeGenerator"</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¢å¤æ»¤é•œçš„é»˜è®¤å±æ€§</span></span><br><span class="line">[filter setDefaults];</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»™è¿‡æ»¤å™¨æ·»åŠ æ•°æ®ï¼ˆçº¯æ–‡æœ¬ï¼ŒURLéƒ½å¯ä»¥ï¼‰</span></span><br><span class="line"><span class="comment">//    NSString *dataString = @"http://www.baidu.com";</span></span><br><span class="line"><span class="built_in">NSString</span> *dataString = <span class="string">@"ç”ŸæˆäºŒç»´ç "</span>;</span><br><span class="line"><span class="comment">// å°†å­—ç¬¦ä¸²è½¬æ¢æˆNSData</span></span><br><span class="line"><span class="built_in">NSData</span> *data = [dataString dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®æ»¤é•œ inputMessage æ•°æ®</span></span><br><span class="line">[filter setValue:data forKeyPath:<span class="string">@"inputMessage"</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">CIImage</span> *outputImage = [filter outputImage];</span><br><span class="line"></span><br><span class="line"><span class="built_in">UIImage</span> *image = [<span class="built_in">UIImage</span>  imageWithCIImage:outputImage];</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠŠç”Ÿæˆçš„äºŒç»´ç æ˜¾ç¤ºåœ¨ imageview ä¸Š</span></span><br><span class="line"><span class="keyword">self</span>.imageView.image = image;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<ul>
<li>ç”Ÿæˆæ¸…æ™°äºŒç»´ç </li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-d5c8dcae91378594.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç”Ÿæˆæ¸…æ™°äºŒç»´ç "></p>
<ul>
<li>ä»£ç å¦‚ä¸‹ï¼š</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;CoreImage/CoreImage.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">UIImageView</span> *imageView;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UIImageView</span> *)imageView &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!_imageView) &#123;</span><br><span class="line">_imageView = [[<span class="built_in">UIImageView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">200</span>, <span class="number">200</span>)];</span><br><span class="line">_imageView.center = <span class="keyword">self</span>.view.center;</span><br><span class="line">[<span class="keyword">self</span>.view addSubview:_imageView];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> _imageView;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">[<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">[<span class="keyword">self</span> creatQRCode];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”ŸæˆäºŒç»´ç </span></span><br><span class="line">- (<span class="keyword">void</span>)creatQRCode &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºäºŒç»´ç æ»¤é•œ</span></span><br><span class="line"><span class="built_in">CIFilter</span> *filter = [<span class="built_in">CIFilter</span> filterWithName:<span class="string">@"CIQRCodeGenerator"</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¢å¤æ»¤é•œçš„é»˜è®¤å±æ€§</span></span><br><span class="line">[filter setDefaults];</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»™è¿‡æ»¤å™¨æ·»åŠ æ•°æ®ï¼ˆçº¯æ–‡æœ¬ï¼ŒURLéƒ½å¯ä»¥ï¼‰</span></span><br><span class="line"><span class="comment">//    NSString *dataString = @"http://www.baidu.com";</span></span><br><span class="line"><span class="built_in">NSString</span> *dataString = <span class="string">@"ç”ŸæˆäºŒç»´ç "</span>;</span><br><span class="line"><span class="comment">// å°†å­—ç¬¦ä¸²è½¬æ¢æˆNSData</span></span><br><span class="line"><span class="built_in">NSData</span> *data = [dataString dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®æ»¤é•œ inputMessage æ•°æ®</span></span><br><span class="line">[filter setValue:data forKeyPath:<span class="string">@"inputMessage"</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–æ»¤é•œè¾“å‡ºçš„äºŒç»´ç </span></span><br><span class="line"><span class="built_in">CIImage</span> *outputImage = [filter outputImage];</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ˜¾ç¤ºäºŒç»´ç </span></span><br><span class="line"><span class="keyword">self</span>.imageView.image = [<span class="keyword">self</span> creatClearImageFromCIImage:outputImage withSize:<span class="number">200</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UIImage</span> *)creatClearImageFromCIImage:(<span class="built_in">CIImage</span> *)image withSize:(<span class="built_in">CGFloat</span>) size</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">CGRect</span> extent = <span class="built_in">CGRectIntegral</span>(image.extent);</span><br><span class="line"><span class="built_in">CGFloat</span> scale = MIN(size/<span class="built_in">CGRectGetWidth</span>(extent), size/<span class="built_in">CGRectGetHeight</span>(extent));</span><br><span class="line"></span><br><span class="line">size_t width = <span class="built_in">CGRectGetWidth</span>(extent) * scale;</span><br><span class="line">size_t height = <span class="built_in">CGRectGetHeight</span>(extent) * scale;</span><br><span class="line"><span class="comment">// åˆ›å»ºç°åº¦è‰²è°ƒç©ºé—´</span></span><br><span class="line"><span class="built_in">CGColorSpaceRef</span> colorSpaceRef = <span class="built_in">CGColorSpaceCreateDeviceGray</span>();</span><br><span class="line"><span class="built_in">CGContextRef</span> bitmapRef = <span class="built_in">CGBitmapContextCreate</span>(<span class="literal">nil</span>, width, height, <span class="number">8</span>, <span class="number">0</span>, colorSpaceRef, (<span class="built_in">CGBitmapInfo</span>)kCGImageAlphaNone);</span><br><span class="line"><span class="built_in">CIContext</span> *context = [<span class="built_in">CIContext</span> contextWithOptions:<span class="literal">nil</span>];</span><br><span class="line"><span class="built_in">CGImageRef</span> bitmapImage = [context createCGImage:image fromRect:extent];</span><br><span class="line"><span class="built_in">CGContextSetInterpolationQuality</span>(bitmapRef, kCGInterpolationNone);</span><br><span class="line"><span class="built_in">CGContextScaleCTM</span>(bitmapRef, scale, scale);</span><br><span class="line"><span class="built_in">CGContextDrawImage</span>(bitmapRef, extent, bitmapImage);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿å­˜å›¾ç‰‡</span></span><br><span class="line"><span class="built_in">CGImageRef</span> scaledImage = <span class="built_in">CGBitmapContextCreateImage</span>(bitmapRef);</span><br><span class="line"><span class="built_in">CGContextRelease</span>(bitmapRef);</span><br><span class="line"><span class="built_in">CGImageRelease</span>(bitmapImage);</span><br><span class="line"><span class="keyword">return</span> [<span class="built_in">UIImage</span> imageWithCGImage:scaledImage];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="äºŒã€æ‰«æäºŒç»´ç "><a href="#äºŒã€æ‰«æäºŒç»´ç " class="headerlink" title="äºŒã€æ‰«æäºŒç»´ç "></a>äºŒã€æ‰«æäºŒç»´ç </h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;AVFoundation/AVFoundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> () &lt;<span class="title">AVCaptureMetadataOutputObjectsDelegate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">AVCaptureSession</span> *session;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">AVCaptureVideoPreviewLayer</span> *layer;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">[<span class="keyword">super</span> viewDidLoad];</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºæ‹æ‘„ä¼šè¯</span></span><br><span class="line"><span class="keyword">self</span>.session = [[<span class="built_in">AVCaptureSession</span> alloc] init];</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ è¾“å…¥è®¾å¤‡</span></span><br><span class="line"><span class="built_in">AVCaptureDevice</span> *device = [<span class="built_in">AVCaptureDevice</span> defaultDeviceWithMediaType:<span class="built_in">AVMediaTypeVideo</span>];</span><br><span class="line"><span class="built_in">AVCaptureDeviceInput</span> *input = [<span class="built_in">AVCaptureDeviceInput</span> deviceInputWithDevice:device error:<span class="literal">nil</span>];</span><br><span class="line">[<span class="keyword">self</span>.session addInput:input];</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ è¾“å‡ºæ•°æ®</span></span><br><span class="line"><span class="built_in">AVCaptureMetadataOutput</span> *output = [[<span class="built_in">AVCaptureMetadataOutput</span> alloc] init];</span><br><span class="line">[output setMetadataObjectsDelegate:<span class="keyword">self</span> queue:dispatch_get_main_queue()];</span><br><span class="line">[<span class="keyword">self</span>.session addOutput:output];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®è¾“å…¥å…ƒæ•°æ®çš„ç±»å‹</span></span><br><span class="line">[output setMetadataObjectTypes:@[<span class="built_in">AVMetadataObjectTypeQRCode</span>]];</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ æ‰«æå›¾å±‚</span></span><br><span class="line"><span class="keyword">self</span>.layer = [<span class="built_in">AVCaptureVideoPreviewLayer</span> layerWithSession:<span class="keyword">self</span>.session];</span><br><span class="line"><span class="keyword">self</span>.layer.frame = <span class="keyword">self</span>.view.bounds;</span><br><span class="line">[<span class="keyword">self</span>.view.layer addSublayer:<span class="keyword">self</span>.layer];</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯åŠ¨ä¼šè¯</span></span><br><span class="line">[<span class="keyword">self</span>.session startRunning];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - æ‰«æåˆ°æ•°æ®å°±ä¼šæ‰§è¡Œè¯¥ä»£ç†æ–¹æ³•</span></span><br><span class="line">- (<span class="keyword">void</span>)captureOutput:(<span class="built_in">AVCaptureOutput</span> *)captureOutput didOutputMetadataObjects:(<span class="built_in">NSArray</span> *)metadataObjects fromConnection:(<span class="built_in">AVCaptureConnection</span> *)connection</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (metadataObjects.count &gt; <span class="number">0</span>) &#123;</span><br><span class="line"><span class="comment">// æç¤ºï¼šå¦‚æœéœ€è¦å¯¹urlæˆ–è€…æ–‡æœ¬ç­‰ä¿¡æ¯è¿›è¡Œæ‰«æï¼Œå¯ä»¥åœ¨æ­¤è¿›è¡Œæ‰©å±•</span></span><br><span class="line"><span class="built_in">AVMetadataMachineReadableCodeObject</span> *object = [metadataObjects lastObject];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, object.stringValue);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœæ‰«æå®Œæˆï¼Œåœæ­¢ä¼šè¯</span></span><br><span class="line">[<span class="keyword">self</span>.session stopRunning];</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ é™¤é¢„è§ˆå›¾å±‚</span></span><br><span class="line">[<span class="keyword">self</span>.layer removeFromSuperlayer];</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"æ²¡æœ‰æ‰«æåˆ°æ•°æ®"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ€åè¯´å‡ ä¸ªäºŒç»´ç ç›¸å…³çš„æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li><p>æ³¨æ„ç‚¹ï¼š<br>äºŒç»´ç éƒ½æœ‰ä¸€å®šçš„å®¹é”™éƒ¨åˆ†ï¼Œæ„æ€å°±æ˜¯æœ‰éƒ¨åˆ†æ±¡æŸæˆ–è€…ç ´æŸéƒ½æ²¡æœ‰å…³ç³»ï¼Œç…§å¸¸è¯†åˆ«ã€‚ä½†æ˜¯ä¹Ÿæ˜¯æœ‰é™åº¦çš„ï¼Œè¿™æ ¹æ®ç”Ÿæˆæ—¶ä½¿ç”¨çš„çº é”™çº§åˆ«è€Œå®šï¼Œå¯ä»¥æœ‰7ï¼…~30ï¼…å·¦å³çš„æŸåã€‚</p>
</li>
<li><p>äºŒç»´ç ä½¿ç”¨åŸºæœ¬åŸåˆ™ï¼š<br>1ã€ä¸‰ä¸ªè§’ä¸Šçš„â€œå›â€åŠâ€œå›â€å­—å‘¨å›´çš„åº•è‰²ä¸è¦åŠ¨<br>2ã€ä¸­é—´éƒ¨åˆ†å’Œä¸å¸¦â€œå›â€å­—çš„ä¸€è§’æ˜¯å¯ä»¥å¡«å›¾ç‰‡çš„ï¼ˆä¸­é—´æœ€å¥½ï¼‰<br>3ã€å¦‚æœä¸­é—´æœ‰å°çš„â€œå›â€å­—ï¼Œèƒ½ä¸å˜å°±ä¸å˜ï¼Œèƒ½å°‘å˜å°±å°‘å˜<br>4ã€å°½å¯èƒ½æ”¾å¤§äºŒç»´ç åå†æ·»åŠ å›¾ç‰‡ï¼Œä¸è¦æ·»åŠ å›¾ç‰‡åæ”¾å¤§<br>5ã€ç”Ÿæˆæ—¶å°½é‡é€‰æ‹©è¾ƒé«˜çš„çº é”™çº§åˆ«</p>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-daf8123ea95c1514.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="äºŒç»´ç "></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/iOSå¼€å‘ä¹‹ - å†…è´­/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="åˆ˜æœ‹å¤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ä»¥æ¢¦ä¸ºé©¬">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/iOSå¼€å‘ä¹‹ - å†…è´­/" itemprop="url">
                  iOSå¼€å‘ä¹‹ - å†…è´­
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>ç”µå•†ä¹‹ç±»çš„ app å¤§å¤šç”¨çš„éƒ½æ˜¯ç¬¬ä¸‰æ–¹æ”¯ä»˜ï¼ˆæ”¯ä»˜å®å¾®ä¿¡ç­‰æ”¯ä»˜ï¼‰ï¼Œä½†æ˜¯åœ¨æŸç§ç‰¹æ®Šæƒ…å†µä¹‹ä¸‹ï¼Œæˆ‘ä»¬å´ä¸å¾—ä¸ä½¿ç”¨å†…è´­ã€‚æ¯”å¦‚å•†å“æ˜¯åœ¨æœ¬ app ä¸­ä½¿ç”¨å’Œæ¶ˆè€—çš„ï¼ˆæ¸¸æˆå¸æ¸¸æˆé“å…·ç­‰ï¼‰ï¼Œå°±ä¸€å®šè¦ç”¨å†…è´­ï¼Œè‹¹æœå¼ºåˆ¶çš„ï¼Œå¦åˆ™ä¼šè¢«æ‹’ç»ä¸Šçº¿ã€‚å› æ­¤ä½œä¸º iOS å¼€å‘è€…ï¼Œä¸å…‰è¦äº†è§£ç¬¬ä¸‰æ–¹æ”¯ä»˜ï¼Œå¯¹å†…è´­ä¹Ÿè¦æœ‰ä¸€å®šçš„è®¤è¯†ï¼</p>
</blockquote>
<h2 id="ä¸€ã€ä»€ä¹ˆæ˜¯å†…è´­ï¼Ÿ"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯å†…è´­ï¼Ÿ" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯å†…è´­ï¼Ÿ"></a>ä¸€ã€ä»€ä¹ˆæ˜¯å†…è´­ï¼Ÿ</h2><p>å†…è´­æ˜¯è‹¹æœæ¨å‡ºçš„ä¸€ç§æ”¯ä»˜æ–¹å¼ã€‚è¯´ç™½äº†å†…è´­å°±æ˜¯è‹¹æœè·å–åˆ©æ¶¦çš„æ–¹å¼ä¹‹ä¸€ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨ç¬¬ä¸‰æ–¹æ”¯ä»˜ï¼Œåªä¼šæ”¯ä»˜å°‘é‡çš„ğŸ’°ï¼Œä½†ä½¿ç”¨å†…è´­å´è¦æ”¯ä»˜å¾ˆå¤šğŸ’°ğŸ’°ğŸ’°ğŸ’°ğŸ’°ğŸ’°ğŸ’°ğŸ’°ï¼Œè¦å’Œè‹¹æœä¸‰ä¸ƒåˆ†å¸ï¼ˆä»¥å‰æ˜¯å››å…­åˆ†ğŸ˜¢ï¼‰ã€‚</p>
<h2 id="äºŒã€å†…è´­äº§å“çš„ç±»åˆ«"><a href="#äºŒã€å†…è´­äº§å“çš„ç±»åˆ«" class="headerlink" title="äºŒã€å†…è´­äº§å“çš„ç±»åˆ«"></a>äºŒã€å†…è´­äº§å“çš„ç±»åˆ«</h2><p>å®˜æ–¹çš„æ³¨é‡Šå†™çš„å¾ˆæ¸…æ¥šäº†ï¼Œå†…è´­æœ‰äº”ç§äº§å“ç±»åˆ«ï¼Œç®€ä»‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>éæ¶ˆè€—å“ï¼ˆNonconsumableï¼‰<br>æŒ‡çš„æ˜¯åœ¨æ¸¸æˆä¸­ä¸€æ¬¡æ€§è´­ä¹°å¹¶æ‹¥æœ‰æ°¸ä¹…è®¿é—®æƒçš„ç‰©å“æˆ–æœåŠ¡ã€‚éæ¶ˆè€—å“ç‰©å“å¯ä»¥è¢«ç”¨æˆ·å†æ¬¡ä¸‹è½½ï¼Œå¹¶ä¸”èƒ½å¤Ÿåœ¨ç”¨æˆ·çš„æ‰€æœ‰è®¾å¤‡ä¸Šä½¿ç”¨ã€‚</li>
<li>æ¶ˆè€—å“ï¼ˆConsumableï¼‰<br>æ¶ˆè€—å“è´­ä¹°ä¸å¯è¢«å†æ¬¡ä¸‹è½½,æ ¹æ®å…¶ç‰¹ç‚¹,æ¶ˆè€—å“ä¸èƒ½åœ¨ç”¨æˆ·çš„è®¾å¤‡ä¹‹é—´è·¨è®¾å¤‡ä½¿ç”¨,é™¤éè‡ªå®šä¹‰æœåŠ¡åœ¨ç”¨æˆ·çš„è´¦å·ä¹‹é—´å…±äº«è¿™äº›ä¿¡æ¯ã€‚<br><strong>ä»¥ä¸‹ä¸‰ç§ç±»åˆ«åœ¨iBooksä¸­ä½¿ç”¨ï¼Œç›®å‰iBooksä¸æ”¯æŒå¤§é™†å¸‚åœº</strong></li>
<li>å…è´¹è®¢é˜…ï¼ˆFree subscriptionsï¼‰</li>
<li>è‡ªåŠ¨ç»­è´¹è®¢é˜…ï¼ˆAuto-renewing subscriptionsï¼‰</li>
<li>éè‡ªåŠ¨ç»­è´¹è®¢é˜…ï¼ˆNonrenewing subscriptionsï¼‰</li>
</ul>
<h2 id="ä¸‰ã€è‹¹æœå®˜æ–¹çš„å†…è´­æµç¨‹"><a href="#ä¸‰ã€è‹¹æœå®˜æ–¹çš„å†…è´­æµç¨‹" class="headerlink" title="ä¸‰ã€è‹¹æœå®˜æ–¹çš„å†…è´­æµç¨‹"></a>ä¸‰ã€è‹¹æœå®˜æ–¹çš„å†…è´­æµç¨‹</h2><p><img src="http://upload-images.jianshu.io/upload_images/2665449-0614b70007393038.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å†…è´­æµç¨‹"></p>
<ul>
<li>ç™½è¯æ–‡å¦‚ä¸‹â¬‡ï¸</li>
</ul>
<ol>
<li>ç¨‹åºå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œè·å¾—ä¸€ä»½äº§å“åˆ—è¡¨ã€‚</li>
<li>æœåŠ¡å™¨è¿”å›åŒ…å«äº§å“æ ‡è¯†ç¬¦çš„åˆ—è¡¨ã€‚</li>
<li>ç¨‹åºå‘App Storeå‘é€è¯·æ±‚ï¼Œå¾—åˆ°äº§å“çš„ä¿¡æ¯ã€‚</li>
<li>App Storeè¿”å›äº§å“ä¿¡æ¯ã€‚</li>
<li>ç¨‹åºæŠŠè¿”å›çš„äº§å“ä¿¡æ¯æ˜¾ç¤ºç»™ç”¨æˆ·ï¼ˆAppçš„storeç•Œé¢ï¼‰</li>
<li>ç”¨æˆ·é€‰æ‹©æŸä¸ªäº§å“</li>
<li>ç¨‹åºå‘App Storeå‘é€æ”¯ä»˜è¯·æ±‚</li>
<li>App Storeå¤„ç†æ”¯ä»˜è¯·æ±‚å¹¶è¿”å›äº¤æ˜“å®Œæˆä¿¡æ¯ã€‚</li>
<li>ç¨‹åºä»ä¿¡æ¯ä¸­è·å¾—æ•°æ®ï¼Œå¹¶å‘é€è‡³æœåŠ¡å™¨ã€‚</li>
<li>æœåŠ¡å™¨çºªå½•æ•°æ®ï¼Œå¹¶è¿›è¡Œå®¡(æˆ‘ä»¬çš„)æŸ¥ã€‚</li>
<li>æœåŠ¡å™¨å°†æ•°æ®å‘ç»™App Storeæ¥éªŒè¯è¯¥äº¤æ˜“çš„æœ‰æ•ˆæ€§ã€‚</li>
<li>App Storeå¯¹æ”¶åˆ°çš„æ•°æ®è¿›è¡Œè§£æï¼Œè¿”å›è¯¥æ•°æ®å’Œè¯´æ˜å…¶æ˜¯å¦æœ‰æ•ˆçš„æ ‡è¯†ã€‚</li>
<li>æœåŠ¡å™¨è¯»å–è¿”å›çš„æ•°æ®ï¼Œç¡®å®šç”¨æˆ·è´­ä¹°çš„å†…å®¹ã€‚</li>
<li>æœåŠ¡å™¨å°†è´­ä¹°çš„å†…å®¹ä¼ é€’ç»™ç¨‹åºã€‚</li>
</ol>
<h2 id="å››ã€ä»£ç å®ç°"><a href="#å››ã€ä»£ç å®ç°" class="headerlink" title="å››ã€ä»£ç å®ç°"></a>å››ã€ä»£ç å®ç°</h2><p>4.1 é¡¹ç›®çš„Bundle identifieréœ€è¦ä¸æ‚¨ç”³è¯·AppIDæ—¶å¡«å†™çš„bundleIDä¸€è‡´ï¼Œä¸ç„¶ä¼šæ— æ³•è¯·æ±‚åˆ°å•†å“ä¿¡æ¯ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-4a5e5e9889d10179.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Bundle identifier"></p>
<p>4.2è¦ä½¿ç”¨å†…è´­,éœ€è¦å¯¼å…¥ StoreKit ä¾èµ–åº“<br><img src="http://upload-images.jianshu.io/upload_images/2665449-c68598a75f514fda.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å…¥StoreKit"></p>
<p>4.3ä»£ç éƒ¨åˆ†<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"UITableController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;StoreKit/StoreKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">UITableController</span> () &lt;<span class="title">SKProductsRequestDelegate</span>, <span class="title">UITableViewDelegate</span>, <span class="title">UITableViewDataSource</span>, <span class="title">SKPaymentTransactionObserver</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** æ‰€æœ‰å•†å“ */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSArray</span> *products;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">UITableController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">[<span class="keyword">super</span> viewDidLoad];</span><br><span class="line"></span><br><span class="line">[<span class="keyword">self</span> requestProducts];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯·æ±‚å¯å–å•†å“</span></span><br><span class="line">- (<span class="keyword">void</span>)requestProducts &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1.ä»æœåŠ¡å™¨è¯·æ±‚æ‰€æœ‰å•†å“çš„ProductIds</span></span><br><span class="line"><span class="built_in">NSString</span> *filePath = [[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@"iapdemo.plist"</span> ofType:<span class="literal">nil</span>];</span><br><span class="line"><span class="built_in">NSArray</span> *productArray = [<span class="built_in">NSArray</span> arrayWithContentsOfFile:filePath];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.è·å–productId</span></span><br><span class="line"><span class="built_in">NSArray</span> *productIdArray = [productArray valueForKeyPath:<span class="string">@"productId"</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.è¯·æ±‚å¯å–çš„å•†å“</span></span><br><span class="line"><span class="built_in">NSSet</span> *productIdSet = [<span class="built_in">NSSet</span> setWithArray:productIdArray];</span><br><span class="line"><span class="built_in">SKProductsRequest</span> *request = [[<span class="built_in">SKProductsRequest</span> alloc] initWithProductIdentifiers:productIdSet];</span><br><span class="line">request.delegate = <span class="keyword">self</span>;</span><br><span class="line">[request start];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewWillAppear:(<span class="built_in">BOOL</span>)animated</span><br><span class="line">&#123;</span><br><span class="line">[<span class="keyword">super</span> viewWillAppear:animated];</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ è§‚å¯Ÿè€…</span></span><br><span class="line">[[<span class="built_in">SKPaymentQueue</span> defaultQueue] addTransactionObserver:<span class="keyword">self</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewWillDisappear:(<span class="built_in">BOOL</span>)animated</span><br><span class="line">&#123;</span><br><span class="line">[<span class="keyword">super</span> viewWillDisappear:animated];</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç§»é™¤è§‚å¯Ÿè€…</span></span><br><span class="line">[[<span class="built_in">SKPaymentQueue</span> defaultQueue] removeTransactionObserver:<span class="keyword">self</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - å®ç°SKProductsRequestçš„ä»£ç†æ–¹æ³•</span></span><br><span class="line"><span class="comment">// è¯·æ±‚åˆ°å¯å–å•†å“çš„ç»“æœ</span></span><br><span class="line">- (<span class="keyword">void</span>)productsRequest:(<span class="built_in">SKProductsRequest</span> *)request didReceiveResponse:(<span class="built_in">SKProductsResponse</span> *)response</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// 1.å±•ç¤ºå•†å“</span></span><br><span class="line"><span class="keyword">self</span>.products = [response.products sortedArrayWithOptions:<span class="built_in">NSSortConcurrent</span> usingComparator:^<span class="built_in">NSComparisonResult</span>(<span class="built_in">SKProduct</span> *obj1, <span class="built_in">SKProduct</span> *obj2) &#123;</span><br><span class="line"><span class="keyword">return</span> [obj1.price compare:obj2.price];</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.åˆ·æ–°è¡¨æ ¼</span></span><br><span class="line">[<span class="keyword">self</span>.tableView reloadData];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯·æ±‚å¤±è´¥</span></span><br><span class="line">- (<span class="keyword">void</span>)request:(<span class="built_in">SKRequest</span> *)request didFailWithError:(<span class="built_in">NSError</span> *)error &#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, [error localizedDescription]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯·æ±‚ç»“æŸ</span></span><br><span class="line">- (<span class="keyword">void</span>)requestDidFinish:(<span class="built_in">SKRequest</span> *)request &#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"è¯·æ±‚ç»“æŸ"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - å®ç°tableViewçš„æ•°æ®æºå’Œä»£ç†æ–¹æ³•</span></span><br><span class="line">- (<span class="built_in">NSInteger</span>)tableView:(<span class="built_in">UITableView</span> *)tableView numberOfRowsInSection:(<span class="built_in">NSInteger</span>)section</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">self</span>.products.count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UITableViewCell</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> *ID = <span class="string">@"productCellId"</span>;</span><br><span class="line"><span class="built_in">UITableViewCell</span> *cell = [tableView dequeueReusableCellWithIdentifier:ID];</span><br><span class="line"><span class="keyword">if</span> (cell == <span class="literal">nil</span>) &#123;</span><br><span class="line">cell = [[<span class="built_in">UITableViewCell</span> alloc] initWithStyle:<span class="built_in">UITableViewCellStyleSubtitle</span> reuseIdentifier:ID];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1.å–å‡ºæ¨¡å‹</span></span><br><span class="line"><span class="built_in">SKProduct</span> *product = <span class="keyword">self</span>.products[indexPath.row];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.ç»™cellè®¾ç½®æ•°æ®</span></span><br><span class="line">cell.textLabel.text = product.localizedTitle;</span><br><span class="line">cell.detailTextLabel.text = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"ä»·æ ¼:%@"</span>, product.price];</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> cell;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)tableView:(<span class="built_in">UITableView</span> *)tableView didSelectRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// 1.å–å‡ºæ¨¡å‹</span></span><br><span class="line"><span class="built_in">SKProduct</span> *product = <span class="keyword">self</span>.products[indexPath.row];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.è´­ä¹°å•†å“</span></span><br><span class="line">[<span class="keyword">self</span> buyProduct:product];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - è´­ä¹°å•†å“</span></span><br><span class="line">- (<span class="keyword">void</span>)buyProduct:(<span class="built_in">SKProduct</span> *)product</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// 1.åˆ›å»ºç¥¨æ®</span></span><br><span class="line"><span class="built_in">SKPayment</span> *payment = [<span class="built_in">SKPayment</span> paymentWithProduct:product];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.å°†ç¥¨æ®åŠ å…¥åˆ°äº¤æ˜“é˜Ÿåˆ—ä¸­</span></span><br><span class="line">[[<span class="built_in">SKPaymentQueue</span> defaultQueue] addPayment:payment];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - å®ç°SKPaymentQueueçš„å›è°ƒæ–¹æ³•</span></span><br><span class="line"><span class="comment">// ç›‘å¬è´­ä¹°ç»“æœ</span></span><br><span class="line">- (<span class="keyword">void</span>)paymentQueue:(<span class="built_in">SKPaymentQueue</span> *)queue updatedTransactions:(<span class="built_in">NSArray</span> *)transactions</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">SKPaymentTransaction</span> *transation <span class="keyword">in</span> transactions) &#123;</span><br><span class="line"><span class="keyword">switch</span> (transation.transactionState) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="built_in">SKPaymentTransactionStatePurchasing</span>:</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"æ­£åœ¨äº¤æ˜“"</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="built_in">SKPaymentTransactionStatePurchased</span>:</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"äº¤æ˜“æˆåŠŸ"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†äº¤æ˜“ä»äº¤æ˜“é˜Ÿåˆ—ä¸­ç§»é™¤, å¦åˆ™ä¼šéªŒè¯ä¸é€šè¿‡,ä»¥ä¸‹å‡ ä¸ªéƒ½å¾—ç§»é™¤</span></span><br><span class="line">[queue finishTransaction:transation];</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="built_in">SKPaymentTransactionStateFailed</span>:</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"äº¤æ˜“å¤±è´¥"</span>);</span><br><span class="line">[queue finishTransaction:transation];</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="built_in">SKPaymentTransactionStateRestored</span>:</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"è´­ä¹°è¿‡è¯¥å•†å“"</span>);</span><br><span class="line">[queue finishTransaction:transation];</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="built_in">SKPaymentTransactionStateDeferred</span>:</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"æœªå†³å®š"</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)dealloc &#123;</span><br><span class="line"></span><br><span class="line">[[<span class="built_in">SKPaymentQueue</span> defaultQueue] removeTransactionObserver:<span class="keyword">self</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¦å¤–ä½¿ç”¨è¿™ä¸ªæ–¹æ³•å³å¯æ¢å¤è´­ä¹°<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="name">SKPaymentQueue</span> defaultQueue] removeTransactionObserver:self]<span class="comment">;</span></span><br></pre></td></tr></table></figure></p>
<p><strong> <end></end></strong></p>
<hr>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/iOSå¼€å‘ä¹‹ - åˆ·æ–°æ¡†æ¶ MJRefresh çš„ä½¿ç”¨/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="åˆ˜æœ‹å¤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ä»¥æ¢¦ä¸ºé©¬">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/iOSå¼€å‘ä¹‹ - åˆ·æ–°æ¡†æ¶ MJRefresh çš„ä½¿ç”¨/" itemprop="url">
                  iOSå¼€å‘ä¹‹ - åˆ·æ–°æ¡†æ¶ MJRefresh çš„ä½¿ç”¨
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://upload-images.jianshu.io/upload_images/2665449-9e9c86ec592c3c2f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="MJRefresh"></p>
<blockquote>
<p>ä¸‹æ‹‰åˆ·æ–°æ§ä»¶ç›®å‰æ¯”è¾ƒç«çš„æœ‰å¥½å‡ ç§ï¼Œæ­¤å‰ç”¨è¿‡<a href="https://github.com/CoderMJLee/MJRefresh/blob/master/README.md" target="_blank" rel="noopener">MJRefresh</a> å’Œ<a href="https://github.com/samvermette/SVPullToRefresh" target="_blank" rel="noopener"> SVPullToRefresh</a>ï¼Œç›¸å¯¹è€Œè¨€ï¼Œè¿˜æ˜¯è§‰å¾— MJRefresh æ›´å¥½ç”¨ï¼å› æ­¤æŠ½äº†äº›æ—¶é—´æ•´ç†äº† MJRefresh çš„ç”¨æ³•ã€‚ä»¥ä¸‹æ˜¯æ–‡ç« å†…å®¹ã€‚ã€‚ã€‚</p>
</blockquote>
<h1 id="ã€æ–‡ç« ç›®å½•ã€‘"><a href="#ã€æ–‡ç« ç›®å½•ã€‘" class="headerlink" title="ã€æ–‡ç« ç›®å½•ã€‘"></a>ã€æ–‡ç« ç›®å½•ã€‘</h1><h2 id="ä¸€ã€ç±»ç»“æ„å›¾"><a href="#ä¸€ã€ç±»ç»“æ„å›¾" class="headerlink" title="ä¸€ã€ç±»ç»“æ„å›¾"></a>ä¸€ã€ç±»ç»“æ„å›¾</h2><ul>
<li>MJRefreshComponent.h</li>
<li>MJRefreshHeader.h</li>
<li>MJRefreshFooter.h</li>
<li>MJRefreshAutoFooter.h</li>
</ul>
<h2 id="äºŒã€å‚è€ƒä¾‹å­"><a href="#äºŒã€å‚è€ƒä¾‹å­" class="headerlink" title="äºŒã€å‚è€ƒä¾‹å­"></a>äºŒã€å‚è€ƒä¾‹å­</h2><ul>
<li>ä¸‹æ‹‰åˆ·æ–°01-é»˜è®¤</li>
<li>ä¸‹æ‹‰åˆ·æ–°02-åŠ¨ç”»å›¾ç‰‡</li>
<li>ä¸‹æ‹‰åˆ·æ–°03-éšè—æ—¶é—´</li>
<li>ä¸‹æ‹‰åˆ·æ–°04-éšè—çŠ¶æ€å’Œæ—¶é—´</li>
<li>ä¸‹æ‹‰åˆ·æ–°05-è‡ªå®šä¹‰æ–‡å­—</li>
<li>ä¸‹æ‹‰åˆ·æ–°06-è‡ªå®šä¹‰åˆ·æ–°æ§ä»¶</li>
<li>ä¸Šæ‹‰åˆ·æ–°01-é»˜è®¤</li>
<li>ä¸Šæ‹‰åˆ·æ–°02-åŠ¨ç”»å›¾ç‰‡</li>
<li>ä¸Šæ‹‰åˆ·æ–°03-éšè—åˆ·æ–°çŠ¶æ€çš„æ–‡å­—</li>
<li>ä¸Šæ‹‰åˆ·æ–°04-å…¨éƒ¨åŠ è½½å®Œæ¯•</li>
<li>ä¸Šæ‹‰åˆ·æ–°05-è‡ªå®šä¹‰æ–‡å­—</li>
<li>ä¸Šæ‹‰åˆ·æ–°06-åŠ è½½åéšè—</li>
<li>ä¸Šæ‹‰åˆ·æ–°07-è‡ªåŠ¨å›å¼¹çš„ä¸Šæ‹‰01</li>
<li>ä¸Šæ‹‰åˆ·æ–°08-è‡ªåŠ¨å›å¼¹çš„ä¸Šæ‹‰02</li>
<li>ä¸Šæ‹‰åˆ·æ–°09-è‡ªå®šä¹‰åˆ·æ–°æ§ä»¶(è‡ªåŠ¨åˆ·æ–°)</li>
<li>ä¸Šæ‹‰åˆ·æ–°10-è‡ªå®šä¹‰åˆ·æ–°æ§ä»¶(è‡ªåŠ¨å›å¼¹)</li>
<li>UICollectionView01-ä¸Šä¸‹æ‹‰åˆ·æ–°</li>
<li>UIWebView01-ä¸‹æ‹‰åˆ·æ–°</li>
</ul>
<h1 id="ã€æ–‡ç« å†…å®¹ã€‘"><a href="#ã€æ–‡ç« å†…å®¹ã€‘" class="headerlink" title="ã€æ–‡ç« å†…å®¹ã€‘"></a>ã€æ–‡ç« å†…å®¹ã€‘</h1><h2 id="1-ç±»ç»“æ„å›¾"><a href="#1-ç±»ç»“æ„å›¾" class="headerlink" title="1.ç±»ç»“æ„å›¾"></a>1.ç±»ç»“æ„å›¾</h2><p><img src="http://upload-images.jianshu.io/upload_images/2665449-4a80291bb05b5283.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç±»ç»“æ„å›¾"></p>
<h3 id="MJRefreshComponent-h"><a href="#MJRefreshComponent-h" class="headerlink" title="MJRefreshComponent.h"></a>MJRefreshComponent.h</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** åˆ·æ–°æ§ä»¶çš„åŸºç±» */</span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MJRefreshComponent</span> : <span class="title">UIView</span></span></span><br><span class="line"><span class="meta">#pragma mark - åˆ·æ–°çŠ¶æ€æ§åˆ¶</span></span><br><span class="line"><span class="comment">/** è¿›å…¥åˆ·æ–°çŠ¶æ€ */</span></span><br><span class="line">- (<span class="keyword">void</span>)beginRefreshing;</span><br><span class="line"><span class="comment">/** ç»“æŸåˆ·æ–°çŠ¶æ€ */</span></span><br><span class="line">- (<span class="keyword">void</span>)endRefreshing;</span><br><span class="line"><span class="comment">/** æ˜¯å¦æ­£åœ¨åˆ·æ–° */</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)isRefreshing;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - å…¶å®ƒ</span></span><br><span class="line"><span class="comment">/** æ ¹æ®æ‹–æ‹½æ¯”ä¾‹è‡ªåŠ¨åˆ‡æ¢é€æ˜åº¦ */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>, <span class="keyword">getter</span>=isAutomaticallyChangeAlpha) <span class="built_in">BOOL</span> automaticallyChangeAlpha;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h3 id="MJRefreshHeader-h"><a href="#MJRefreshHeader-h" class="headerlink" title="MJRefreshHeader.h"></a>MJRefreshHeader.h</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MJRefreshHeader</span> : <span class="title">MJRefreshComponent</span></span></span><br><span class="line"><span class="comment">/** åˆ›å»º header */</span></span><br><span class="line">+ (<span class="keyword">instancetype</span>)headerWithRefreshingBlock:(MJRefreshComponentRefreshingBlock)refreshingBlock;</span><br><span class="line"><span class="comment">/** åˆ›å»º header */</span></span><br><span class="line">+ (<span class="keyword">instancetype</span>)headerWithRefreshingTarget:(<span class="keyword">id</span>)target refreshingAction:(SEL)action;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** è¿™ä¸ª key ç”¨æ¥å­˜å‚¨ä¸Šä¸€æ¬¡ä¸‹æ‹‰åˆ·æ–°æˆåŠŸçš„æ—¶é—´ */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *lastUpdatedTimeKey;</span><br><span class="line"><span class="comment">/** ä¸Šä¸€æ¬¡ä¸‹æ‹‰åˆ·æ–°æˆåŠŸçš„æ—¶é—´ */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">NSDate</span> *lastUpdatedTime;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** å¿½ç•¥å¤šå°‘ scrollView çš„ contentInset çš„é¡¶éƒ¨ */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> ignoredScrollViewContentInsetTop;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h3 id="MJRefreshFooter-h"><a href="#MJRefreshFooter-h" class="headerlink" title="MJRefreshFooter.h"></a>MJRefreshFooter.h</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MJRefreshFooter</span> : <span class="title">MJRefreshComponent</span></span></span><br><span class="line"><span class="comment">/** åˆ›å»º footer */</span></span><br><span class="line">+ (<span class="keyword">instancetype</span>)footerWithRefreshingBlock:(MJRefreshComponentRefreshingBlock)refreshingBlock;</span><br><span class="line"><span class="comment">/** åˆ›å»º footer */</span></span><br><span class="line">+ (<span class="keyword">instancetype</span>)footerWithRefreshingTarget:(<span class="keyword">id</span>)target refreshingAction:(SEL)action;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** æç¤ºæ²¡æœ‰æ›´å¤šçš„æ•°æ® */</span></span><br><span class="line">- (<span class="keyword">void</span>)noticeNoMoreData;</span><br><span class="line"><span class="comment">/** é‡ç½®æ²¡æœ‰æ›´å¤šçš„æ•°æ®ï¼ˆæ¶ˆé™¤æ²¡æœ‰æ›´å¤šæ•°æ®çš„çŠ¶æ€ï¼‰ */</span></span><br><span class="line">- (<span class="keyword">void</span>)resetNoMoreData;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** å¿½ç•¥å¤šå°‘ scrollView çš„ contentInset çš„åº•éƒ¨*/</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> ignoredScrollViewContentInsetBottom;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** è‡ªåŠ¨æ ¹æ®æœ‰æ— æ•°æ®æ¥æ˜¾ç¤ºå’Œéšè— */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">BOOL</span> automaticallyHidden;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h3 id="MJRefreshAutoFooter-h"><a href="#MJRefreshAutoFooter-h" class="headerlink" title="MJRefreshAutoFooter.h"></a>MJRefreshAutoFooter.h</h3><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@interface</span> <span class="attribute">MJRefreshAutoFooter </span>: MJRefreshFooter</span><br><span class="line"><span class="comment">/** æ˜¯å¦è‡ªåŠ¨åˆ·æ–°(é»˜è®¤ä¸º YES) */</span></span><br><span class="line"><span class="variable">@property</span> (assign, nonatomic, getter=isAutomaticallyRefresh) BOOL automaticallyRefresh;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** å½“åº•éƒ¨æ§ä»¶å‡ºç°å¤šå°‘æ—¶å°±è‡ªåŠ¨åˆ·æ–°(é»˜è®¤ä¸º1.0ï¼Œä¹Ÿå°±æ˜¯åº•éƒ¨æ§ä»¶å®Œå…¨å‡ºç°æ—¶ï¼Œæ‰ä¼šè‡ªåŠ¨åˆ·æ–°) */</span></span><br><span class="line"><span class="variable">@property</span> (assign, nonatomic) CGFloat appearencePercentTriggerAutoRefresh;</span><br><span class="line"><span class="variable">@end</span></span><br></pre></td></tr></table></figure>
<h2 id="2-å‚è€ƒä¾‹å­"><a href="#2-å‚è€ƒä¾‹å­" class="headerlink" title="2.å‚è€ƒä¾‹å­"></a>2.å‚è€ƒä¾‹å­</h2><p>ps: å¯ä»¥ä¸‹è½½ <a href="https://github.com/CoderMJLee/MJRefresh" target="_blank" rel="noopener">MJRefresh</a>è¯•è¯•<br><img src="http://upload-images.jianshu.io/upload_images/2665449-9bfe1621e9aea9f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="MJRefresh æ¼”ç¤º"></p>
<h3 id="ä¸‹æ‹‰åˆ·æ–°01-é»˜è®¤"><a href="#ä¸‹æ‹‰åˆ·æ–°01-é»˜è®¤" class="headerlink" title="ä¸‹æ‹‰åˆ·æ–°01-é»˜è®¤"></a>ä¸‹æ‹‰åˆ·æ–°01-é»˜è®¤</h3><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">self</span>.<span class="built_in">table</span>View.mj_header = [MJRefreshNormalHeader headerWithRefreshingBlock:^&#123;</span><br><span class="line">// è¿›å…¥åˆ·æ–°çŠ¶æ€åä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ª<span class="built_in">block</span></span><br><span class="line">&#125;];</span><br><span class="line">// æˆ–</span><br><span class="line">// è®¾ç½®å›è°ƒï¼ˆä¸€æ—¦è¿›å…¥åˆ·æ–°çŠ¶æ€ï¼Œå°±è°ƒç”¨ target çš„ actionï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨ <span class="literal">self</span> çš„ <span class="built_in">load</span>NewData æ–¹æ³•ï¼‰</span><br><span class="line"><span class="literal">self</span>.<span class="built_in">table</span>View.mj_header = [MJRefreshNormalHeader headerWithRefreshingTarget:<span class="literal">self</span> refreshingAction:@selector(<span class="built_in">load</span>NewData)];</span><br><span class="line">// é©¬ä¸Šè¿›å…¥åˆ·æ–°çŠ¶æ€</span><br><span class="line">[<span class="literal">self</span>.<span class="built_in">table</span>View.mj_header beginRefreshing];</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-a3bfaa0e6bfbc461.gif?imageMogr2/auto-orient/strip" alt="ä¸‹æ‹‰åˆ·æ–°01-é»˜è®¤"></p>
<h3 id="ä¸‹æ‹‰åˆ·æ–°02-åŠ¨ç”»å›¾ç‰‡"><a href="#ä¸‹æ‹‰åˆ·æ–°02-åŠ¨ç”»å›¾ç‰‡" class="headerlink" title="ä¸‹æ‹‰åˆ·æ–°02-åŠ¨ç”»å›¾ç‰‡"></a>ä¸‹æ‹‰åˆ·æ–°02-åŠ¨ç”»å›¾ç‰‡</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¾ç½®å›è°ƒï¼ˆä¸€æ—¦è¿›å…¥åˆ·æ–°çŠ¶æ€ï¼Œå°±è°ƒç”¨ targett çš„ actionï¼Œå³è°ƒç”¨ self çš„ loadNewData æ–¹æ³•ï¼‰</span></span><br><span class="line">MJRefreshGifHeader *header = [MJRefreshGifHeader <span class="string">headerWithRefreshingTarget:</span>self <span class="string">refreshingAction:</span><span class="meta">@selector</span>(loadNewData)];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®æ™®é€šçŠ¶æ€çš„åŠ¨ç”»å›¾ç‰‡</span></span><br><span class="line">NSArray *idleImages = @[@<span class="string">"å›¾ç‰‡1"</span>, @<span class="string">"å›¾ç‰‡2"</span>, @<span class="string">"å›¾ç‰‡3"</span>];</span><br><span class="line">[header <span class="string">setImages:</span>idleImages <span class="string">forState:</span>MJRefreshStateIdle];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®å³å°†åˆ·æ–°çŠ¶æ€çš„åŠ¨ç”»å›¾ç‰‡ï¼ˆä¸€æ¾å¼€å°±ä¼šåˆ·æ–°çš„çŠ¶æ€ï¼‰</span></span><br><span class="line">NSArray *pullingImages = @[@<span class="string">"å›¾ç‰‡1"</span>, @<span class="string">"å›¾ç‰‡2"</span>, @<span class="string">"å›¾ç‰‡3"</span>];</span><br><span class="line">[header <span class="string">setImages:</span>pullingImages <span class="string">forState:</span>MJRefreshStatePulling];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®æ­£åœ¨åˆ·æ–°çŠ¶æ€çš„åŠ¨ç”»å›¾ç‰‡</span></span><br><span class="line">NSArray *refreshingImages = @[@<span class="string">"å›¾ç‰‡1"</span>, @<span class="string">"å›¾ç‰‡2"</span>, @<span class="string">"å›¾ç‰‡3"</span>];</span><br><span class="line">[header <span class="string">setImages:</span>refreshingImages <span class="string">forState:</span>MJRefreshStateRefreshing];</span><br><span class="line"><span class="comment">// è®¾ç½® header</span></span><br><span class="line">self.tableView.mj_header = header;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-392f24b00061ea83.gif?imageMogr2/auto-orient/strip" alt="ä¸‹æ‹‰åˆ·æ–°02-åŠ¨ç”»å›¾ç‰‡"></p>
<h3 id="ä¸‹æ‹‰åˆ·æ–°03-éšè—æ—¶é—´"><a href="#ä¸‹æ‹‰åˆ·æ–°03-éšè—æ—¶é—´" class="headerlink" title="ä¸‹æ‹‰åˆ·æ–°03-éšè—æ—¶é—´"></a>ä¸‹æ‹‰åˆ·æ–°03-éšè—æ—¶é—´</h3><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// éšè—æ—¶é—´</span></span><br><span class="line">header.lastUpdatedTimeLabel.hidden = <span class="keyword">YES</span>;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-a3c38c436477cacc.gif?imageMogr2/auto-orient/strip" alt="ä¸‹æ‹‰åˆ·æ–°03-éšè—æ—¶é—´"></p>
<h3 id="ä¸‹æ‹‰åˆ·æ–°04-éšè—çŠ¶æ€å’Œæ—¶é—´"><a href="#ä¸‹æ‹‰åˆ·æ–°04-éšè—çŠ¶æ€å’Œæ—¶é—´" class="headerlink" title="ä¸‹æ‹‰åˆ·æ–°04-éšè—çŠ¶æ€å’Œæ—¶é—´"></a>ä¸‹æ‹‰åˆ·æ–°04-éšè—çŠ¶æ€å’Œæ—¶é—´</h3><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// éšè—æ—¶é—´</span><br><span class="line">header.lastUpdatedTimeLabel.hidden = YES;</span><br><span class="line"></span><br><span class="line">// éšè—çŠ¶æ€</span><br><span class="line">header.<span class="keyword">state</span>Label.hidden = YES;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-bea00ff6a76a81fd.gif?imageMogr2/auto-orient/strip" alt="ä¸‹æ‹‰åˆ·æ–°04-éšè—çŠ¶æ€å’Œæ—¶é—´"></p>
<h3 id="ä¸‹æ‹‰åˆ·æ–°05-è‡ªå®šä¹‰æ–‡å­—"><a href="#ä¸‹æ‹‰åˆ·æ–°05-è‡ªå®šä¹‰æ–‡å­—" class="headerlink" title="ä¸‹æ‹‰åˆ·æ–°05-è‡ªå®šä¹‰æ–‡å­—"></a>ä¸‹æ‹‰åˆ·æ–°05-è‡ªå®šä¹‰æ–‡å­—</h3><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// è®¾ç½®æ–‡å­—</span><br><span class="line">[header <span class="built_in">set</span>Title:@<span class="string">"Pull down to refresh"</span> <span class="keyword">for</span>State:MJRefreshStateIdle];</span><br><span class="line">[header <span class="built_in">set</span>Title:@<span class="string">"Release to refresh"</span> <span class="keyword">for</span>State:MJRefreshStatePulling];</span><br><span class="line">[header <span class="built_in">set</span>Title:@<span class="string">"Loading ..."</span> <span class="keyword">for</span>State:MJRefreshStateRefreshing];</span><br><span class="line"></span><br><span class="line">// è®¾ç½®å­—ä½“</span><br><span class="line">header.<span class="keyword">state</span>Label.font = [UIFont systemFontOfSize:<span class="number">15</span>];</span><br><span class="line">header.lastUpdatedTimeLabel.font = [UIFont systemFontOfSize:<span class="number">14</span>];</span><br><span class="line"></span><br><span class="line">// è®¾ç½®é¢œè‰²</span><br><span class="line">header.<span class="keyword">state</span>Label.textColor = [UIColor redColor];</span><br><span class="line">header.lastUpdatedTimeLabel.textColor = [UIColor blueColor];</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-ad9e5a170567e3bb.gif?imageMogr2/auto-orient/strip" alt="ä¸‹æ‹‰åˆ·æ–°05-è‡ªå®šä¹‰æ–‡å­—"></p>
<h3 id="ä¸‹æ‹‰åˆ·æ–°06-è‡ªå®šä¹‰åˆ·æ–°æ§ä»¶"><a href="#ä¸‹æ‹‰åˆ·æ–°06-è‡ªå®šä¹‰åˆ·æ–°æ§ä»¶" class="headerlink" title="ä¸‹æ‹‰åˆ·æ–°06-è‡ªå®šä¹‰åˆ·æ–°æ§ä»¶"></a>ä¸‹æ‹‰åˆ·æ–°06-è‡ªå®šä¹‰åˆ·æ–°æ§ä»¶</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.tableView.mj_header = [MJDIYHeader <span class="symbol">headerWithRefreshingTarget:</span><span class="keyword">self</span> <span class="symbol">refreshingAction:</span><span class="variable">@selector</span>(loadNewData)];</span><br><span class="line">/<span class="regexp">/ å…·ä½“å®ç°å‚è€ƒ MJDIYHeader.h å’Œ MJDIYHeader.m</span></span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-02fca65a8c891905.gif?imageMogr2/auto-orient/strip" alt="ä¸‹æ‹‰åˆ·æ–°06-è‡ªå®šä¹‰åˆ·æ–°æ§ä»¶"></p>
<h3 id="ä¸Šæ‹‰åˆ·æ–°01-é»˜è®¤"><a href="#ä¸Šæ‹‰åˆ·æ–°01-é»˜è®¤" class="headerlink" title="ä¸Šæ‹‰åˆ·æ–°01-é»˜è®¤"></a>ä¸Šæ‹‰åˆ·æ–°01-é»˜è®¤</h3><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">self</span>.<span class="built_in">table</span>View.mj_footer = [MJRefreshAutoNormalFooter footerWithRefreshingBlock:^&#123;</span><br><span class="line">// è¿›å…¥åˆ·æ–°çŠ¶æ€åä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ª <span class="built_in">block</span></span><br><span class="line">&#125;];</span><br><span class="line">// æˆ–</span><br><span class="line">// è®¾ç½®å›è°ƒï¼ˆä¸€æ—¦è¿›å…¥åˆ·æ–°çŠ¶æ€ï¼Œå°±è°ƒç”¨ target çš„ actionï¼Œå³è°ƒç”¨ <span class="literal">self</span> çš„ <span class="built_in">load</span>MoreData æ–¹æ³•ï¼‰</span><br><span class="line"><span class="literal">self</span>.<span class="built_in">table</span>View.mj_footer = [MJRefreshAutoNormalFooter footerWithRefreshingTarget:<span class="literal">self</span> refreshingAction:@selector(<span class="built_in">load</span>MoreData)];</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-475e06e1f29fb149.gif?imageMogr2/auto-orient/strip" alt="ä¸Šæ‹‰åˆ·æ–°01-é»˜è®¤"></p>
<h3 id="ä¸Šæ‹‰åˆ·æ–°02-åŠ¨ç”»å›¾ç‰‡"><a href="#ä¸Šæ‹‰åˆ·æ–°02-åŠ¨ç”»å›¾ç‰‡" class="headerlink" title="ä¸Šæ‹‰åˆ·æ–°02-åŠ¨ç”»å›¾ç‰‡"></a>ä¸Šæ‹‰åˆ·æ–°02-åŠ¨ç”»å›¾ç‰‡</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®å›è°ƒï¼ˆä¸€æ—¦è¿›å…¥åˆ·æ–°çŠ¶æ€ï¼Œå°±è°ƒç”¨ target çš„ actionï¼Œå³è°ƒç”¨ self çš„ loadMoreData æ–¹æ³•ï¼‰</span></span><br><span class="line">MJRefreshAutoGifFooter *footer = [MJRefreshAutoGifFooter <span class="string">footerWithRefreshingTarget:</span>self <span class="string">refreshingAction:</span><span class="meta">@selector</span>(loadMoreData)];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®åˆ·æ–°å›¾ç‰‡</span></span><br><span class="line">NSArray *refreshingImages = @[@<span class="string">"å›¾ç‰‡1"</span>, @<span class="string">"å›¾ç‰‡2"</span>, @<span class="string">"å›¾ç‰‡3"</span>];</span><br><span class="line">[footer <span class="string">setImages:</span>refreshingImages <span class="string">forState:</span>MJRefreshStateRefreshing];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®å°¾éƒ¨</span></span><br><span class="line">self.tableView.mj_footer = footer;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-15a83363eff10b1e.gif?imageMogr2/auto-orient/strip" alt="ä¸Šæ‹‰åˆ·æ–°02-åŠ¨ç”»å›¾ç‰‡"></p>
<h3 id="ä¸Šæ‹‰åˆ·æ–°03-éšè—åˆ·æ–°çŠ¶æ€çš„æ–‡å­—"><a href="#ä¸Šæ‹‰åˆ·æ–°03-éšè—åˆ·æ–°çŠ¶æ€çš„æ–‡å­—" class="headerlink" title="ä¸Šæ‹‰åˆ·æ–°03-éšè—åˆ·æ–°çŠ¶æ€çš„æ–‡å­—"></a>ä¸Šæ‹‰åˆ·æ–°03-éšè—åˆ·æ–°çŠ¶æ€çš„æ–‡å­—</h3><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// éšè—åˆ·æ–°çŠ¶æ€çš„æ–‡å­—</span><br><span class="line">footer.refreshingTitleHidden = YES;</span><br><span class="line">// å¦‚æœæ²¡æœ‰ä¸Šé¢çš„æ–¹æ³•ï¼Œå°±ç”¨footer.<span class="keyword">state</span>Label.hidden = YES;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-7dcd46bd73d0423f.gif?imageMogr2/auto-orient/strip" alt="ä¸Šæ‹‰åˆ·æ–°03-éšè—åˆ·æ–°çŠ¶æ€çš„æ–‡å­—"></p>
<h3 id="ä¸Šæ‹‰åˆ·æ–°04-å…¨éƒ¨åŠ è½½å®Œæ¯•"><a href="#ä¸Šæ‹‰åˆ·æ–°04-å…¨éƒ¨åŠ è½½å®Œæ¯•" class="headerlink" title="ä¸Šæ‹‰åˆ·æ–°04-å…¨éƒ¨åŠ è½½å®Œæ¯•"></a>ä¸Šæ‹‰åˆ·æ–°04-å…¨éƒ¨åŠ è½½å®Œæ¯•</h3><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å˜ä¸ºæ²¡æœ‰æ›´å¤šæ•°æ®çš„çŠ¶æ€</span></span><br><span class="line">[<span class="meta">footer endRefreshingWithNoMoreData</span>];</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-3f0e9a88feb33219.gif?imageMogr2/auto-orient/strip" alt="ä¸Šæ‹‰åˆ·æ–°04-å…¨éƒ¨åŠ è½½å®Œæ¯•"></p>
<h3 id="ä¸Šæ‹‰åˆ·æ–°05-è‡ªå®šä¹‰æ–‡å­—"><a href="#ä¸Šæ‹‰åˆ·æ–°05-è‡ªå®šä¹‰æ–‡å­—" class="headerlink" title="ä¸Šæ‹‰åˆ·æ–°05-è‡ªå®šä¹‰æ–‡å­—"></a>ä¸Šæ‹‰åˆ·æ–°05-è‡ªå®šä¹‰æ–‡å­—</h3><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// è®¾ç½®æ–‡å­—</span><br><span class="line">[footer <span class="built_in">set</span>Title:@<span class="string">"Click or drag up to refresh"</span> <span class="keyword">for</span>State:MJRefreshStateIdle];</span><br><span class="line">[footer <span class="built_in">set</span>Title:@<span class="string">"Loading more ..."</span> <span class="keyword">for</span>State:MJRefreshStateRefreshing];</span><br><span class="line">[footer <span class="built_in">set</span>Title:@<span class="string">"No more data"</span> <span class="keyword">for</span>State:MJRefreshStateNoMoreData];</span><br><span class="line"></span><br><span class="line">// è®¾ç½®å­—ä½“</span><br><span class="line">footer.<span class="keyword">state</span>Label.font = [UIFont systemFontOfSize:<span class="number">17</span>];</span><br><span class="line"></span><br><span class="line">// è®¾ç½®é¢œè‰²</span><br><span class="line">footer.<span class="keyword">state</span>Label.textColor = [UIColor blueColor];</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-f9383ff9ab48a6b2.gif?imageMogr2/auto-orient/strip" alt="ä¸Šæ‹‰åˆ·æ–°05-è‡ªå®šä¹‰æ–‡å­—"></p>
<h3 id="ä¸Šæ‹‰åˆ·æ–°06-åŠ è½½åéšè—"><a href="#ä¸Šæ‹‰åˆ·æ–°06-åŠ è½½åéšè—" class="headerlink" title="ä¸Šæ‹‰åˆ·æ–°06-åŠ è½½åéšè—"></a>ä¸Šæ‹‰åˆ·æ–°06-åŠ è½½åéšè—</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// éšè—å½“å‰çš„ä¸Šæ‹‰åˆ·æ–°æ§ä»¶</span></span><br><span class="line"><span class="keyword">self</span>.tableView.mj_footer.hidden = <span class="literal">YES</span>;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-44824bc808564096.gif?imageMogr2/auto-orient/strip" alt="ä¸Šæ‹‰åˆ·æ–°06-åŠ è½½åéšè—"></p>
<h3 id="ä¸Šæ‹‰åˆ·æ–°07-è‡ªåŠ¨å›å¼¹çš„ä¸Šæ‹‰01"><a href="#ä¸Šæ‹‰åˆ·æ–°07-è‡ªåŠ¨å›å¼¹çš„ä¸Šæ‹‰01" class="headerlink" title="ä¸Šæ‹‰åˆ·æ–°07-è‡ªåŠ¨å›å¼¹çš„ä¸Šæ‹‰01"></a>ä¸Šæ‹‰åˆ·æ–°07-è‡ªåŠ¨å›å¼¹çš„ä¸Šæ‹‰01</h3><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">self</span>.<span class="built_in">table</span>View.mj_footer = [MJRefreshBackNormalFooter footerWithRefreshingTarget:<span class="literal">self</span> refreshingAction:@selector(<span class="built_in">load</span>MoreData)];</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-ab778a9f00a22a4f.gif?imageMogr2/auto-orient/strip" alt="ä¸Šæ‹‰åˆ·æ–°07-è‡ªåŠ¨å›å¼¹çš„ä¸Šæ‹‰01"></p>
<h3 id="ä¸Šæ‹‰åˆ·æ–°08-è‡ªåŠ¨å›å¼¹çš„ä¸Šæ‹‰02"><a href="#ä¸Šæ‹‰åˆ·æ–°08-è‡ªåŠ¨å›å¼¹çš„ä¸Šæ‹‰02" class="headerlink" title="ä¸Šæ‹‰åˆ·æ–°08-è‡ªåŠ¨å›å¼¹çš„ä¸Šæ‹‰02"></a>ä¸Šæ‹‰åˆ·æ–°08-è‡ªåŠ¨å›å¼¹çš„ä¸Šæ‹‰02</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">MJRefreshBackGifFooter *footer = [MJRefreshBackGifFooter <span class="string">footerWithRefreshingTarget:</span>self <span class="string">refreshingAction:</span><span class="meta">@selector</span>(loadMoreData)];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®æ™®é€šçŠ¶æ€çš„åŠ¨ç”»å›¾ç‰‡</span></span><br><span class="line">NSArray *idleImages = @[@<span class="string">"å›¾ç‰‡1"</span>, @<span class="string">"å›¾ç‰‡2"</span>, @<span class="string">"å›¾ç‰‡3"</span>];</span><br><span class="line">[footer <span class="string">setImages:</span>idleImages <span class="string">forState:</span>MJRefreshStateIdle];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®å³å°†åˆ·æ–°çŠ¶æ€çš„åŠ¨ç”»å›¾ç‰‡ï¼ˆä¸€æ¾å¼€å°±ä¼šåˆ·æ–°çš„çŠ¶æ€ï¼‰</span></span><br><span class="line">NSArray *pullingImages = @[@<span class="string">"å›¾ç‰‡1"</span>, @<span class="string">"å›¾ç‰‡2"</span>, @<span class="string">"å›¾ç‰‡3"</span>];</span><br><span class="line"></span><br><span class="line">[footer <span class="string">setImages:</span>pullingImages <span class="string">forState:</span>MJRefreshStatePulling];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®æ­£åœ¨åˆ·æ–°çŠ¶æ€çš„åŠ¨ç”»å›¾ç‰‡</span></span><br><span class="line">NSArray *refreshingImages = @[@<span class="string">"å›¾ç‰‡1"</span>, @<span class="string">"å›¾ç‰‡2"</span>, @<span class="string">"å›¾ç‰‡3"</span>];</span><br><span class="line">[footer <span class="string">setImages:</span>refreshingImages <span class="string">forState:</span>MJRefreshStateRefreshing];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®å°¾éƒ¨</span></span><br><span class="line">self.tableView.mj_footer = footer;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-7ff75c5dc70d3d33.gif?imageMogr2/auto-orient/strip" alt="ä¸Šæ‹‰åˆ·æ–°08-è‡ªåŠ¨å›å¼¹çš„ä¸Šæ‹‰02"></p>
<h3 id="ä¸Šæ‹‰åˆ·æ–°09-è‡ªå®šä¹‰åˆ·æ–°æ§ä»¶-è‡ªåŠ¨åˆ·æ–°"><a href="#ä¸Šæ‹‰åˆ·æ–°09-è‡ªå®šä¹‰åˆ·æ–°æ§ä»¶-è‡ªåŠ¨åˆ·æ–°" class="headerlink" title="ä¸Šæ‹‰åˆ·æ–°09-è‡ªå®šä¹‰åˆ·æ–°æ§ä»¶(è‡ªåŠ¨åˆ·æ–°)"></a>ä¸Šæ‹‰åˆ·æ–°09-è‡ªå®šä¹‰åˆ·æ–°æ§ä»¶(è‡ªåŠ¨åˆ·æ–°)</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.tableView.mj_footer = [MJDIYAutoFooter <span class="symbol">footerWithRefreshingTarget:</span><span class="keyword">self</span> <span class="symbol">refreshingAction:</span><span class="variable">@selector</span>(loadMoreData)];</span><br><span class="line">/<span class="regexp">/ å…·ä½“å®ç°å‚è€ƒMJDIYAutoFooter.hå’ŒMJDIYAutoFooter.m</span></span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-504544818173e40a.gif?imageMogr2/auto-orient/strip" alt="ä¸Šæ‹‰åˆ·æ–°09-è‡ªå®šä¹‰åˆ·æ–°æ§ä»¶(è‡ªåŠ¨åˆ·æ–°)"></p>
<h3 id="ä¸Šæ‹‰åˆ·æ–°10-è‡ªå®šä¹‰åˆ·æ–°æ§ä»¶-è‡ªåŠ¨å›å¼¹"><a href="#ä¸Šæ‹‰åˆ·æ–°10-è‡ªå®šä¹‰åˆ·æ–°æ§ä»¶-è‡ªåŠ¨å›å¼¹" class="headerlink" title="ä¸Šæ‹‰åˆ·æ–°10-è‡ªå®šä¹‰åˆ·æ–°æ§ä»¶(è‡ªåŠ¨å›å¼¹)"></a>ä¸Šæ‹‰åˆ·æ–°10-è‡ªå®šä¹‰åˆ·æ–°æ§ä»¶(è‡ªåŠ¨å›å¼¹)</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.tableView.mj_footer = [MJDIYBackFooter <span class="symbol">footerWithRefreshingTarget:</span><span class="keyword">self</span> <span class="symbol">refreshingAction:</span><span class="variable">@selector</span>(loadMoreData)];</span><br><span class="line">/<span class="regexp">/ å…·ä½“å®ç°å‚è€ƒMJDIYBackFooter.hå’ŒMJDIYBackFooter.m</span></span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-39f29fe70a310b80.gif?imageMogr2/auto-orient/strip" alt="ä¸Šæ‹‰åˆ·æ–°10-è‡ªå®šä¹‰åˆ·æ–°æ§ä»¶(è‡ªåŠ¨å›å¼¹)"></p>
<h3 id="UICollectionView01-ä¸Šä¸‹æ‹‰åˆ·æ–°"><a href="#UICollectionView01-ä¸Šä¸‹æ‹‰åˆ·æ–°" class="headerlink" title="UICollectionView01-ä¸Šä¸‹æ‹‰åˆ·æ–°"></a>UICollectionView01-ä¸Šä¸‹æ‹‰åˆ·æ–°</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸‹æ‹‰åˆ·æ–°</span></span><br><span class="line">self.collectionView.mj_header = [MJRefreshNormalHeader <span class="string">headerWithRefreshingBlock:</span>^&#123;</span><br><span class="line"><span class="comment">// è¿›å…¥åˆ·æ–°çŠ¶æ€åä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªblock</span></span><br><span class="line">&#125;];</span><br><span class="line"><span class="comment">// ä¸Šæ‹‰åˆ·æ–°</span></span><br><span class="line">self.collectionView.mj_footer = [MJRefreshAutoNormalFooter <span class="string">footerWithRefreshingBlock:</span>^&#123;</span><br><span class="line"><span class="comment">// è¿›å…¥åˆ·æ–°çŠ¶æ€åä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªblock</span></span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-0d4fd9a97ffb9513.gif?imageMogr2/auto-orient/strip" alt="UICollectionView01-ä¸Šä¸‹æ‹‰åˆ·æ–°"></p>
<h3 id="UIWebView01-ä¸‹æ‹‰åˆ·æ–°"><a href="#UIWebView01-ä¸‹æ‹‰åˆ·æ–°" class="headerlink" title="UIWebView01-ä¸‹æ‹‰åˆ·æ–°"></a>UIWebView01-ä¸‹æ‹‰åˆ·æ–°</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ ä¸‹æ‹‰åˆ·æ–°æ§ä»¶</span></span><br><span class="line">self.webView.scrollView.mj_header = [MJRefreshNormalHeader <span class="string">headerWithRefreshingBlock:</span>^&#123;</span><br><span class="line"><span class="comment">// è¿›å…¥åˆ·æ–°çŠ¶æ€åä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªblock</span></span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-ee3c092adb2b9561.gif?imageMogr2/auto-orient/strip" alt="UIWebView01-ä¸‹æ‹‰åˆ·æ–°"></p>
<ul>
<li><em>over</em><br>ä»¥ä¸Šæ˜¯ MJRefresh çš„å…·ä½“ç”¨æ³•ï¼Œæœ‰å…´è¶£çš„æœ‹å‹è¿˜å¯ä»¥å‚è€ƒä¸‹<a href="https://github.com/CoderMJLee/MJRefresh/blob/master/README.md" target="_blank" rel="noopener">MJRefresh/README.md</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/iOSå¼€å‘ä¹‹ - å¥½ç©çš„å¯Œæ–‡æœ¬/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="åˆ˜æœ‹å¤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ä»¥æ¢¦ä¸ºé©¬">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/iOSå¼€å‘ä¹‹ - å¥½ç©çš„å¯Œæ–‡æœ¬/" itemprop="url">
                  iOSå¼€å‘ä¹‹ - å¥½ç©çš„å¯Œæ–‡æœ¬
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>å‘¨æœ«é—²ç€æ²¡äº‹ï¼Œå°±æƒ³ç€ä¸å¦‚æŠŠé‚£äº›å®¹æ˜“é—å¿˜çš„çŸ¥è¯†ç‚¹æ•´ç†ä¸€ä¸‹ï¼Œä¸€æ¥å¯ä»¥è®©æœ‰éœ€è¦çš„æœ‹å‹å°‘èµ°å¼¯è·¯ï¼ŒäºŒæ¥è‡ªå·±ä»¥åå†å¿˜è®°çš„æ—¶å€™ä¹Ÿå¯ä»¥å›å¤´çœ‹çœ‹â€¦â€¦ä½† iOS ä¸­å°å†·æ˜“å¿˜çš„çŸ¥è¯†ç‚¹å®åœ¨å¤ªå¤šäº†ï¼Œä¸çŸ¥é“è¯¥ä»å“ªé‡Œå¼€å§‹æ•´ç†ï¼Œâ€œç™¾æ— èŠèµ–â€é€›äº†ä¸‹æ·˜å®ï¼Œå‘ç°é‡Œé¢å¥½å¤šéƒ½æ˜¯å¯Œæ–‡æœ¬ï¼Œå°±æƒ³ç€ä¸ºä»€ä¹ˆä¸ä»å¯Œæ–‡æœ¬å¼€å§‹å‘¢ï¼Ÿåæ­£é—²ç€ä¹Ÿæ˜¯é—²ç€â€¦â€¦äºæ˜¯å°±æœ‰äº†ä¸‹é¢è¿™äº›ä¸œè¥¿ï¼Œå¸Œæœ›å¯ä»¥å¸®åˆ°çœ‹åˆ°çš„ç›†å‹ä»¬ï¼</p>
<ul>
<li>å…ˆå†™ä¸€ä¸ªå°å¼•å­<blockquote>
<p>åœ¨é¡¹ç›®ä¸­ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬éƒ½éœ€è¦æŠŠæ–‡å­—è®¾ç½®æˆå€¾æ–œã€åŠ ç²—ã€åŠ ä¸‹åˆ’çº¿ã€åŠ åˆ é™¤çº¿ã€åŠ é˜´å½±ç­‰ç­‰çŠ¶æ€ï¼Œå°±æ¯”å¦‚ä¸‹é¢è¿™å¼ å›¾ï¼š<br><img src="http://upload-images.jianshu.io/upload_images/2665449-efaea7b3b4c215d4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ä¸æ˜¯æ‰“å¹¿å‘Šå“¦"></p>
</blockquote>
</li>
</ul>
<p>ä½†å¦‚æœæˆ‘ä»¬åªæ˜¯ç®€å•çš„è®¾ç½®å­—ä½“<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">self.textView<span class="meta">.text</span> = @<span class="string">"å¾ˆå¥½ç©çš„å¯Œæ–‡æœ¬"</span><span class="comment">;</span></span><br></pre></td></tr></table></figure></p>
<p>æ˜¾ç¤ºå‡ºæ¥å¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­æ»´ï¼š<br><img src="http://upload-images.jianshu.io/upload_images/2665449-ab7fd6348e681a88.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ™®é€šæ–‡æœ¬"></p>
<p>ä¸ºäº†è®©æ–‡å­—å˜çš„å¥½çœ‹ä¸€äº›ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°è¯•ä¸€ä¸‹å¯Œæ–‡æœ¬ï¼</p>
<ul>
<li>æ”¹å˜å­—ä½“é¢œè‰²</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableAttributedString</span> *string = [[<span class="built_in">NSMutableAttributedString</span> alloc] initWithString:<span class="string">@"å¾ˆå¥½ç©çš„å¯Œæ–‡æœ¬"</span>];</span><br><span class="line"></span><br><span class="line">[string addAttribute:<span class="built_in">NSForegroundColorAttributeName</span> value:[<span class="built_in">UIColor</span> blueColor] range:<span class="built_in">NSMakeRange</span>(<span class="number">1</span>, <span class="number">2</span>)];</span><br><span class="line">[string addAttribute:<span class="built_in">NSForegroundColorAttributeName</span> value:[<span class="built_in">UIColor</span> redColor] range:<span class="built_in">NSMakeRange</span>(<span class="number">3</span>, <span class="number">1</span>)];</span><br><span class="line">[string addAttribute:<span class="built_in">NSForegroundColorAttributeName</span> value:[<span class="built_in">UIColor</span> blueColor] range:<span class="built_in">NSMakeRange</span>(<span class="number">4</span>, <span class="number">3</span>)];</span><br><span class="line"><span class="keyword">self</span>.textView.attributedText = string;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-9ab05decdf730650.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ”¹å˜å­—ä½“é¢œè‰²"></p>
<ul>
<li>æ”¹å˜å­—ä½“å¤§å°</li>
</ul>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">NSMutableAttributedString *string = [[NSMutableAttributedString alloc] <span class="string">initWithString:</span>@<span class="string">"å¾ˆå¥½ç©çš„å¯Œæ–‡æœ¬"</span>];</span><br><span class="line">[string <span class="string">addAttribute:</span>NSFontAttributeName <span class="string">value:</span>[UIFont <span class="string">systemFontOfSize:</span><span class="number">20</span>] <span class="string">range:</span>NSMakeRange(<span class="number">1</span>, <span class="number">2</span>)];</span><br><span class="line">[string <span class="string">addAttribute:</span>NSFontAttributeName <span class="string">value:</span>[UIFont <span class="string">systemFontOfSize:</span><span class="number">30</span>] <span class="string">range:</span>NSMakeRange(<span class="number">4</span>, <span class="number">3</span>)];</span><br><span class="line">self.textView.attributedText = string;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-c85ab447f29b3333.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ”¹å˜å­—ä½“å¤§å°"></p>
<ul>
<li>ç»™æ–‡å­—æ·»åŠ èƒŒæ™¯è‰²<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableAttributedString</span> *string = [[<span class="built_in">NSMutableAttributedString</span> alloc] initWithString:<span class="string">@"å¾ˆå¥½ç©çš„å¯Œæ–‡æœ¬"</span>];</span><br><span class="line">[string addAttribute:<span class="built_in">NSBackgroundColorAttributeName</span> value:[<span class="built_in">UIColor</span> cyanColor] range:<span class="built_in">NSMakeRange</span>(<span class="number">1</span>, <span class="number">2</span>)];</span><br><span class="line">[string addAttribute:<span class="built_in">NSBackgroundColorAttributeName</span> value:[<span class="built_in">UIColor</span> yellowColor] range:<span class="built_in">NSMakeRange</span>(<span class="number">4</span>, <span class="number">3</span>)];</span><br><span class="line"><span class="keyword">self</span>.textView.attributedText = string;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-5b3beb42cba98ef1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç»™æ–‡å­—æ·»åŠ èƒŒæ™¯è‰²"></p>
<ul>
<li>ç»™æ–‡å­—è®¾ç½®é—´è·<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableAttributedString</span> *string = [[<span class="built_in">NSMutableAttributedString</span> alloc] initWithString:<span class="string">@"å¾ˆå¥½ç©çš„å¯Œæ–‡æœ¬"</span>];</span><br><span class="line">[string addAttribute:<span class="built_in">NSKernAttributeName</span> value:@(<span class="number">20</span>) range:<span class="built_in">NSMakeRange</span>(<span class="number">0</span>, <span class="number">6</span>)];</span><br><span class="line"><span class="keyword">self</span>.textView.attributedText = string;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-faf5af7f1000d40e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç»™æ–‡å­—è®¾ç½®é—´è·"></p>
<ul>
<li>å­—ä½“å€¾æ–œ<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableAttributedString</span> *string = [[<span class="built_in">NSMutableAttributedString</span> alloc] initWithString:<span class="string">@"å¾ˆå¥½ç©çš„å¯Œæ–‡æœ¬"</span>];</span><br><span class="line">[string addAttribute:<span class="built_in">NSObliquenessAttributeName</span> value:@(<span class="number">0.5</span>) range:<span class="built_in">NSMakeRange</span>(<span class="number">0</span>, <span class="number">7</span>)];</span><br><span class="line"><span class="keyword">self</span>.textView.attributedText = string;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-84144fae563a02fd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å­—ä½“å€¾æ–œ"></p>
<ul>
<li>å­—ä½“åŠ ç²—<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableAttributedString</span> *string = [[<span class="built_in">NSMutableAttributedString</span> alloc] initWithString:<span class="string">@"å¾ˆå¥½ç©çš„å¯Œæ–‡æœ¬"</span>];</span><br><span class="line">[string addAttribute:<span class="built_in">NSExpansionAttributeName</span> value:@(<span class="number">0.5</span>) range:<span class="built_in">NSMakeRange</span>(<span class="number">4</span>, <span class="number">3</span>)];</span><br><span class="line"><span class="keyword">self</span>.textView.attributedText = string;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-1a4c2b74f132931e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å­—ä½“åŠ ç²—"></p>
<ul>
<li>åŠ ä¸‹åˆ’çº¿å¹¶è®¾ç½®ä¸‹åˆ’çº¿é¢œè‰²<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableAttributedString</span> *string = [[<span class="built_in">NSMutableAttributedString</span> alloc] initWithString:<span class="string">@"å¾ˆå¥½ç©çš„å¯Œæ–‡æœ¬"</span>];</span><br><span class="line">[string addAttribute:<span class="built_in">NSUnderlineStyleAttributeName</span> value:@(<span class="number">1</span>) range:<span class="built_in">NSMakeRange</span>(<span class="number">4</span>, <span class="number">3</span>)];</span><br><span class="line">[string addAttribute:<span class="built_in">NSUnderlineColorAttributeName</span> value:[<span class="built_in">UIColor</span> blueColor] range:<span class="built_in">NSMakeRange</span>(<span class="number">4</span>, <span class="number">3</span>)];</span><br><span class="line"><span class="keyword">self</span>.textView.attributedText = string;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-54fdb333b29af0a2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="åŠ ä¸‹åˆ’çº¿å¹¶è®¾ç½®ä¸‹åˆ’çº¿é¢œè‰²"></p>
<ul>
<li>åŠ åˆ é™¤çº¿å¹¶è®¾ç½®åˆ é™¤çº¿é¢œè‰²<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableAttributedString</span> *string = [[<span class="built_in">NSMutableAttributedString</span> alloc] initWithString:<span class="string">@"åŸä»·666ğŸ’°ï¼Œç°ä»·åªè¦66ğŸ’°ï¼"</span>];</span><br><span class="line">[string addAttribute:<span class="built_in">NSStrikethroughStyleAttributeName</span> value:@(<span class="number">1</span>) range:<span class="built_in">NSMakeRange</span>(<span class="number">2</span>, <span class="number">3</span>)];</span><br><span class="line">[string addAttribute:<span class="built_in">NSStrikethroughColorAttributeName</span> value:[<span class="built_in">UIColor</span> blueColor] range:<span class="built_in">NSMakeRange</span>(<span class="number">2</span>, <span class="number">3</span>)];</span><br><span class="line"><span class="keyword">self</span>.textView.attributedText = string;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-7660641928dfc070.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="åŠ åˆ é™¤çº¿å¹¶è®¾ç½®åˆ é™¤çº¿é¢œè‰²"></p>
<ul>
<li>è®¾ç½®æ–‡å­—æ–¹å‘<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">NSMutableAttributedString *string = [[NSMutableAttributedString alloc] <span class="string">initWithString:</span>@<span class="string">"å¾ˆå¥½ç©çš„å¯Œæ–‡æœ¬"</span>];</span><br><span class="line">[string <span class="string">addAttribute:</span>NSVerticalGlyphFormAttributeName <span class="string">value:</span>@(<span class="number">1</span>) <span class="string">range:</span>NSMakeRange(<span class="number">0</span>, <span class="number">7</span>)];</span><br><span class="line">[string <span class="string">addAttribute:</span>NSWritingDirectionAttributeName <span class="string">value:</span>@[@(<span class="number">2</span>),@(<span class="number">3</span>)] <span class="string">range:</span>NSMakeRange(<span class="number">0</span>, <span class="number">7</span>)];</span><br><span class="line">self.textView.attributedText = string;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-3e892743a9f112f5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è®¾ç½®æ–‡å­—æ–¹å‘"></p>
<ul>
<li>ç»™æ–‡å­—æ·»åŠ é˜´å½±<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">NSMutableAttributedString *string = [[NSMutableAttributedString alloc] initWithString:@<span class="string">"å¾ˆå¥½ç©çš„å¯Œæ–‡æœ¬"</span>]<span class="comment">;</span></span><br><span class="line">NSShadow *<span class="keyword">shadow </span>= [[NSShadow alloc]init]<span class="comment">;</span></span><br><span class="line"><span class="keyword">shadow.shadowOffset </span>= CGSizeMake(<span class="number">5</span>, <span class="number">5</span>)<span class="comment">;</span></span><br><span class="line"><span class="keyword">shadow.shadowColor </span>= [UIColor <span class="keyword">blueColor];</span></span><br><span class="line"><span class="keyword">shadow.shadowBlurRadius </span>= <span class="number">1</span><span class="comment">;</span></span><br><span class="line">[string <span class="keyword">addAttribute:NSShadowAttributeName </span>value:<span class="keyword">shadow </span>range:NSMakeRange(<span class="number">4</span>, <span class="number">3</span>)]<span class="comment">;</span></span><br><span class="line">self.textView.attributedText = string<span class="comment">;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-8f882d994febb18b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç»™æ–‡å­—æ·»åŠ é˜´å½±"></p>
<ul>
<li>å›¾æ–‡æ··æ’</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableAttributedString</span> *string = [[<span class="built_in">NSMutableAttributedString</span> alloc] initWithString:<span class="string">@"å¾ˆå¥½ç©çš„å¯Œæ–‡æœ¬"</span>];</span><br><span class="line"><span class="comment">// åˆ›å»ºå›¾ç‰‡å›¾ç‰‡é™„ä»¶</span></span><br><span class="line"><span class="built_in">NSTextAttachment</span> *attach = [[<span class="built_in">NSTextAttachment</span> alloc] init];</span><br><span class="line">attach.image = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"1.jpg"</span>];</span><br><span class="line">attach.bounds = <span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">20</span>);</span><br><span class="line"><span class="built_in">NSAttributedString</span> *attachString = [<span class="built_in">NSAttributedString</span> attributedStringWithAttachment:attach];</span><br><span class="line">[string appendAttributedString:attachString];</span><br><span class="line"><span class="keyword">self</span>.textView.attributedText = string;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-27adc1a27e0637ee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å›¾æ–‡æ··æ’"></p>
<ul>
<li>æ–‡å­—åç§»<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">NSMutableAttributedString *string = [[NSMutableAttributedString alloc] <span class="string">initWithString:</span>@<span class="string">"å¾ˆå¥½ç©çš„å¯Œæ–‡æœ¬"</span>];</span><br><span class="line">[string <span class="string">addAttribute:</span>NSBaselineOffsetAttributeName <span class="string">value:</span>@(<span class="number">10</span>) <span class="string">range:</span>NSMakeRange(<span class="number">0</span>, <span class="number">1</span>)];</span><br><span class="line">[string <span class="string">addAttribute:</span>NSBaselineOffsetAttributeName <span class="string">value:</span>@(<span class="number">20</span>) <span class="string">range:</span>NSMakeRange(<span class="number">1</span>, <span class="number">1</span>)];</span><br><span class="line">[string <span class="string">addAttribute:</span>NSBaselineOffsetAttributeName <span class="string">value:</span>@(<span class="number">30</span>) <span class="string">range:</span>NSMakeRange(<span class="number">2</span>, <span class="number">1</span>)];</span><br><span class="line">[string <span class="string">addAttribute:</span>NSBaselineOffsetAttributeName <span class="string">value:</span>@(<span class="number">40</span>) <span class="string">range:</span>NSMakeRange(<span class="number">3</span>, <span class="number">1</span>)];</span><br><span class="line">[string <span class="string">addAttribute:</span>NSBaselineOffsetAttributeName <span class="string">value:</span>@(<span class="number">50</span>) <span class="string">range:</span>NSMakeRange(<span class="number">4</span>, <span class="number">3</span>)];</span><br><span class="line">self.textView.attributedText = string;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-4e0d6a0908bfb1e7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ–‡å­—åç§»"></p>
<p>ä»¥ä¸Šæ˜¯å¯¹ iOS ä¸­å¯Œæ–‡æœ¬ç›¸å…³çš„çŸ¥è¯†åšçš„ä¸€äº›æ•´ç†ï¼Œå¦‚æœæœ‰ç²—å¿ƒå†™é”™çš„åœ°æ–¹ï¼Œè¿˜è¯·æœ‹å‹ä»¬æŒ‡å‡ºï¼å¦‚æœè¿˜æœ‰é—æ¼çš„åœ°æ–¹ï¼Œä»¥åç¢°åˆ°äº†å†æ¥è¡¥å……ã€‚ã€‚ã€‚</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/iOSå¼€å‘ä¹‹ - å¤šçº¿ç¨‹/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="åˆ˜æœ‹å¤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ä»¥æ¢¦ä¸ºé©¬">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/iOSå¼€å‘ä¹‹ - å¤šçº¿ç¨‹/" itemprop="url">
                  iOSå¼€å‘ä¹‹ - å¤šçº¿ç¨‹
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://upload-images.jianshu.io/upload_images/2665449-72633919539a5942.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOSå¼€å‘ä¹‹ ï¼ å¤šçº¿ç¨‹"></p>
<blockquote>
<p>æœ€è¿‘åˆ©ç”¨æ™šä¸Šçš„ç©ºé—²æ—¶é—´ï¼Œæ•´ç†äº†ä¸€ä¸‹å¤šçº¿ç¨‹ç›¸å…³çš„çŸ¥è¯†ï¼Œå‡ ç»æ›´æ”¹ï¼Œå°±å˜æˆä½ ç°åœ¨çœ‹åˆ°çš„æ¨¡æ ·äº†ï¼ˆå¦‚æœ‰å¤±è¯¯ä¹‹å¤„ï¼Œè¿˜è¯·ä¸åèµæ•™ï¼‰ã€‚æŠŠå¤šçº¿ç¨‹ç›¸å…³çš„çŸ¥è¯†æ€»ç»“åœ¨è¿™é‡Œï¼Œåªå¸Œæœ›å¯¹çœ‹åˆ°çš„æœ‹å‹ä»¬æœ‰æ‰€å¸®åŠ©ï¼æ–‡ç« æœ‰äº›é•¿ï¼Œæ¶µç›–çš„çŸ¥è¯†ç‚¹ä¹Ÿæ¯”è¾ƒå¤šï¼Œå¸Œæœ›æœ‹å‹ä»¬èƒ½å¤Ÿè€å¿ƒè¯»å®Œå“ˆï¼æˆ‘ä»¬è¿™ç¯‡æ–‡ç« ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ¨¡å—ï¼š</p>
</blockquote>
<ul>
<li><strong>ï¼ˆä¸€ï¼‰iOSå¼€å‘ä¹‹å¤šçº¿ç¨‹ åŸºç¡€çŸ¥è¯†</strong></li>
<li><strong>ï¼ˆäºŒï¼‰iOSå¼€å‘ä¹‹å¤šçº¿ç¨‹ NSThread</strong></li>
<li><strong>ï¼ˆä¸‰ï¼‰iOSå¼€å‘ä¹‹å¤šçº¿ç¨‹ NSOperation</strong></li>
<li><strong>ï¼ˆå››ï¼‰iOSå¼€å‘ä¹‹å¤šçº¿ç¨‹ GCD</strong></li>
<li><strong>ï¼ˆäº”ï¼‰iOSå¼€å‘ä¹‹å¤šçº¿ç¨‹ çº¿ç¨‹é—´çš„é€šä¿¡</strong></li>
</ul>
<p><em>ä¸‹é¢æˆ‘ä»¬å¼€å§‹äº†è§£ iOS å¤šçº¿ç¨‹çš„åŸºç¡€çŸ¥è¯†ï¼Œå¦‚æœåœ¨æ­¤ä¹‹å‰å¯¹å¤šçº¿ç¨‹å·²ç»æœ‰æ‰€äº†è§£çš„æœ‹å‹ï¼Œå¤§å¯è·³è¿‡è¿™ä¸€éƒ¨åˆ†ï¼Œç›´æ¥çœ‹åè¾¹ä¸‰ç§å¤šçº¿ç¨‹ç¼–ç¨‹çš„ demo å³å¯ï¼</em></p>
<h2 id="ï¼ˆä¸€ï¼‰iOS-å¼€å‘ä¹‹å¤šçº¿ç¨‹-åŸºç¡€çŸ¥è¯†"><a href="#ï¼ˆä¸€ï¼‰iOS-å¼€å‘ä¹‹å¤šçº¿ç¨‹-åŸºç¡€çŸ¥è¯†" class="headerlink" title="ï¼ˆä¸€ï¼‰iOS å¼€å‘ä¹‹å¤šçº¿ç¨‹ åŸºç¡€çŸ¥è¯†"></a>ï¼ˆä¸€ï¼‰iOS å¼€å‘ä¹‹å¤šçº¿ç¨‹ åŸºç¡€çŸ¥è¯†</h2><h3 id="1-å¤šçº¿ç¨‹ç®€ä»‹"><a href="#1-å¤šçº¿ç¨‹ç®€ä»‹" class="headerlink" title="1.å¤šçº¿ç¨‹ç®€ä»‹:"></a>1.å¤šçº¿ç¨‹ç®€ä»‹:</h3><p>ä¸€ä¸ªè¿›ç¨‹è¦æƒ³æ‰§è¡Œä»»åŠ¡, å¿…é¡»å¾—æœ‰çº¿ç¨‹(æ¯ä¸ªè¿›ç¨‹è‡³å°‘è¦æœ‰ä¸€æ¡çº¿ç¨‹), çº¿ç¨‹æ˜¯è¿›ç¨‹çš„åŸºæœ¬æ‰§è¡Œå•å…ƒ, ä¸€ä¸ªè¿›ç¨‹ï¼ˆç¨‹åºï¼‰çš„æ‰€æœ‰ä»»åŠ¡éƒ½åœ¨çº¿ç¨‹ä¸­æ‰§è¡Œ.</p>
<h3 id="2-å¤šçº¿ç¨‹çš„åŸç†"><a href="#2-å¤šçº¿ç¨‹çš„åŸç†" class="headerlink" title="2.å¤šçº¿ç¨‹çš„åŸç†:"></a>2.å¤šçº¿ç¨‹çš„åŸç†:</h3><p>åŒä¸€æ—¶é—´, CPU åªèƒ½å¤„ç†ä¸€æ¡çº¿ç¨‹,åªæœ‰ä¸€æ¡çº¿ç¨‹åœ¨å·¥ä½œ.<br>å¤šçº¿ç¨‹å¹¶å‘(åŒæ—¶)æ‰§è¡Œ, å…¶å®æ˜¯ CPU å¿«é€Ÿåœ°åœ¨å¤šæ¡çº¿ç¨‹ä¹‹é—´è°ƒåº¦.<br>å¦‚æœ CPU è°ƒåº¦çº¿ç¨‹çš„æ—¶é—´è¶³å¤Ÿå¿«,å°±é€ æˆäº†å¤šçº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„å‡è±¡.</p>
<h3 id="3-å¤šçº¿ç¨‹çš„ä¼˜ç¼ºç‚¹"><a href="#3-å¤šçº¿ç¨‹çš„ä¼˜ç¼ºç‚¹" class="headerlink" title="3.å¤šçº¿ç¨‹çš„ä¼˜ç¼ºç‚¹:"></a>3.å¤šçº¿ç¨‹çš„ä¼˜ç¼ºç‚¹:</h3><h4 id="å¤šçº¿ç¨‹çš„ä¼˜ç‚¹"><a href="#å¤šçº¿ç¨‹çš„ä¼˜ç‚¹" class="headerlink" title="å¤šçº¿ç¨‹çš„ä¼˜ç‚¹:"></a>å¤šçº¿ç¨‹çš„ä¼˜ç‚¹:</h4><p>èƒ½é€‚å½“æé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡.<br>èƒ½é€‚å½“æé«˜èµ„æºåˆ©ç”¨ç‡(CPUã€å†…å­˜åˆ©ç”¨ç‡).</p>
<h4 id="å¤šçº¿ç¨‹çš„ç¼ºç‚¹"><a href="#å¤šçº¿ç¨‹çš„ç¼ºç‚¹" class="headerlink" title="å¤šçº¿ç¨‹çš„ç¼ºç‚¹:"></a>å¤šçº¿ç¨‹çš„ç¼ºç‚¹:</h4><p>å¼€å¯çº¿ç¨‹éœ€è¦å ç”¨ä¸€å®šçš„å†…å­˜ç©ºé—´(é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸»çº¿ç¨‹å ç”¨1Mï¼Œå­çº¿ç¨‹å ç”¨512KB),å¦‚æœå¼€å¯å¤§é‡çš„çº¿ç¨‹,ä¼šå ç”¨å¤§é‡çš„å†…å­˜ç©ºé—´,é™ä½ç¨‹åºçš„æ€§èƒ½.</p>
<h3 id="4-å¤šçº¿ç¨‹åœ¨-iOS-å¼€å‘ä¸­çš„åº”ç”¨"><a href="#4-å¤šçº¿ç¨‹åœ¨-iOS-å¼€å‘ä¸­çš„åº”ç”¨" class="headerlink" title="4.å¤šçº¿ç¨‹åœ¨ iOS å¼€å‘ä¸­çš„åº”ç”¨:"></a>4.å¤šçº¿ç¨‹åœ¨ iOS å¼€å‘ä¸­çš„åº”ç”¨:</h3><p>ä¸»çº¿ç¨‹:ä¸€ä¸ª iOS ç¨‹åºè¿è¡Œåï¼Œé»˜è®¤ä¼šå¼€å¯1æ¡çº¿ç¨‹ï¼Œç§°ä¸ºâ€œä¸»çº¿ç¨‹â€æˆ–â€œ UI çº¿ç¨‹â€.<br>ä¸»çº¿ç¨‹çš„ä¸»è¦ä½œç”¨:åˆ·æ–° UI ç•Œé¢ã€å¤„ç† UI äº‹ä»¶(æ¯”å¦‚ç‚¹å‡»äº‹ä»¶ã€æ»šåŠ¨äº‹ä»¶ã€æ‹–æ‹½äº‹ä»¶ç­‰).</p>
<h3 id="5-iOS-ä¸­ä¸‰ç§å¤šçº¿ç¨‹ç¼–ç¨‹çš„æŠ€æœ¯ï¼Œåˆ†åˆ«æ˜¯ï¼š"><a href="#5-iOS-ä¸­ä¸‰ç§å¤šçº¿ç¨‹ç¼–ç¨‹çš„æŠ€æœ¯ï¼Œåˆ†åˆ«æ˜¯ï¼š" class="headerlink" title="5.iOS ä¸­ä¸‰ç§å¤šçº¿ç¨‹ç¼–ç¨‹çš„æŠ€æœ¯ï¼Œåˆ†åˆ«æ˜¯ï¼š"></a>5.iOS ä¸­ä¸‰ç§å¤šçº¿ç¨‹ç¼–ç¨‹çš„æŠ€æœ¯ï¼Œåˆ†åˆ«æ˜¯ï¼š</h3><h4 id="ï¼ˆä¸€ï¼‰NSThread"><a href="#ï¼ˆä¸€ï¼‰NSThread" class="headerlink" title="ï¼ˆä¸€ï¼‰NSThread"></a>ï¼ˆä¸€ï¼‰NSThread</h4><h4 id="ï¼ˆäºŒï¼‰Cocoa-NSOperation"><a href="#ï¼ˆäºŒï¼‰Cocoa-NSOperation" class="headerlink" title="ï¼ˆäºŒï¼‰Cocoa NSOperation"></a>ï¼ˆäºŒï¼‰Cocoa NSOperation</h4><h4 id="ï¼ˆä¸‰ï¼‰GCDï¼ˆå…¨ç§°ï¼šGrand-Central-Dispatchï¼‰"><a href="#ï¼ˆä¸‰ï¼‰GCDï¼ˆå…¨ç§°ï¼šGrand-Central-Dispatchï¼‰" class="headerlink" title="ï¼ˆä¸‰ï¼‰GCDï¼ˆå…¨ç§°ï¼šGrand Central Dispatchï¼‰"></a>ï¼ˆä¸‰ï¼‰GCDï¼ˆå…¨ç§°ï¼šGrand Central Dispatchï¼‰</h4><p>è¿™ä¸‰ç§ç¼–ç¨‹æ–¹å¼ä»ä¸Šåˆ°ä¸‹ï¼ŒæŠ½è±¡åº¦å±‚æ¬¡æ˜¯ä»ä½åˆ°é«˜çš„ï¼ŒæŠ½è±¡åº¦è¶Šé«˜çš„ä½¿ç”¨è¶Šç®€å•ï¼Œä¹Ÿæ˜¯Appleæœ€æ¨èä½¿ç”¨çš„ã€‚</p>
<h4 id="ä¸‰ç§æ–¹å¼çš„ä¼˜ç¼ºç‚¹ä»‹ç»ï¼š"><a href="#ä¸‰ç§æ–¹å¼çš„ä¼˜ç¼ºç‚¹ä»‹ç»ï¼š" class="headerlink" title="ä¸‰ç§æ–¹å¼çš„ä¼˜ç¼ºç‚¹ä»‹ç»ï¼š"></a>ä¸‰ç§æ–¹å¼çš„ä¼˜ç¼ºç‚¹ä»‹ç»ï¼š</h4><h5 id="NSThread"><a href="#NSThread" class="headerlink" title="NSThread:"></a>NSThread:</h5><p>ä¼˜ç‚¹ï¼šNSThread æ¯”å…¶ä»–ä¸¤ä¸ªè½»é‡çº§<br>ç¼ºç‚¹ï¼šéœ€è¦è‡ªå·±ç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼Œçº¿ç¨‹åŒæ­¥ã€‚çº¿ç¨‹åŒæ­¥å¯¹æ•°æ®çš„åŠ é”ä¼šæœ‰ä¸€å®šçš„ç³»ç»Ÿå¼€é”€ã€‚</p>
<h5 id="Cocoa-NSOperation"><a href="#Cocoa-NSOperation" class="headerlink" title="Cocoa NSOperation"></a>Cocoa NSOperation</h5><p>ä¼˜ç‚¹ï¼šä¸éœ€è¦å…³å¿ƒçº¿ç¨‹ç®¡ç†ï¼Œæ•°æ®åŒæ­¥çš„äº‹æƒ…ï¼Œå¯ä»¥æŠŠç²¾åŠ›æ”¾åœ¨è‡ªå·±éœ€è¦æ‰§è¡Œçš„æ“ä½œä¸Šã€‚<br>Cocoa operation ç›¸å…³çš„ç±»æ˜¯ NSOperation ï¼ŒNSOperationQueueã€‚<br>NSOperationæ˜¯ä¸ªæŠ½è±¡ç±»ï¼Œä½¿ç”¨å®ƒå¿…é¡»ç”¨å®ƒçš„å­ç±»ï¼Œå¯ä»¥å®ç°å®ƒæˆ–è€…ä½¿ç”¨å®ƒå®šä¹‰å¥½çš„ä¸¤ä¸ªå­ç±»ï¼šNSInvocationOperation å’Œ NSBlockOperationã€‚<br>åˆ›å»ºNSOperationå­ç±»çš„å¯¹è±¡ï¼ŒæŠŠå¯¹è±¡æ·»åŠ åˆ°NSOperationQueueé˜Ÿåˆ—é‡Œæ‰§è¡Œã€‚</p>
<h5 id="GCD"><a href="#GCD" class="headerlink" title="GCD"></a>GCD</h5><p>Grand Central Dispatch (GCD)æ˜¯Appleå¼€å‘çš„ä¸€ä¸ªå¤šæ ¸ç¼–ç¨‹çš„è§£å†³æ–¹æ³•ã€‚åœ¨iOS4.0å¼€å§‹ä¹‹åæ‰èƒ½ä½¿ç”¨ã€‚GCDæ˜¯ä¸€ä¸ªæ›¿ä»£è¯¸å¦‚NSThread, NSOperationQueue, NSInvocationOperationç­‰æŠ€æœ¯çš„å¾ˆé«˜æ•ˆå’Œå¼ºå¤§çš„æŠ€æœ¯ã€‚</p>
<hr>
<p><em>å¯¹ iOS åŸºç¡€çŸ¥è¯†æœ‰äº†ä¸€å®šäº†è§£ä¹‹åï¼Œä¸‹è¾¹æˆ‘ä»¬å¼€å§‹çœ‹å¤šçº¿ç¨‹ç›¸å…³çš„ä¸€äº› demoï¼Œ å»ºè®®æœ‹å‹ä»¬è¯•è¯•ä¸‹è¾¹çš„ demoï¼Œè¿™æ ·æ›´æ–¹ä¾¿ç†è§£ï¼å¦‚æœ‰ç–‘é—®ï¼Œæˆ–å‘ç°æŸäº› demo å†™çš„æœ‰è¯¯ï¼Œè¿˜è¯·æœ‹å‹ä»¬å‘ŠçŸ¥ï¼</em></p>
<p><strong>ä¸‹è¾¹æˆ‘ä»¬å¼€å§‹äº†è§£NSThreadï¼ŒNSThread å…¶å®ç”¨çš„çœŸä¸å¤šï¼Œä¸»è¦è¿˜æ˜¯ç”¨å¦å¤–ä¸¤ç§ï¼Œä¸è¿‡ä½œä¸º iOS å¼€å‘è€…ï¼Œè¿˜æ˜¯åº”è¯¥å¯¹å®ƒæœ‰äº›äº†è§£çš„ï¼Œä¸‹è¾¹æ˜¯ NSThread ç›¸å…³çš„ demo ï¼</strong></p>
<h2 id="ï¼ˆäºŒï¼‰iOS-å¼€å‘ä¹‹å¤šçº¿ç¨‹-NSThread"><a href="#ï¼ˆäºŒï¼‰iOS-å¼€å‘ä¹‹å¤šçº¿ç¨‹-NSThread" class="headerlink" title="ï¼ˆäºŒï¼‰iOS å¼€å‘ä¹‹å¤šçº¿ç¨‹ NSThread"></a>ï¼ˆäºŒï¼‰iOS å¼€å‘ä¹‹å¤šçº¿ç¨‹ NSThread</h2><h3 id="ä¸€ã€NSThread-åˆå§‹åŒ–"><a href="#ä¸€ã€NSThread-åˆå§‹åŒ–" class="headerlink" title="ä¸€ã€NSThread åˆå§‹åŒ–"></a>ä¸€ã€NSThread åˆå§‹åŒ–</h3><h4 id="1-åŠ¨æ€æ–¹æ³•"><a href="#1-åŠ¨æ€æ–¹æ³•" class="headerlink" title="1.åŠ¨æ€æ–¹æ³•"></a>1.åŠ¨æ€æ–¹æ³•</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">id</span>)initWithTarget:(<span class="keyword">id</span>)target selector:(SEL)selector object:(<span class="keyword">id</span>)argument</span><br><span class="line"><span class="comment">// åˆå§‹åŒ–çº¿ç¨‹</span></span><br><span class="line"><span class="built_in">NSThread</span>* thread = [[<span class="built_in">NSThread</span> alloc] initWithTarget:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(doSomething:)object:<span class="literal">nil</span>];</span><br><span class="line"><span class="comment">// çº¿ç¨‹åå­—</span></span><br><span class="line">thread.name = <span class="string">@"MYThread"</span>;</span><br><span class="line"><span class="comment">// å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line">[thread start];</span><br></pre></td></tr></table></figure>
<h4 id="2-é™æ€æ–¹æ³•"><a href="#2-é™æ€æ–¹æ³•" class="headerlink" title="2.é™æ€æ–¹æ³•"></a>2.é™æ€æ–¹æ³•</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">void</span>)detachNewThreadSelector:(SEL)aSelector toTarget:(<span class="keyword">id</span>)aTarget withObject:(<span class="keyword">id</span>)anArgument</span><br><span class="line">[<span class="built_in">NSThread</span> detachNewThreadSelector:<span class="keyword">@selector</span>(doSomething:) toTarget:<span class="keyword">self</span> withObject:<span class="literal">nil</span>];</span><br><span class="line"><span class="comment">// è°ƒç”¨å®Œæ¯•åï¼Œä¼šé©¬ä¸Šåˆ›å»ºå¹¶å¼€å¯æ–°çº¿ç¨‹</span></span><br></pre></td></tr></table></figure>
<h4 id="3-éšå¼åˆ›å»ºçº¿ç¨‹çš„æ–¹æ³•ï¼š"><a href="#3-éšå¼åˆ›å»ºçº¿ç¨‹çš„æ–¹æ³•ï¼š" class="headerlink" title="3.éšå¼åˆ›å»ºçº¿ç¨‹çš„æ–¹æ³•ï¼š"></a>3.éšå¼åˆ›å»ºçº¿ç¨‹çš„æ–¹æ³•ï¼š</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)performSelectorInBackground:(SEL)aSelector withObject:(<span class="keyword">id</span>)arg;</span><br><span class="line">[<span class="keyword">self</span> performSelectorInBackground:<span class="keyword">@selector</span>(run) withObject:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure>
<p><strong>æç¤ºæœ‹å‹ä»¬ä¸€ä¸‹:ç¬¬ä¸€ç§æ–¹å¼ä¼šç›´æ¥åˆ›å»ºçº¿ç¨‹å¹¶ä¸”å¼€å§‹è¿è¡Œçº¿ç¨‹ï¼Œç¬¬äºŒç§æ–¹å¼æ˜¯å…ˆåˆ›å»ºçº¿ç¨‹å¯¹è±¡ï¼Œç„¶åå†è¿è¡Œçº¿ç¨‹æ“ä½œï¼Œåœ¨è¿è¡Œçº¿ç¨‹æ“ä½œå‰å¯ä»¥è®¾ç½®çº¿ç¨‹çš„ä¼˜å…ˆçº§ç­‰çº¿ç¨‹ä¿¡æ¯</strong></p>
<h3 id="äºŒã€çº¿ç¨‹é—´çš„é€šä¿¡"><a href="#äºŒã€çº¿ç¨‹é—´çš„é€šä¿¡" class="headerlink" title="äºŒã€çº¿ç¨‹é—´çš„é€šä¿¡"></a>äºŒã€çº¿ç¨‹é—´çš„é€šä¿¡</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œæ“ä½œ</span></span><br><span class="line">[<span class="keyword">self</span> performSelectorOnMainThread:<span class="keyword">@selector</span>(run) withObject:<span class="literal">nil</span> waitUntilDone:<span class="literal">YES</span>];</span><br><span class="line"><span class="comment">//åœ¨å½“å‰çº¿ç¨‹æ‰§è¡Œæ“ä½œ</span></span><br><span class="line">[<span class="keyword">self</span> performSelector:<span class="keyword">@selector</span>(run) withObject:<span class="literal">nil</span>];</span><br><span class="line"><span class="comment">//åœ¨æŒ‡å®šçº¿ç¨‹ä¸Šæ‰§è¡Œæ“ä½œ</span></span><br><span class="line">[<span class="keyword">self</span> performSelector:<span class="keyword">@selector</span>(run) onThread:thread withObject:<span class="literal">nil</span> waitUntilDone:<span class="literal">YES</span>];</span><br></pre></td></tr></table></figure>
<h3 id="ä¸‰ã€ä¸€äº›ç®€å•æ–¹æ³•"><a href="#ä¸‰ã€ä¸€äº›ç®€å•æ–¹æ³•" class="headerlink" title="ä¸‰ã€ä¸€äº›ç®€å•æ–¹æ³•"></a>ä¸‰ã€ä¸€äº›ç®€å•æ–¹æ³•</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è·å–å½“å‰çº¿ç¨‹</span></span><br><span class="line"><span class="built_in">NSThread</span> *thread = [<span class="built_in">NSThread</span> currentThread];</span><br><span class="line"><span class="comment">//è·å–ä¸»çº¿ç¨‹</span></span><br><span class="line"><span class="built_in">NSThread</span> *main = [<span class="built_in">NSThread</span> mainThread];</span><br><span class="line"><span class="comment">//ç¡çœ ï¼Œç›¸å½“äºæš‚åœ</span></span><br><span class="line">[<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">3</span>];</span><br></pre></td></tr></table></figure>
<hr>
<p><em>NSThread  å°±è¯´åˆ°è¿™ï¼Œä¸€èµ·å†çœ‹ä¸‹NSOperationï¼Œ NSOperation åœ¨å¼€å‘ä¸­ç”¨çš„è¿˜æ˜¯æŒºå¤šçš„ï¼Œè™½ç„¶è‹¹æœå»ºè®®ä½¿ç”¨ GCD ï¼Œä½†ä¾ç„¶æœ‰å¼€å‘è€…è§‰å¾— NSOperation  æ¯” GCD æ›´å¥½ç”¨ï¼ä»è€…è§ä»æ™ºè€…è§æ™ºå§ï¼æœ¬å°ç™½è§‰å¾—å¦‚æœèƒ½æŒæ¡è¿˜æ˜¯éƒ½æŒæ¡çš„å¥½ï¼</em></p>
<h2 id="ï¼ˆä¸‰ï¼‰iOSå¼€å‘ä¹‹å¤šçº¿ç¨‹-NSOperation"><a href="#ï¼ˆä¸‰ï¼‰iOSå¼€å‘ä¹‹å¤šçº¿ç¨‹-NSOperation" class="headerlink" title="ï¼ˆä¸‰ï¼‰iOSå¼€å‘ä¹‹å¤šçº¿ç¨‹ NSOperation"></a>ï¼ˆä¸‰ï¼‰iOSå¼€å‘ä¹‹å¤šçº¿ç¨‹ NSOperation</h2><h3 id="ä¸€ã€åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼"><a href="#ä¸€ã€åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼" class="headerlink" title="ä¸€ã€åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼"></a>ä¸€ã€åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼</h3><p>ä½¿ç”¨NSOperationåˆ›å»ºçº¿ç¨‹çš„æ–¹å¼æœ‰3ç§:</p>
<p>ï¼ˆ1ï¼‰NSInvocationOperation æ–¹å¼<br>ï¼ˆ2ï¼‰NSBlockOperation æ–¹å¼<br>ï¼ˆ3ï¼‰è‡ªå®šä¹‰å­ç±»ç»§æ‰¿NSOperation,å®ç°å†…éƒ¨ç›¸åº”çš„â½…æ³•</p>
<p>ä¸‹é¢æ˜¯è¿™ä¸‰ç§æ–¹å¼åˆ›å»ºçº¿ç¨‹çš„å…·ä½“æ–¹æ³•ï¼š</p>
<h4 id="1-NSInvocationOperation"><a href="#1-NSInvocationOperation" class="headerlink" title="1.NSInvocationOperation"></a>1.NSInvocationOperation</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)invocationOperation</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//åˆ›å»ºNSInvocationOperationå¯¹è±¡</span></span><br><span class="line"><span class="built_in">NSInvocationOperation</span> *operation = [[<span class="built_in">NSInvocationOperation</span> alloc] initWithTarget:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(run) object:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¼€å§‹æ‰§è¡Œæ“ä½œ</span></span><br><span class="line">[operation start];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä¸€æ—¦æ‰§è¡Œæ“ä½œ,å°±ä¼šè°ƒç”¨targetçš„runæ–¹æ³•</span></span><br></pre></td></tr></table></figure>
<p>æç¤º:é»˜è®¤æƒ…å†µä¸‹,è°ƒç”¨äº†startæ–¹æ³•åå¹¶ä¸ä¼šå¼€ä¸€æ¡æ–°çº¿ç¨‹å»æ‰§è¡Œæ“ä½œ,åªæœ‰å°†NSOperationæ”¾åˆ°ä¸€ä¸ªNSOperationQueueä¸­,æ‰ä¼šå¼‚æ­¥æ‰§è¡Œæ“ä½œ.</p>
<h4 id="2-NSBlockOperation"><a href="#2-NSBlockOperation" class="headerlink" title="2.NSBlockOperation"></a>2.NSBlockOperation</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)blockOperation</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//åˆ›å»ºNSBlockOperationå¯¹è±¡</span></span><br><span class="line"><span class="built_in">NSBlockOperation</span> *operation = [<span class="built_in">NSBlockOperation</span> blockOperationWithBlock:^&#123;</span><br><span class="line"><span class="comment">// ä¸»çº¿ç¨‹</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"1---%@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;];</span><br><span class="line"><span class="comment">// æ·»åŠ ä»»åŠ¡(åœ¨å­çº¿ç¨‹æ‰§è¡Œ)</span></span><br><span class="line">[operation addExecutionBlock:^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"2---%@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;];</span><br><span class="line">[operation addExecutionBlock:^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"3---%@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;];</span><br><span class="line"><span class="comment">//å¼€å¯æ‰§è¡Œæ“ä½œ</span></span><br><span class="line">[operation start];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æç¤º:åªè¦NSBlockOperationå°è£…çš„æ“ä½œæ•° &gt; 1,å°±ä¼šå¼‚æ­¥æ‰§è¡Œæ“ä½œ</p>
<h4 id="3-è‡ªå®šä¹‰å­ç±»ç»§æ‰¿è‡ªNSOperation"><a href="#3-è‡ªå®šä¹‰å­ç±»ç»§æ‰¿è‡ªNSOperation" class="headerlink" title="3.è‡ªå®šä¹‰å­ç±»ç»§æ‰¿è‡ªNSOperation"></a>3.è‡ªå®šä¹‰å­ç±»ç»§æ‰¿è‡ªNSOperation</h4><p>è‡ªå®šä¹‰NSOperationå­ç±»éœ€è¦é‡å†™ - (void)mainæ–¹æ³•</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)main</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// æ–°å»ºä¸€ä¸ªè‡ªåŠ¨é‡Šæ”¾æ± ï¼Œå¦‚æœæ˜¯å¼‚æ­¥æ‰§è¡Œæ“ä½œï¼Œé‚£ä¹ˆå°†æ— æ³•è®¿é—®åˆ°ä¸»çº¿ç¨‹çš„è‡ªåŠ¨é‡Šæ”¾æ± </span></span><br><span class="line"><span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i&lt;<span class="number">100</span>; i++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"1 - %ld - %@"</span>, i, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ£€æµ‹æ“ä½œæ˜¯å¦è¢«å–æ¶ˆ,å¯¹å–æ¶ˆåšå‡ºå“åº”</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.isCancelled) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i&lt;<span class="number">100</span>; i++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"2 - %ld - %@"</span>, i, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.isCancelled) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i&lt;<span class="number">100</span>; i++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"3 - %ld - %@"</span>, i, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.isCancelled) <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="äºŒã€NSOperationQueueçš„åº”ç”¨"><a href="#äºŒã€NSOperationQueueçš„åº”ç”¨" class="headerlink" title="äºŒã€NSOperationQueueçš„åº”ç”¨"></a>äºŒã€NSOperationQueueçš„åº”ç”¨</h3><p>ä¸€ä¸ªNSOperationå¯¹è±¡å¯ä»¥é€šè¿‡è°ƒç”¨startæ–¹æ³•æ¥æ‰§è¡Œä»»åŠ¡,é»˜è®¤æ˜¯åŒæ­¥æ‰§è¡Œçš„.ä¹Ÿå¯ä»¥å°†NSOperationæ·»åŠ åˆ°ä¸€ä¸ªNSOperationQueueä¸­å»æ‰§è¡Œ,è€Œä¸”æ˜¯å¼‚æ­¥æ‰§è¡Œçš„.</p>
<h4 id="1-NSOperationQueueç®€å•åˆ›å»º"><a href="#1-NSOperationQueueç®€å•åˆ›å»º" class="headerlink" title="1.NSOperationQueueç®€å•åˆ›å»º"></a>1.NSOperationQueueç®€å•åˆ›å»º</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç¬¬ä¸€ç§æ–¹å¼</span></span><br><span class="line">- (<span class="keyword">void</span>)operationQueue</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// åˆ›å»ºNSOperationQueueé˜Ÿåˆ—</span></span><br><span class="line"><span class="built_in">NSOperationQueue</span> *queue = [[<span class="built_in">NSOperationQueue</span> alloc] init];</span><br><span class="line"><span class="comment">// åˆ›å»ºNSInvocationOperationå¯¹è±¡</span></span><br><span class="line"><span class="built_in">NSInvocationOperation</span> *operation1 = [[<span class="built_in">NSInvocationOperation</span> alloc] initWithTarget:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(run1) object:<span class="literal">nil</span>];</span><br><span class="line"><span class="built_in">NSInvocationOperation</span> *operation2 = [[<span class="built_in">NSInvocationOperation</span> alloc] initWithTarget:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(run2) object:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºNSBlockOperationå¯¹è±¡</span></span><br><span class="line"><span class="built_in">NSBlockOperation</span> *operation3 = [<span class="built_in">NSBlockOperation</span> blockOperationWithBlock:^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"1 --- %@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;];</span><br><span class="line">[operation3 addExecutionBlock:^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"2 --- %@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;];</span><br><span class="line"><span class="built_in">NSBlockOperation</span> *operation4 = [<span class="built_in">NSBlockOperation</span> blockOperationWithBlock:^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"3 --- %@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;];</span><br><span class="line"><span class="comment">// æ·»åŠ ä»»åŠ¡åˆ°é˜Ÿåˆ—ä¸­</span></span><br><span class="line">[queue addOperation:operation1];</span><br><span class="line">[queue addOperation:operation2];</span><br><span class="line">[queue addOperation:operation3];</span><br><span class="line">[queue addOperation:operation4];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬äºŒç§æ–¹å¼</span></span><br><span class="line">- (<span class="keyword">void</span>)operationQueue2</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// åˆ›å»ºNSOperationQueueé˜Ÿåˆ—</span></span><br><span class="line"><span class="built_in">NSOperationQueue</span> *queue = [[<span class="built_in">NSOperationQueue</span> alloc] init];</span><br><span class="line">[queue addOperationWithBlock:^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"1 --- %@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;];</span><br><span class="line">[queue addOperationWithBlock:^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"2 --- %@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-NSOperationä¸­çš„æ“ä½œä¾èµ–"><a href="#2-NSOperationä¸­çš„æ“ä½œä¾èµ–" class="headerlink" title="2.NSOperationä¸­çš„æ“ä½œä¾èµ–"></a>2.NSOperationä¸­çš„æ“ä½œä¾èµ–</h4><p>NSOperationä¹‹é—´å¯ä»¥è®¾ç½®ä¾èµ–æ¥ä¿è¯æ‰§è¡Œé¡ºåº,æ¯”å¦‚ä¸€å®šè¦è®©æ“ä½œAæ‰§è¡Œå®Œå,æ‰èƒ½æ‰§è¡Œæ“ä½œB,å¯ä»¥è¿™ä¹ˆå†™[operationB addDependency:operationA]; // æ“ä½œBä¾èµ–äºæ“ä½œoperationA,å¦å¤–,é€šè¿‡removeDependencyæ–¹æ³•å¯ä»¥åˆ é™¤ä¾èµ–å¯¹è±¡.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#pragma mark - ä¾èµ–æ“ä½œè°ƒæ•´æ‰§è¡Œé¡ºåº</span></span><br><span class="line">- (<span class="keyword">void</span>)<span class="built_in">NSOperationTest1</span> &#123;</span><br><span class="line"><span class="built_in">NSOperationQueue</span> *queue = [[<span class="built_in">NSOperationQueue</span> alloc] init];</span><br><span class="line"><span class="built_in">NSBlockOperation</span> *op1 = [<span class="built_in">NSBlockOperation</span> blockOperationWithBlock:^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"~~1~~%@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;];</span><br><span class="line"><span class="built_in">NSBlockOperation</span> *op2 = [<span class="built_in">NSBlockOperation</span> blockOperationWithBlock:^&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"~~2~~%@~~%d~~"</span>, [<span class="built_in">NSThread</span> currentThread], i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;];</span><br><span class="line"><span class="built_in">NSBlockOperation</span> *op3 = [<span class="built_in">NSBlockOperation</span> blockOperationWithBlock:^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"~~3~~%@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;];</span><br><span class="line">[op2 addExecutionBlock:^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"~~4~~%@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;];</span><br><span class="line">op3.completionBlock = ^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"~~5~~%@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// è®¾ç½®ä¾èµ–</span></span><br><span class="line">[op1 addDependency:op2];</span><br><span class="line">[op1 addDependency:op3];</span><br><span class="line">[queue addOperation:op1];</span><br><span class="line">[queue addOperation:op2];</span><br><span class="line">[queue addOperation:op3];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-çº¿ç¨‹é—´çš„é€šä¿¡"><a href="#3-çº¿ç¨‹é—´çš„é€šä¿¡" class="headerlink" title="3.çº¿ç¨‹é—´çš„é€šä¿¡"></a>3.çº¿ç¨‹é—´çš„é€šä¿¡</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#pragma mark - NSOperationå®ç°çº¿ç¨‹é—´çš„é€šä¿¡</span></span><br><span class="line">- (<span class="keyword">void</span>)<span class="built_in">NSOperationTest2</span> &#123;</span><br><span class="line">[[[<span class="built_in">NSOperationQueue</span> alloc] init] addOperationWithBlock:^&#123;</span><br><span class="line"><span class="built_in">NSData</span> *data = [<span class="built_in">NSData</span> dataWithContentsOfURL:[<span class="built_in">NSURL</span> URLWithString:<span class="string">@"http://img.lanrentuku.com/img/allimg/1310/13822295641903.jpg"</span>]];</span><br><span class="line"></span><br><span class="line"><span class="built_in">UIImage</span> *image = [<span class="built_in">UIImage</span> imageWithData:data];</span><br><span class="line"></span><br><span class="line">[[<span class="built_in">NSOperationQueue</span> mainQueue] addOperationWithBlock:^&#123;</span><br><span class="line"><span class="keyword">self</span>.imageview.image = image;</span><br><span class="line">&#125;];</span><br><span class="line">&#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä¸‰ã€ä¸€äº›ç®€å•æ–¹æ³•-1"><a href="#ä¸‰ã€ä¸€äº›ç®€å•æ–¹æ³•-1" class="headerlink" title="ä¸‰ã€ä¸€äº›ç®€å•æ–¹æ³•"></a>ä¸‰ã€ä¸€äº›ç®€å•æ–¹æ³•</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å–æ¶ˆå•ä¸ªæ“ä½œ</span></span><br><span class="line">[operation cancel];</span><br><span class="line"><span class="comment">// å–æ¶ˆqueueä¸­æ‰€æœ‰çš„æ“ä½œ</span></span><br><span class="line">[queue cancelAllOperations];</span><br><span class="line"><span class="comment">//è®¾ç½®é˜Ÿåˆ—çš„æœ€å¤§å¹¶å‘æ“ä½œæ•°é‡</span></span><br><span class="line">queue.maxConcurrentOperationCount = <span class="number">1</span>;</span><br><span class="line"><span class="comment">// ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œç­‰åˆ°æŸä¸ªoperationæ‰§è¡Œå®Œæ¯•</span></span><br><span class="line">[operation waitUntilFinished];</span><br><span class="line"><span class="comment">// é˜»å¡å½“å‰çº¿ç¨‹ï¼Œç­‰å¾…queueçš„æ‰€æœ‰æ“ä½œæ‰§è¡Œå®Œæ¯•</span></span><br><span class="line">[queue waitUntilAllOperationsAreFinished];</span><br><span class="line"><span class="comment">// æš‚åœqueue YESä»£è¡¨æš‚åœé˜Ÿåˆ—,NOä»£è¡¨æ¢å¤é˜Ÿåˆ—</span></span><br><span class="line">[queue setSuspended:<span class="literal">YES</span>];</span><br></pre></td></tr></table></figure>
<hr>
<p><em>NSOperation å¸¸ç”¨çš„åŸºæœ¬ä¸Šä¹Ÿå°±ä¸Šé¢é‚£äº›äº†ã€‚ã€‚ã€‚GCD å°±ä¸ç”¨å¤šè¯´äº†ï¼Œè€ä¸œå®¶è‹¹æœæ¨èçš„ï¼Œä¸è¿‡æˆ‘å´è§‰å¾—åå­—å¤ªé•¿~~~ï¼Œä¸€å¼€å§‹æ€»æ˜¯è®°ä¸ä½ï¼Œå¤šæ•²å°±å¥½äº†ï¼æ‰€æœ‰ç¼–ç¨‹è¯­è¨€å¤§æ¦‚éƒ½æœ‰è¿™ä¹ˆä¸€ä¸ªç»æ‹›O(âˆ©_âˆ©)Oï¼</em></p>
<h2 id="ï¼ˆå››ï¼‰iOSå¼€å‘ä¹‹å¤šçº¿ç¨‹-GCD"><a href="#ï¼ˆå››ï¼‰iOSå¼€å‘ä¹‹å¤šçº¿ç¨‹-GCD" class="headerlink" title="ï¼ˆå››ï¼‰iOSå¼€å‘ä¹‹å¤šçº¿ç¨‹ GCD"></a>ï¼ˆå››ï¼‰iOSå¼€å‘ä¹‹å¤šçº¿ç¨‹ GCD</h2><h3 id="ä¸€ã€GCD-æœ¯è¯­"><a href="#ä¸€ã€GCD-æœ¯è¯­" class="headerlink" title="ä¸€ã€GCD æœ¯è¯­"></a>ä¸€ã€GCD æœ¯è¯­</h3><p>è¦ç†è§£GCD ï¼Œæˆ‘ä»¬å…ˆæ¥ç†Ÿæ‚‰ä¸çº¿ç¨‹å’Œå¹¶å‘ç›¸å…³çš„å‡ ä¸ªæ¦‚å¿µã€‚</p>
<h4 id="1-Serial-vs-Concurrent-ä¸²è¡Œ-vs-å¹¶å‘"><a href="#1-Serial-vs-Concurrent-ä¸²è¡Œ-vs-å¹¶å‘" class="headerlink" title="1.Serial vs. Concurrent ä¸²è¡Œ vs. å¹¶å‘"></a>1.Serial vs. Concurrent ä¸²è¡Œ vs. å¹¶å‘</h4><p>ä»»åŠ¡ä¸²è¡Œæ‰§è¡Œå°±æ˜¯æ¯æ¬¡åªæœ‰ä¸€ä¸ªä»»åŠ¡è¢«æ‰§è¡Œï¼Œä»»åŠ¡å¹¶å‘æ‰§è¡Œå°±æ˜¯åœ¨åŒä¸€æ—¶é—´å¯ä»¥æœ‰å¤šä¸ªä»»åŠ¡è¢«æ‰§è¡Œã€‚</p>
<h4 id="2-åŒæ­¥ï¼ˆSynchronousï¼‰ä¸å¼‚æ­¥ï¼ˆAsynchronousï¼‰"><a href="#2-åŒæ­¥ï¼ˆSynchronousï¼‰ä¸å¼‚æ­¥ï¼ˆAsynchronousï¼‰" class="headerlink" title="2.åŒæ­¥ï¼ˆSynchronousï¼‰ä¸å¼‚æ­¥ï¼ˆAsynchronousï¼‰"></a>2.åŒæ­¥ï¼ˆSynchronousï¼‰ä¸å¼‚æ­¥ï¼ˆAsynchronousï¼‰</h4><p>åŒæ­¥ï¼Œæ„å‘³ç€åœ¨å½“å‰çº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡ï¼Œä¸å…·å¤‡å¼€å¯æ–°çš„çº¿ç¨‹çš„èƒ½åŠ›ã€‚<br>å¼‚æ­¥ï¼Œåœ¨æ–°çš„çº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡ï¼Œå…·å¤‡å¼€å¯æ–°çš„çº¿ç¨‹çš„èƒ½åŠ›ã€‚</p>
<h4 id="3-ä¸´ç•ŒåŒºï¼ˆCritical-Sectionï¼‰"><a href="#3-ä¸´ç•ŒåŒºï¼ˆCritical-Sectionï¼‰" class="headerlink" title="3.ä¸´ç•ŒåŒºï¼ˆCritical Sectionï¼‰"></a>3.ä¸´ç•ŒåŒºï¼ˆCritical Sectionï¼‰</h4><p>å°±æ˜¯ä¸€æ®µä»£ç ä¸èƒ½è¢«å¹¶å‘æ‰§è¡Œï¼Œå³ä¸¤ä¸ªçº¿ç¨‹ä¸èƒ½åŒæ—¶æ‰§è¡Œè¿™æ®µä»£ç ã€‚</p>
<h4 id="4-æ­»é”ï¼ˆDeadlockï¼‰"><a href="#4-æ­»é”ï¼ˆDeadlockï¼‰" class="headerlink" title="4.æ­»é”ï¼ˆDeadlockï¼‰"></a>4.æ­»é”ï¼ˆDeadlockï¼‰</h4><p>åœæ­¢ç­‰å¾…äº‹æƒ…çš„çº¿ç¨‹ä¼šå¯¼è‡´å¤šä¸ªçº¿ç¨‹ç›¸äº’ç»´æŒç­‰å¾…ï¼Œå³æ­»é”ã€‚</p>
<h4 id="5-Thread-Safe-çº¿ç¨‹å®‰å…¨"><a href="#5-Thread-Safe-çº¿ç¨‹å®‰å…¨" class="headerlink" title="5.Thread Safe çº¿ç¨‹å®‰å…¨"></a>5.Thread Safe çº¿ç¨‹å®‰å…¨</h4><p>çº¿ç¨‹å®‰å…¨çš„ä»£ç èƒ½åœ¨å¤šçº¿ç¨‹æˆ–å¹¶å‘ä»»åŠ¡ä¸­è¢«å®‰å…¨çš„è°ƒç”¨ï¼Œè€Œä¸ä¼šå¯¼è‡´ä»»ä½•é—®é¢˜ï¼ˆæ•°æ®æŸåï¼Œå´©æºƒç­‰ï¼‰ã€‚</p>
<h4 id="6-Queues-é˜Ÿåˆ—"><a href="#6-Queues-é˜Ÿåˆ—" class="headerlink" title="6.Queues é˜Ÿåˆ—"></a>6.Queues é˜Ÿåˆ—</h4><p>GCD æä¾›æœ‰ dispatch queues æ¥å¤„ç†ä»£ç å—ï¼Œè¿™äº›é˜Ÿåˆ—ç®¡ç†ä½ æä¾›ç»™ GCD çš„ä»»åŠ¡å¹¶ç”¨ FIFO é¡ºåºæ‰§è¡Œè¿™äº›ä»»åŠ¡ã€‚</p>
<h3 id="äºŒã€ä»£ç æ¼”ç¤º"><a href="#äºŒã€ä»£ç æ¼”ç¤º" class="headerlink" title="äºŒã€ä»£ç æ¼”ç¤º"></a>äºŒã€ä»£ç æ¼”ç¤º</h3><h3 id="1ã€dispatch-async-å¼‚æ­¥å‡½æ•°"><a href="#1ã€dispatch-async-å¼‚æ­¥å‡½æ•°" class="headerlink" title="1ã€dispatch_async(å¼‚æ­¥å‡½æ•°)"></a>1ã€dispatch_async(å¼‚æ­¥å‡½æ•°)</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¼‚æ­¥å‡½æ•° + å¹¶å‘é˜Ÿåˆ—:å¯ä»¥åŒæ—¶å¼€å¯å¤šæ¡çº¿ç¨‹,ä»»åŠ¡æ˜¯å¹¶è¡Œçš„</span></span><br><span class="line"><span class="comment">// 1.åˆ›å»ºå¹¶å‘é˜Ÿåˆ—</span></span><br><span class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>);</span><br><span class="line"><span class="comment">//2.å°†ä»»åŠ¡åŠ å…¥é˜Ÿåˆ—</span></span><br><span class="line"><span class="built_in">dispatch_async</span>(queue, ^&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span> ; i &lt; <span class="number">5</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%ld~~~~1~~~~%@"</span>, i, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">dispatch_async</span>(queue, ^&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%ld~~~2~~~%@"</span>, i, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">dispatch_async</span>(queue, ^&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%ld~~~~3~~~~%@"</span>, i, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//å¼‚æ­¥å‡½æ•° + ä¸²è¡Œé˜Ÿåˆ—:ä¼šå¼€å¯æ–°çš„çº¿ç¨‹ï¼Œä½†æ˜¯ä»»åŠ¡æ˜¯ä¸²è¡Œçš„ï¼Œæ‰§è¡Œå®Œä¸€ä¸ªä»»åŠ¡ï¼Œå†æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡</span></span><br><span class="line"><span class="comment">// 1.åˆ›å»ºä¸²è¡Œé˜Ÿåˆ—</span></span><br><span class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_queue_create(<span class="string">"YMWM"</span>, DISPATCH_QUEUE_SERIAL);</span><br><span class="line"><span class="comment">// 2.å°†ä»»åŠ¡åŠ å…¥é˜Ÿåˆ—</span></span><br><span class="line"><span class="built_in">dispatch_async</span>(queue, ^&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span> ; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"1~~~%@~~~~~%ld"</span>, [<span class="built_in">NSThread</span> currentThread], i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">dispatch_async</span>(queue, ^&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"2~~~%@~~~~~%ld"</span>, [<span class="built_in">NSThread</span> currentThread], i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">dispatch_async</span>(queue, ^&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"2~~~%@~~~~~%ld"</span>, [<span class="built_in">NSThread</span> currentThread], i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="2ã€dispatch-sync-åŒæ­¥å‡½æ•°"><a href="#2ã€dispatch-sync-åŒæ­¥å‡½æ•°" class="headerlink" title="2ã€dispatch_sync(åŒæ­¥å‡½æ•°)"></a>2ã€dispatch_sync(åŒæ­¥å‡½æ•°)</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åŒæ­¥å‡½æ•° + å¹¶å‘é˜Ÿåˆ—:ä¸ä¼šå¼€å¯æ–°çš„çº¿ç¨‹</span></span><br><span class="line"><span class="comment">// 1.è·å¾—å…¨å±€çš„å¹¶å‘é˜Ÿåˆ—</span></span><br><span class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// 2.å°†ä»»åŠ¡åŠ å…¥é˜Ÿåˆ—</span></span><br><span class="line"><span class="built_in">dispatch_sync</span>(queue, ^&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"1~~~%@~~~~~%ld"</span>, [<span class="built_in">NSThread</span> currentThread], i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">dispatch_sync</span>(queue, ^&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"2~~~%@~~~~~%ld"</span>, [<span class="built_in">NSThread</span> currentThread], i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">dispatch_sync</span>(queue, ^&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"3~~~%@~~~~~%ld"</span>, [<span class="built_in">NSThread</span> currentThread], i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//åŒæ­¥å‡½æ•° + ä¸²è¡Œé˜Ÿåˆ—:ä¸ä¼šå¼€å¯æ–°çš„çº¿ç¨‹</span></span><br><span class="line"><span class="comment">// 1.åˆ›å»ºä¸²è¡Œé˜Ÿåˆ—</span></span><br><span class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_queue_create(<span class="string">"YMWM"</span>, DISPATCH_QUEUE_SERIAL);</span><br><span class="line"><span class="comment">// 2.å°†ä»»åŠ¡åŠ å…¥é˜Ÿåˆ—</span></span><br><span class="line"><span class="built_in">dispatch_sync</span>(queue, ^&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"1~~~%@~~~~~%ld"</span>, [<span class="built_in">NSThread</span> currentThread], i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">dispatch_sync</span>(queue, ^&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"2~~~%@~~~~~%ld"</span>, [<span class="built_in">NSThread</span> currentThread], i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">dispatch_sync</span>(queue, ^&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"3~~~%@~~~~~%ld"</span>, [<span class="built_in">NSThread</span> currentThread], i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="3-ä¸¤è€…åœ¨ä¸»é˜Ÿåˆ—ä¸­çš„åº”ç”¨"><a href="#3-ä¸¤è€…åœ¨ä¸»é˜Ÿåˆ—ä¸­çš„åº”ç”¨" class="headerlink" title="3.ä¸¤è€…åœ¨ä¸»é˜Ÿåˆ—ä¸­çš„åº”ç”¨"></a>3.ä¸¤è€…åœ¨ä¸»é˜Ÿåˆ—ä¸­çš„åº”ç”¨</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¼‚æ­¥å‡½æ•° + ä¸»é˜Ÿåˆ—ï¼šåªåœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡</span></span><br><span class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_get_main_queue();</span><br><span class="line"><span class="built_in">dispatch_async</span>(queue, ^&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"1~~~%@~~~~~%ld"</span>, [<span class="built_in">NSThread</span> currentThread], i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">dispatch_async</span>(queue, ^&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"2~~~%@~~~~~%ld"</span>, [<span class="built_in">NSThread</span> currentThread], i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">dispatch_async</span>(queue, ^&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"3~~~%@~~~~~%ld"</span>, [<span class="built_in">NSThread</span> currentThread], i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//åŒæ­¥å‡½æ•° + ä¸»é˜Ÿåˆ—ï¼šæ­»å¾ªç¯</span></span><br><span class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_get_main_queue();</span><br><span class="line"><span class="built_in">dispatch_sync</span>(queue, ^&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"1~~~%@~~~~~%ld"</span>, [<span class="built_in">NSThread</span> currentThread], i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">dispatch_sync</span>(queue, ^&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"1~~~%@~~~~~%ld"</span>, [<span class="built_in">NSThread</span> currentThread], i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">dispatch_sync</span>(queue, ^&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"1~~~%@~~~~~%ld"</span>, [<span class="built_in">NSThread</span> currentThread], i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="4ã€dispatch-group-asyncçš„ä½¿ç”¨"><a href="#4ã€dispatch-group-asyncçš„ä½¿ç”¨" class="headerlink" title="4ã€dispatch_group_asyncçš„ä½¿ç”¨"></a>4ã€dispatch_group_asyncçš„ä½¿ç”¨</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—ç»„</span></span><br><span class="line">dispatch_group_t group = dispatch_group_create();</span><br><span class="line">dispatch_group_async(group, queue, ^&#123;</span><br><span class="line"><span class="comment">//æ·»åŠ æ“ä½œ...</span></span><br><span class="line">[<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">1</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"1%@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;);</span><br><span class="line">dispatch_group_async(group, queue, ^&#123;</span><br><span class="line"><span class="comment">//æ·»åŠ æ“ä½œ...</span></span><br><span class="line">[<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">1</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"2%@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;);</span><br><span class="line">dispatch_group_async(group, queue, ^&#123;</span><br><span class="line"><span class="comment">//æ·»åŠ æ“ä½œ...</span></span><br><span class="line">[<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">1</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"3%@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// å›åˆ°ä¸»çº¿ç¨‹</span></span><br><span class="line">dispatch_group_notify(group, dispatch_get_main_queue(), ^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"å›åˆ°ä¸»çº¿ç¨‹åˆ·æ–°UI"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="5ã€dispatch-barrier-asyncçš„ä½¿ç”¨"><a href="#5ã€dispatch-barrier-asyncçš„ä½¿ç”¨" class="headerlink" title="5ã€dispatch_barrier_asyncçš„ä½¿ç”¨"></a>5ã€dispatch_barrier_asyncçš„ä½¿ç”¨</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_queue_create(<span class="string">"YMWM"</span>, DISPATCH_QUEUE_CONCURRENT);</span><br><span class="line"><span class="built_in">dispatch_async</span>(queue, ^&#123;</span><br><span class="line">[<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">.5</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"1%@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">dispatch_async</span>(queue, ^&#123;</span><br><span class="line">[<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">.5</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"2%@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;);</span><br><span class="line">dispatch_barrier_async(queue, ^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"barrier --- %@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">[<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">.5</span>];</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">dispatch_async</span>(queue, ^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"3%@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">dispatch_async</span>(queue, ^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"4%@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="6ã€dispatch-applyçš„ä½¿ç”¨"><a href="#6ã€dispatch-applyçš„ä½¿ç”¨" class="headerlink" title="6ã€dispatch_applyçš„ä½¿ç”¨"></a>6ã€dispatch_applyçš„ä½¿ç”¨</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ‰§è¡ŒæŸä¸ªä»£ç ç‰‡æ®µ10æ¬¡</span></span><br><span class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>);</span><br><span class="line">dispatch_apply(<span class="number">10</span>, queue, ^(size_t index) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="7ã€dispatch-once-tçš„ä½¿ç”¨"><a href="#7ã€dispatch-once-tçš„ä½¿ç”¨" class="headerlink" title="7ã€dispatch_once_tçš„ä½¿ç”¨"></a>7ã€dispatch_once_tçš„ä½¿ç”¨</h4><p>ç¬¬ä¸€ä¸ªå‚æ•°predicateï¼Œè¯¥å‚æ•°æ˜¯æ£€æŸ¥åé¢ç¬¬äºŒä¸ªå‚æ•°æ‰€ä»£è¡¨çš„ä»£ç å—æ˜¯å¦è¢«è°ƒç”¨çš„è°“è¯ï¼Œç¬¬äºŒä¸ªå‚æ•°åˆ™æ˜¯åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡çš„ä»£ç å—<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</span><br><span class="line"><span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h4 id="8-dispatch-afterçš„ä½¿ç”¨"><a href="#8-dispatch-afterçš„ä½¿ç”¨" class="headerlink" title="8.dispatch_afterçš„ä½¿ç”¨"></a>8.dispatch_afterçš„ä½¿ç”¨</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(<span class="built_in">UIEvent</span> *)event &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"-------"</span>);</span><br><span class="line"><span class="comment">//å»¶è¿Ÿæ‰§è¡Œï¼Œè¾ƒä¸ºç²¾ç¡®</span></span><br><span class="line">dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(<span class="number">2.0</span> * <span class="built_in">NSEC_PER_SEC</span>)), dispatch_get_main_queue(), ^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"~~~~~~"</span>);</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="9-çº¿ç¨‹é—´çš„é€šä¿¡"><a href="#9-çº¿ç¨‹é—´çš„é€šä¿¡" class="headerlink" title="9.çº¿ç¨‹é—´çš„é€šä¿¡"></a>9.çº¿ç¨‹é—´çš„é€šä¿¡</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#pragma mark - GCD-çº¿ç¨‹é—´çš„é€šä¿¡</span></span><br><span class="line">- (<span class="keyword">void</span>)downloadImage &#123;</span><br><span class="line"><span class="built_in">NSData</span> *data = [<span class="built_in">NSData</span> dataWithContentsOfURL:[<span class="built_in">NSURL</span> URLWithString:<span class="string">@"http://img.lanrentuku.com/img/allimg/1310/13822295641903.jpg"</span>]];</span><br><span class="line"></span><br><span class="line"><span class="built_in">UIImage</span> *image = [<span class="built_in">UIImage</span> imageWithData:data];</span><br><span class="line"></span><br><span class="line"><span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">self</span>.imageview.image = image;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="10-æ–‡ä»¶å‰ªåˆ‡"><a href="#10-æ–‡ä»¶å‰ªåˆ‡" class="headerlink" title="10.æ–‡ä»¶å‰ªåˆ‡"></a>10.æ–‡ä»¶å‰ªåˆ‡</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç¬¬ä¸€ç§æ–¹å¼</span></span><br><span class="line"><span class="comment">//å°†æ–‡ä»¶ä»fromå‰ªåˆ‡è‡³to</span></span><br><span class="line"><span class="built_in">NSString</span> *from = <span class="string">@"/Users/iOS/Desktop/Test"</span>;</span><br><span class="line"><span class="built_in">NSString</span> *to = <span class="string">@"/Users/iOS/Desktop/test1"</span>;</span><br><span class="line"><span class="built_in">NSFileManager</span> *mgr = [<span class="built_in">NSFileManager</span> defaultManager];</span><br><span class="line"><span class="built_in">NSArray</span> *subpaths = [mgr subpathsAtPath:from];</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSString</span> *subpath <span class="keyword">in</span> subpaths) &#123;</span><br><span class="line"><span class="built_in">NSString</span> *fromFullpath = [from stringByAppendingPathComponent:subpath];</span><br><span class="line"><span class="built_in">NSString</span> *toFullpath = [to stringByAppendingPathComponent:subpath];</span><br><span class="line"><span class="built_in">dispatch_async</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>), ^&#123;</span><br><span class="line"><span class="comment">//å‰ªåˆ‡</span></span><br><span class="line">[mgr moveItemAtPath:fromFullpath toPath:toFullpath error:<span class="literal">nil</span>];</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç¬¬äºŒç§æ–¹å¼</span></span><br><span class="line"><span class="comment">//å°†æ–‡ä»¶ä»fromå‰ªåˆ‡è‡³to</span></span><br><span class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">NSString</span> *from = <span class="string">@"/Users/iOS/Desktop/Test"</span>;</span><br><span class="line"><span class="built_in">NSString</span> *to = <span class="string">@"/Users/iOS/Desktop/test1"</span>;</span><br><span class="line"><span class="built_in">NSFileManager</span> *mag = [<span class="built_in">NSFileManager</span> defaultManager];</span><br><span class="line"><span class="built_in">NSArray</span> *subpaths = [mag subpathsAtPath:from];</span><br><span class="line">dispatch_apply(subpaths.count, queue, ^(size_t index) &#123;</span><br><span class="line"><span class="built_in">NSString</span> *subpath = subpaths[index];</span><br><span class="line"><span class="built_in">NSString</span> *fromFullpath = [from stringByAppendingPathComponent:subpath];</span><br><span class="line"><span class="built_in">NSString</span> *toFullpath = [to stringByAppendingPathComponent:subpath];</span><br><span class="line"><span class="comment">//        å‰ªåˆ‡</span></span><br><span class="line">[mag moveItemAtPath:fromFullpath toPath:toFullpath error:<span class="literal">nil</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@~~~~~~%@"</span>, [<span class="built_in">NSThread</span> currentThread], subpath);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="ä¸‰ã€GCDä¸éGCDå®ç°å•ç²’è®¾è®¡æ¨¡å¼"><a href="#ä¸‰ã€GCDä¸éGCDå®ç°å•ç²’è®¾è®¡æ¨¡å¼" class="headerlink" title="ä¸‰ã€GCDä¸éGCDå®ç°å•ç²’è®¾è®¡æ¨¡å¼"></a>ä¸‰ã€GCDä¸éGCDå®ç°å•ç²’è®¾è®¡æ¨¡å¼</h3><h4 id="1-GCDå®ç°è®¾è®¡æ¨¡å¼"><a href="#1-GCDå®ç°è®¾è®¡æ¨¡å¼" class="headerlink" title="1.GCDå®ç°è®¾è®¡æ¨¡å¼"></a>1.GCDå®ç°è®¾è®¡æ¨¡å¼</h4><p>ç±»çš„.hæ–‡ä»¶<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">PKPerson</span> : <span class="title">NSObject</span></span></span><br><span class="line">+ (<span class="keyword">instancetype</span>)sharedCar;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>ç±»çš„.mæ–‡ä»¶<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">PKPerson</span>() &lt;<span class="title">NSCopying</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">PKPerson</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ä¾‹å˜é‡ï¼Œå½“å‰ç±»</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">id</span> _instance;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡å†™allocWithZoneæ–¹æ³•</span></span><br><span class="line">+ (<span class="keyword">instancetype</span>)allocWithZone:(<span class="keyword">struct</span> _NSZone *)zone&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯¥æ–¹æ³•æ•´ä¸ªåº”ç”¨ç¨‹åºåªè°ƒç”¨ä¸€æ¬¡</span></span><br><span class="line"><span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</span><br><span class="line">_instance = [<span class="keyword">super</span> allocWithZone:zone];</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">return</span> _instance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">instancetype</span>)sharedInstance&#123;</span><br><span class="line"><span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</span><br><span class="line"><span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</span><br><span class="line">_instance = [[<span class="keyword">self</span> alloc] init];</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">return</span> _instance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿è¯æ¯å¤åˆ¶ä¸€ä¸ªå¯¹è±¡ä¹Ÿæ˜¯åŒä¸€å†…å­˜ç©ºé—´</span></span><br><span class="line">- (<span class="keyword">id</span>)copyWithZone:(<span class="built_in">NSZone</span> *)zone&#123;</span><br><span class="line"><span class="keyword">return</span> _instance;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<h4 id="2-å®å®šä¹‰å°è£…GCDå•ç²’è®¾è®¡æ¨¡å¼"><a href="#2-å®å®šä¹‰å°è£…GCDå•ç²’è®¾è®¡æ¨¡å¼" class="headerlink" title="2.å®å®šä¹‰å°è£…GCDå•ç²’è®¾è®¡æ¨¡å¼"></a>2.å®å®šä¹‰å°è£…GCDå•ç²’è®¾è®¡æ¨¡å¼</h4><p>é€šå¸¸å½“å¤šä¸ªç±»ä¹‹é—´æœ‰ç›¸åŒçš„å±æ€§å’Œæ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬ä¼šè€ƒè™‘å°†ç›¸åŒçš„éƒ¨åˆ†æŠ½å–å‡ºæ¥ï¼Œå°è£…åˆ°çˆ¶ç±»ä¸­ï¼Œä½†å•ç²’æ¨¡å¼ä¸å¯ä»¥è¿™æ ·åšï¼Œå› ä¸ºå•ç²’æ¨¡å¼é‡‡ç”¨ç»§æ‰¿æ–¹å¼çš„è¯ï¼Œæ‰€æœ‰çš„ç±»ä¼šå…±äº«ä¸€ä»½å†…å­˜ã€‚æ‰€ä»¥ä¸€èˆ¬é‡‡å–å®å®šä¹‰å°è£…GCDå•ç²’è®¾è®¡æ¨¡å¼ã€‚æ³¨æ„ï¼Œæ¯è¡Œçš„ç»“å°¾éœ€è¦æ·»åŠ  â€œ\â€ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .hæ–‡ä»¶</span></span><br><span class="line"><span class="meta">#define PKSingletonH + (instancetype)sharedInstance;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// .mæ–‡ä»¶</span></span><br><span class="line"><span class="meta">#define PKSingletonH \</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">id</span> _instace; \</span><br><span class="line">\</span><br><span class="line">+ (<span class="keyword">instancetype</span>)allocWithZone:(<span class="keyword">struct</span> _NSZone *)zone \</span><br><span class="line">&#123; \</span><br><span class="line"><span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken; \</span><br><span class="line"><span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123; \</span><br><span class="line">_instace = [<span class="keyword">super</span> allocWithZone:zone]; \</span><br><span class="line">&#125;); \</span><br><span class="line"><span class="keyword">return</span> _instace; \</span><br><span class="line">&#125; \</span><br><span class="line">\</span><br><span class="line">+ (<span class="keyword">instancetype</span>)sharedInstance \</span><br><span class="line">&#123; \</span><br><span class="line"><span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken; \</span><br><span class="line"><span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123; \</span><br><span class="line">_instace = [[<span class="keyword">self</span> alloc] init]; \</span><br><span class="line">&#125;); \</span><br><span class="line"><span class="keyword">return</span> _instace; \</span><br><span class="line">&#125; \</span><br><span class="line">\</span><br><span class="line">- (<span class="keyword">id</span>)copyWithZone:(<span class="built_in">NSZone</span> *)zone \</span><br><span class="line">&#123; \</span><br><span class="line"><span class="keyword">return</span> _instace; \</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="3-éGCDå®ç°è®¾è®¡æ¨¡å¼"><a href="#3-éGCDå®ç°è®¾è®¡æ¨¡å¼" class="headerlink" title="3.éGCDå®ç°è®¾è®¡æ¨¡å¼"></a>3.éGCDå®ç°è®¾è®¡æ¨¡å¼</h4><p>ç±»çš„.hæ–‡ä»¶</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">PKPerson</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">instancetype</span>)sharedInstance;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>ç±»çš„.mæ–‡ä»¶<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"PKPerson.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">PKPerson</span>()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">PKPerson</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">id</span> _instance;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">instancetype</span>)allocWithZone:(<span class="keyword">struct</span> _NSZone *)zone</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// åŒæ­¥é”ï¼Œé˜²æ­¢å¤šçº¿ç¨‹åŒæ—¶è¿›å…¥</span></span><br><span class="line"><span class="keyword">@synchronized</span>(<span class="keyword">self</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (_instance == <span class="literal">nil</span>) &#123;</span><br><span class="line">_instance = [<span class="keyword">super</span> allocWithZone:zone];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> _instance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">instancetype</span>)sharedInstance</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">@synchronized</span>(<span class="keyword">self</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (_instance == <span class="literal">nil</span>) &#123;</span><br><span class="line">_instance = [[<span class="keyword">self</span> alloc] init];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> _instance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)copyWithZone:(<span class="built_in">NSZone</span> *)zone</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> _instance;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<h3 id="å››ã€GCDå®šæ—¶å™¨"><a href="#å››ã€GCDå®šæ—¶å™¨" class="headerlink" title="å››ã€GCDå®šæ—¶å™¨"></a>å››ã€GCDå®šæ—¶å™¨</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span></span><br><span class="line"><span class="comment">/** å®šæ—¶å™¨(è¿™é‡Œä¸ç”¨å¸¦*ï¼Œå› ä¸ºdispatch_source_tå°±æ˜¯ä¸ªç±»ï¼Œå†…éƒ¨å·²ç»åŒ…å«äº†*) */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) dispatch_source_t timer;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// è·å¾—é˜Ÿåˆ—</span></span><br><span class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_get_main_queue();</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨(dispatch_source_tæœ¬è´¨è¿˜æ˜¯ä¸ªOCå¯¹è±¡)</span></span><br><span class="line"><span class="keyword">self</span>.timer = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER, <span class="number">0</span>, <span class="number">0</span>, queue);</span><br><span class="line"></span><br><span class="line"><span class="comment">// GCDçš„æ—¶é—´å‚æ•°ä¸€èˆ¬æ˜¯çº³ç§’ï¼ˆ1ç§’ == 10çš„9æ¬¡æ–¹çº³ç§’ï¼‰</span></span><br><span class="line">dispatch_time_t start = dispatch_time(DISPATCH_TIME_NOW, (int64_t)(<span class="number">1.0</span> * <span class="built_in">NSEC_PER_SEC</span>));</span><br><span class="line">uint64_t interval = (uint64_t)(<span class="number">1.0</span> * <span class="built_in">NSEC_PER_SEC</span>);</span><br><span class="line">dispatch_source_set_timer(<span class="keyword">self</span>.timer, start, interval, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®å›è°ƒ</span></span><br><span class="line">dispatch_source_set_event_handler(<span class="keyword">self</span>.timer, ^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"------%@-------"</span>, [<span class="built_in">NSThread</span> currentThread]);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯åŠ¨å®šæ—¶å™¨</span></span><br><span class="line">dispatch_resume(<span class="keyword">self</span>.timer);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p><em>ä¸‰ç§å¤šçº¿ç¨‹ç¼–ç¨‹éƒ½è¯´å®Œäº†ï¼Œä»£ç æœ‰äº›å¤šï¼Œä¸è¿‡å¸Œæœ›æœ‹å‹ä»¬æœ‰æ‰€æ”¶è·ï¼Œå¦å¤–å†è¡¥å……ä¸€äº›å…³äºçº¿ç¨‹é—´é€šä¿¡çš„ã€‚ã€‚ã€‚</em></p>
<h2 id="ï¼ˆäº”ï¼‰iOSå¼€å‘ä¹‹å¤šçº¿ç¨‹-çº¿ç¨‹é—´çš„é€šä¿¡"><a href="#ï¼ˆäº”ï¼‰iOSå¼€å‘ä¹‹å¤šçº¿ç¨‹-çº¿ç¨‹é—´çš„é€šä¿¡" class="headerlink" title="ï¼ˆäº”ï¼‰iOSå¼€å‘ä¹‹å¤šçº¿ç¨‹ çº¿ç¨‹é—´çš„é€šä¿¡"></a>ï¼ˆäº”ï¼‰iOSå¼€å‘ä¹‹å¤šçº¿ç¨‹ çº¿ç¨‹é—´çš„é€šä¿¡</h2><h3 id="ä¸€ã€ç®€å•ä»‹ç»"><a href="#ä¸€ã€ç®€å•ä»‹ç»" class="headerlink" title="ä¸€ã€ç®€å•ä»‹ç»"></a>ä¸€ã€ç®€å•ä»‹ç»</h3><p>åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œçº¿ç¨‹å¾€å¾€ä¸æ˜¯å­¤ç«‹å­˜åœ¨çš„ï¼Œå¤šä¸ªçº¿ç¨‹ä¹‹é—´éœ€è¦ç»å¸¸è¿›è¡Œé€šä¿¡ã€‚ä»¥ä¸‹æ˜¯çº¿ç¨‹ä¹‹é—´è¿›è¡Œé€šä¿¡çš„æ–¹æ³•:</p>
<h3 id="äºŒã€å¸¸ç”¨æ–¹æ³•"><a href="#äºŒã€å¸¸ç”¨æ–¹æ³•" class="headerlink" title="äºŒã€å¸¸ç”¨æ–¹æ³•:"></a>äºŒã€å¸¸ç”¨æ–¹æ³•:</h3><h4 id="ä»£ç 1-performSelector"><a href="#ä»£ç 1-performSelector" class="headerlink" title="ä»£ç 1:performSelector"></a>ä»£ç 1:performSelector</h4><p>performSelectorå¸¸ç”¨æ–¹æ³•çš„å¸¸ç”¨æ–¹æ³•ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œæ“ä½œ</span></span><br><span class="line">[<span class="keyword">self</span> performSelectorOnMainThread:<span class="keyword">@selector</span>(run) withObject:<span class="literal">nil</span> waitUntilDone:<span class="literal">YES</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨å½“å‰çº¿ç¨‹æ‰§è¡Œæ“ä½œ</span></span><br><span class="line">[<span class="keyword">self</span> performSelector:<span class="keyword">@selector</span>(run) withObject:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨æŒ‡å®šçº¿ç¨‹ä¸Šæ‰§è¡Œæ“ä½œ</span></span><br><span class="line">[<span class="keyword">self</span> performSelector:<span class="keyword">@selector</span>(run) onThread:thread withObject:<span class="literal">nil</span> waitUntilDone:<span class="literal">YES</span>];</span><br></pre></td></tr></table></figure></p>
<p>å…·ä½“ä»£ç :<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç‚¹å‡»å±å¹•å¼€å§‹æ‰§è¡Œä»¥ä¸‹æ–¹æ³•</span></span><br><span class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event &#123;</span><br><span class="line">[<span class="keyword">self</span> performSelectorInBackground:<span class="keyword">@selector</span>(download) withObject:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line">- (<span class="keyword">void</span>)download</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// å›¾ç‰‡çš„ç½‘ç»œè·¯å¾„</span></span><br><span class="line"><span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:<span class="string">@"http://img.lanrentuku.com/img/allimg/1310/13822295641903.jpg"</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ ¹æ®åœ°å€åŠ è½½å›¾ç‰‡</span></span><br><span class="line"><span class="built_in">NSData</span> *data = [<span class="built_in">NSData</span> dataWithContentsOfURL:url]; <span class="comment">//è€—æ—¶æ“ä½œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿæˆå›¾ç‰‡</span></span><br><span class="line"><span class="built_in">UIImage</span> *image = [<span class="built_in">UIImage</span> imageWithData:data];</span><br><span class="line"></span><br><span class="line"><span class="comment">// å›åˆ°ä¸»çº¿ç¨‹ï¼Œåˆ·æ–°UIç•Œé¢</span></span><br><span class="line"><span class="comment">//æ–¹å¼ä¸€</span></span><br><span class="line">[<span class="keyword">self</span>.imageView performSelector:<span class="keyword">@selector</span>(setImage:) onThread:[<span class="built_in">NSThread</span> mainThread] withObject:image waitUntilDone:<span class="literal">NO</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ–¹å¼äºŒ</span></span><br><span class="line"><span class="comment">//    [self.imageView performSelectorOnMainThread:@selector(setImage:) withObject:image waitUntilDone:NO];</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ–¹å¼ä¸‰</span></span><br><span class="line"><span class="comment">//    [self performSelectorOnMainThread:@selector(showImage:) withObject:image waitUntilDone:NO];</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ˜¾ç¤ºå›¾ç‰‡(å¦‚æœperformSelectorè°ƒç”¨çš„æ˜¯setImage:æ–¹æ³•ï¼Œä¼šç›´æ¥è°ƒç”¨ç³»ç»Ÿçš„æ–¹æ³•)</span></span><br><span class="line"><span class="comment">//- (void)showImage:(UIImage *)image</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//    self.imageView.image = image;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="ä»£ç 2-NSOperationQueueæ–¹å¼"><a href="#ä»£ç 2-NSOperationQueueæ–¹å¼" class="headerlink" title="ä»£ç 2:NSOperationQueueæ–¹å¼"></a>ä»£ç 2:NSOperationQueueæ–¹å¼</h4><p>ä¸€ä¸ªNSOperationå¯¹è±¡å¯ä»¥é€šè¿‡è°ƒç”¨startæ–¹æ³•æ¥æ‰§è¡Œä»»åŠ¡,é»˜è®¤æ˜¯åŒæ­¥æ‰§è¡Œçš„.ä¹Ÿå¯ä»¥å°†NSOperationæ·»åŠ åˆ°ä¸€ä¸ªNSOperationQueueä¸­å»æ‰§è¡Œ,è€Œä¸”æ˜¯å¼‚æ­¥æ‰§è¡Œçš„.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#pragma mark - NSOperationå®ç°çº¿ç¨‹é—´çš„é€šä¿¡</span></span><br><span class="line">- (<span class="keyword">void</span>)<span class="built_in">NSOperationTest</span> &#123;</span><br><span class="line">[[[<span class="built_in">NSOperationQueue</span> alloc] init] addOperationWithBlock:^&#123;</span><br><span class="line"><span class="built_in">NSData</span> *data = [<span class="built_in">NSData</span> dataWithContentsOfURL:[<span class="built_in">NSURL</span> URLWithString:<span class="string">@"http://img.lanrentuku.com/img/allimg/1310/13822295641903.jpg"</span>]];</span><br><span class="line"><span class="built_in">UIImage</span> *image = [<span class="built_in">UIImage</span> imageWithData:data];</span><br><span class="line">[[<span class="built_in">NSOperationQueue</span> mainQueue] addOperationWithBlock:^&#123;</span><br><span class="line"><span class="keyword">self</span>.imageView.image = image;</span><br><span class="line">&#125;];</span><br><span class="line">&#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ä»£ç 3-GCDæ–¹å¼"><a href="#ä»£ç 3-GCDæ–¹å¼" class="headerlink" title="ä»£ç 3:GCDæ–¹å¼"></a>ä»£ç 3:GCDæ–¹å¼</h4><p>GCDï¼Œå…¨ç§°Grand Central Dispathï¼Œæ˜¯è‹¹æœå¼€å‘çš„ä¸€ç§æ”¯æŒå¹¶è¡Œæ“ä½œçš„æœºåˆ¶ã€‚å®ƒçš„ä¸»è¦éƒ¨ä»¶æ˜¯ä¸€ä¸ªFIFOé˜Ÿåˆ—å’Œä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå‰è€…ç”¨æ¥æ·»åŠ ä»»åŠ¡ï¼Œåè€…ç”¨æ¥æ‰§è¡Œä»»åŠ¡ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dispatch_async</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>), ^&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å›¾ç‰‡çš„ç½‘ç»œè·¯å¾„</span></span><br><span class="line"><span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:<span class="string">@"http://img.lanrentuku.com/img/allimg/1310/13822295641903.jpg"</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ è½½å›¾ç‰‡</span></span><br><span class="line"><span class="built_in">NSData</span> *data = [<span class="built_in">NSData</span> dataWithContentsOfURL:url];</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿæˆå›¾ç‰‡</span></span><br><span class="line"><span class="built_in">UIImage</span> *image = [<span class="built_in">UIImage</span> imageWithData:data];</span><br><span class="line"></span><br><span class="line"><span class="comment">// å›åˆ°ä¸»çº¿ç¨‹æ˜¾ç¤ºå›¾ç‰‡</span></span><br><span class="line"><span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line"><span class="keyword">self</span>.imageView.image = image;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="ä¸‰ã€NSPortæ–¹æ³•"><a href="#ä¸‰ã€NSPortæ–¹æ³•" class="headerlink" title="ä¸‰ã€NSPortæ–¹æ³•:"></a>ä¸‰ã€NSPortæ–¹æ³•:</h3><p>NSPortæœ‰3ä¸ªå­ç±»ï¼ŒNSSocketPortã€NSMessagePortã€NSMachPortï¼Œä½†åœ¨iOSä¸‹åªæœ‰NSMachPortå¯ç”¨ã€‚ä»£ç å¦‚ä¸‹:</p>
<p>UIViewControllerä¸­çš„ä»£ç :</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"MyPort.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> () &lt;<span class="title">NSPortDelegate</span>&gt;</span></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">[<span class="keyword">super</span> viewDidLoad];</span><br><span class="line"><span class="comment">//åˆ›å»ºä¸»çº¿ç¨‹çš„port</span></span><br><span class="line"><span class="built_in">NSPort</span> *myPort = [<span class="built_in">NSPort</span> port];</span><br><span class="line"></span><br><span class="line"><span class="comment">//è®¾ç½®ä»£ç†</span></span><br><span class="line">myPort.delegate = <span class="keyword">self</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŠŠportåŠ å…¥runloop</span></span><br><span class="line">[[<span class="built_in">NSRunLoop</span> currentRunLoop] addPort:myPort forMode:<span class="built_in">NSDefaultRunLoopMode</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯åŠ¨å­çº¿ç¨‹,å¹¶ä¼ å…¥ä¸»çº¿ç¨‹çš„port</span></span><br><span class="line">MyPort *work = [[MyPort alloc] init];</span><br><span class="line"></span><br><span class="line">[<span class="built_in">NSThread</span> detachNewThreadSelector:<span class="keyword">@selector</span>(launchThreadWithPort:)</span><br><span class="line">toTarget:work</span><br><span class="line">withObject:myPort];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)handlePortMessage:(<span class="built_in">NSMessagePort</span>*)message&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"å·²æ¥åˆ°å­çº¿ç¨‹çš„æ¶ˆæ¯ --- %@"</span>, message);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>MyPortä¸­çš„ä»£ç :</p>
<p>.hæ–‡ä»¶:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MyPort</span> : <span class="title">NSPort</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>.mæ–‡ä»¶:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"MyPort.h"</span></span></span><br><span class="line"><span class="meta">#define PKMessage 10</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MyPort</span> ()&lt;<span class="title">NSMachPortDelegate</span>&gt; </span>&#123;</span><br><span class="line"><span class="built_in">NSPort</span> *firstPort;</span><br><span class="line"><span class="built_in">NSPort</span> *secondPort;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MyPort</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)launchThreadWithPort:(<span class="built_in">NSPort</span> *)port &#123;</span><br><span class="line"><span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¥æ”¶ä¸»çº¿ç¨‹ä¼ å…¥çš„port</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//è®¾ç½®å­çº¿ç¨‹åå­—</span></span><br><span class="line">[[<span class="built_in">NSThread</span> currentThread] setName:<span class="string">@"MyThread"</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¼€å¯runloop</span></span><br><span class="line">[[<span class="built_in">NSRunLoop</span> currentRunLoop] run];</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»ºè‡ªå·±port</span></span><br><span class="line">secondPort = [<span class="built_in">NSPort</span> port];</span><br><span class="line">secondPort.delegate = <span class="keyword">self</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†è‡ªå·±çš„portæ·»åŠ åˆ°runloop,é˜²æ­¢runloopæ‰§è¡Œå®Œæ¯•ä¹‹åé€€å‡º,æ¥æ”¶ä¸»çº¿ç¨‹å‘é€è¿‡æ¥çš„portæ¶ˆæ¯</span></span><br><span class="line">[[<span class="built_in">NSRunLoop</span> currentRunLoop] addPort:secondPort forMode:<span class="built_in">NSDefaultRunLoopMode</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®Œæˆå‘ä¸»çº¿ç¨‹å‘é€æ¶ˆæ¯</span></span><br><span class="line">[<span class="keyword">self</span> sendPortMessage];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*   å®Œæˆå‘ä¸»çº¿ç¨‹å‘é€æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">- (<span class="keyword">void</span>)sendPortMessage &#123;</span><br><span class="line"><span class="comment">//å‘é€æ¶ˆæ¯åˆ°ä¸»çº¿ç¨‹</span></span><br><span class="line">[firstPort sendBeforeDate:[<span class="built_in">NSDate</span> date]</span><br><span class="line">msgid:PKMessage</span><br><span class="line">components:<span class="literal">nil</span></span><br><span class="line">from:secondPort</span><br><span class="line">reserved:<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æç¤º:é€šå¸¸æ¥è¯´, NSPortå¯ä»¥åšçš„äº‹æƒ…é€šè¿‡performSelectorä¹ŸåŒæ ·å¯ä»¥æå®šï¼Œå› æ­¤çº¿ç¨‹é—´é€šä¿¡å®Œå…¨å¯ä»¥é€šè¿‡performSelectoræ¥å®ç°ã€‚<br><strong><end></end></strong></p>
<hr>
<p><strong>ç»“æŸè¯­ï¼šä»¥ä¸Šæ˜¯å¤šçº¿ç¨‹ç›¸å…³çš„çŸ¥è¯†æ€»ç»“ï¼Œæœ¬äººä¹Ÿæ˜¯å°ç™½çº§åˆ«ï¼Œå¦‚æœæœ‰å†™é”™çš„åœ°æ–¹ï¼Œè¿˜è¯·æœ‹å‹ä»¬èƒ½å¤ŸæŒ‡å‡ºæ¥ï¼Œè°¢è°¢ï¼</strong></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/iOSå¼€å‘ä¹‹ - å°å†·æ˜“å¿˜çŸ¥è¯†ç‚¹æ€»ç»“/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="åˆ˜æœ‹å¤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ä»¥æ¢¦ä¸ºé©¬">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/iOSå¼€å‘ä¹‹ - å°å†·æ˜“å¿˜çŸ¥è¯†ç‚¹æ€»ç»“/" itemprop="url">
                  iOSå¼€å‘ä¹‹ - å°å†·æ˜“å¿˜çŸ¥è¯†ç‚¹æ€»ç»“
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>çœ‹ç½‘ä¸Šæœ‰äººæ•´ç† iOS å¼€å‘ä¸­å¸¸ç”¨çš„æ˜“å¿˜çŸ¥è¯†ç‚¹ï¼Œ<a href="http://www.jianshu.com/p/b3ea66bffc68" target="_blank" rel="noopener">iOS å¼€å‘å°å†·æ˜“å¿˜çŸ¥è¯†ç‚¹æ€»ç»“</a>ï¼Œè§‰å¾—ä¸é”™ï¼Œäºæ˜¯è‡ªå·±ä¹Ÿæƒ³ç€æ•´ç†ä¸€äº›æ˜“å¿˜çš„çŸ¥è¯†ç‚¹ã€‚ä¼šæŒç»­æ›´æ–°â€¦â€¦</p>
</blockquote>
<ul>
<li>iOS æ§åˆ¶å™¨çš„åŸºç±»ï¼Œæ­å»ºæ¡†æ¶ä¹‹åˆä¸€èˆ¬éƒ½ä¼šè®¾è®¡ä¸€ä¸ª ViewController åŸºç±»ï¼Œè¿™é‡Œè®¾ç½®çš„åŸºç±»æ˜¯ NNBaseViewControllerï¼Œç»§æ‰¿è‡ª UIViewControllerã€‚</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"NNBaseViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NNBaseViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NNBaseViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">[<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">[<span class="keyword">self</span> setupViews];</span><br><span class="line"><span class="comment">// åˆ¤æ–­æ˜¯å¦æœ‰ä¸Šçº§é¡µé¢ï¼Œæœ‰çš„è¯å†è®¾ç½®è¿”å›æŒ‰é’®</span></span><br><span class="line"><span class="keyword">if</span> ([<span class="keyword">self</span>.navigationController.viewControllers indexOfObject:<span class="keyword">self</span>] != <span class="number">0</span>) &#123;</span><br><span class="line">[<span class="keyword">self</span> setupLeftBarButton];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setupViews &#123;</span><br><span class="line"><span class="comment">// è®¾ç½®åº”ç”¨çš„èƒŒæ™¯è‰²</span></span><br><span class="line"><span class="keyword">self</span>.view.backgroundColor = [<span class="built_in">UIColor</span> lightGrayColor];</span><br><span class="line"><span class="comment">// ä¸å…è®¸ viewController è‡ªåŠ¨è°ƒæ•´ï¼Œæˆ‘ä»¬è‡ªå·±å¸ƒå±€ï¼›å¦‚æœè®¾ç½®ä¸ºYESï¼Œè§†å›¾ä¼šè‡ªåŠ¨ä¸‹ç§» 64 åƒç´ </span></span><br><span class="line"><span class="keyword">self</span>.automaticallyAdjustsScrollViewInsets = <span class="literal">NO</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - è‡ªå®šä¹‰è¿”å›æŒ‰é’®</span></span><br><span class="line">- (<span class="keyword">void</span>)setupLeftBarButton &#123;</span><br><span class="line"><span class="comment">// è‡ªå®šä¹‰ leftBarButtonItem ï¼ŒUIImageRenderingModeAlwaysOriginal é˜²æ­¢å›¾ç‰‡è¢«æ¸²æŸ“</span></span><br><span class="line"><span class="keyword">self</span>.navigationItem.leftBarButtonItem = [[<span class="built_in">UIBarButtonItem</span> alloc]</span><br><span class="line">initWithImage:[[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"Back-è“"</span>] imageWithRenderingMode:<span class="built_in">UIImageRenderingModeAlwaysOriginal</span>]</span><br><span class="line">style:<span class="built_in">UIBarButtonItemStylePlain</span></span><br><span class="line">target:<span class="keyword">self</span></span><br><span class="line">action:<span class="keyword">@selector</span>(leftBarButtonClick)];</span><br><span class="line"><span class="comment">// é˜²æ­¢è¿”å›æ‰‹åŠ¿å¤±æ•ˆ</span></span><br><span class="line"><span class="keyword">self</span>.navigationController.interactivePopGestureRecognizer.delegate = (<span class="keyword">id</span>&lt;<span class="built_in">UIGestureRecognizerDelegate</span>&gt;)<span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)leftBarButtonClick &#123;</span><br><span class="line">[<span class="keyword">self</span>.navigationController popViewControllerAnimated:<span class="literal">YES</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<ul>
<li>éšè— navigationControll å·¦ä¾§çš„è¿”å›æŒ‰é’®</li>
</ul>
<p>å› ä¸ºé¡¹ç›®éœ€è¦ï¼Œæœ‰æ—¶éœ€è¦éšè— navigationControll å·¦ä¾§æˆ–å³ä¾§çš„æŒ‰é’®ã€‚</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™ä¸¤å¥è²Œä¼¼ä¸å¤ªç®¡ç”¨</span></span><br><span class="line"><span class="keyword">self</span>.navigationItem.leftBarButtonItems = <span class="literal">nil</span>;</span><br><span class="line"><span class="keyword">self</span>.navigationItem.rightBarButtonItem = <span class="literal">nil</span>;</span><br><span class="line"><span class="comment">// å¯ä»¥è¯•è¯•è¿™ä¸¤å¥ä»£ç </span></span><br><span class="line"><span class="keyword">self</span>.navigationItem.hidesBackButton = <span class="literal">YES</span>;</span><br><span class="line"><span class="keyword">self</span>.navigationItem.rightBarButtonItem.customView.hidden = <span class="literal">YES</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>æ”¹å˜ button å†…éƒ¨çš„å›¾ç‰‡ä»¥åŠæ–‡å­—çš„åç§»é‡</li>
</ul>
<p>æœ‰æ—¶å€™éœ€è¦åœ¨ button çš„å³éƒ¨æ·»åŠ æŒ‡ç¤ºç®­å¤´ï¼Œä½† button é»˜è®¤çš„æ˜¯å›¾ç‰‡åœ¨å·¦ï¼Œæ–‡å­—åœ¨å³ï¼Œå› æ­¤æƒ³è¦å®ç°é¡¹ç›®éœ€æ±‚ï¼Œæˆ‘ä»¬éœ€è¦æ”¹å˜ button å†…éƒ¨çš„åç§»é‡ã€‚åœ¨ storyboard æˆ– xib ä¸­ä¹Ÿå¯ä»¥æ”¹å˜ button å†…éƒ¨çš„å›¾ç‰‡ä»¥åŠæ–‡å­—çš„åç§»é‡ï¼Œä½†è²Œä¼¼æ²¡æœ‰åšé€‚é…çš„åœ°æ–¹ï¼Œé‚£ä¹ˆåœ¨ä¸åŒæœºå‹ä¸Šçš„æ˜¾ç¤ºå°±ä¼šæœ‰é—®é¢˜ï¼ˆå¦‚æœå“ªä½é“å‹å‘ç°å¯ä»¥åœ¨ storyboard æˆ– xib ä¸­å¯ä»¥åšé€‚é…ï¼Œè¿˜è¯·å‘ŠçŸ¥ï¼‰ï¼Œä¸‹é¢æ˜¯æ”¹å˜ button å†…éƒ¨å›¾ç‰‡ä»¥åŠæ–‡å­—åç§»é‡çš„ä»£ç ã€‚</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å·²ç»åšäº†é€‚é…ï¼Œå„ä½å¯ä»¥æ ¹æ®éœ€è¦åšå±å¹•é€‚é…</span></span><br><span class="line">self.changeSpecialistBtn.titleEdgeInsets = UIEdgeInsetsMake(<span class="number">0</span>, -lengthFit(<span class="number">16</span>), <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">self.changeSpecialistBtn.imageEdgeInsets = UIEdgeInsetsMake(<span class="number">0</span>, lengthFit(<span class="number">76</span>), <span class="number">0</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>tableView æ»šåŠ¨æ—¶è‡ªåŠ¨æ”¶èµ·é”®ç›˜</li>
</ul>
<p>é¡¹ç›®ä¸­æŸä¸ª tableView é¡µé¢æœ‰æ–‡å­—æœç´¢åŠŸèƒ½ï¼Œè¾“å…¥æ–‡æœ¬å®Œæ¯•ä¹‹åæ»šåŠ¨ tableViewï¼Œè¦æ±‚é”®ç›˜è‡ªåŠ¨æ”¶èµ·ã€‚</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.tableView.keyboardDismissMode = <span class="built_in">UIScrollViewKeyboardDismissModeOnDrag</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>åˆ¤æ–­ä¸Šçº§é¡µé¢æ˜¯å“ªä¸ªé¡µé¢</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æˆ‘è¿™é‡Œçš„é¡¹ç›®éœ€æ±‚æ˜¯ï¼Œå¦‚æœä¸Šä¸€ä¸ªé¡µé¢æ˜¯ KXOrderCenterViewControllerï¼Œå°±éšè—ç¨åæ”¯ä»˜æŒ‰é’®ï¼Œå¦åˆ™ä¸éšè—</span></span><br><span class="line"><span class="built_in">NSArray</span> *array = <span class="keyword">self</span>.navigationController.viewControllers;</span><br><span class="line"><span class="keyword">if</span> ([array[<span class="number">0</span>] isKindOfClass:[KXOrderCenterViewController <span class="keyword">class</span>]]) &#123;</span><br><span class="line"><span class="keyword">self</span>.payLaterBtn.hidden = <span class="literal">YES</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">self</span>.payLaterBtn.hidden = <span class="literal">NO</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ä»ä»»æ„ç•Œé¢è¿”å› NavigationController ä¸­çš„ä»»æ„ä¸€ä¸ª</li>
</ul>
<p>è¿™ä¸ªæ–¹æ³•è¿˜æ˜¯æŒºå®ç”¨çš„ï¼Œä»æŸä¸ªç•Œé¢è·³è½¬åˆ°ä»»æ„ä¸€ä¸ªç•Œé¢ã€‚</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¾—åˆ°å½“å‰çš„ NavigationController</span></span><br><span class="line">[[APPDELEGATE getCurrentViewController].navigationController <span class="string">popToRootViewControllerAnimated:</span>NO];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·³è½¬åˆ°å“ªä¸ª NavigationControllerï¼Œè¿™é‡Œä¸‹æ ‡ä¸º1ï¼Œè¡¨ç¤ºç¬¬äºŒä¸ª</span></span><br><span class="line">[APPDELEGATE.tabBarController <span class="string">setSelectedIndex:</span><span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€€å‡ºå½“å‰ç•Œé¢å¹¶æ‰§è¡Œ block ä¸­çš„å†…å®¹</span></span><br><span class="line">[self.navigationController <span class="string">dismissViewControllerAnimated:</span>YES <span class="string">completion:</span>^&#123;</span><br><span class="line"></span><br><span class="line">UINavigationController *navi = APPDELEGATE.tabBarController.viewControllers[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿é™©èµ·è§ï¼Œå†åˆ¤æ–­ä¸‹æ˜¯å¦æ˜¯å°†è¦è·³è½¬åˆ°çš„é¡µé¢</span></span><br><span class="line"><span class="keyword">if</span> ([navi.viewControllers[<span class="number">0</span>] <span class="string">isKindOfClass:</span>[KXOrderCenterViewController <span class="class"><span class="keyword">class</span>]]) &#123;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ‘è¿™é‡Œéœ€è¦åˆ·æ–°</span></span><br><span class="line">KXOrderCenterViewController *orderCenter = navi.viewControllers[<span class="number">0</span>];</span><br><span class="line">[orderCenter beginRefreshing];</span><br><span class="line">&#125;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<ul>
<li>è®¾ç½®å¯¼èˆªæ å³éƒ¨ç‚¹å‡»æŒ‰é’®ï¼Œå¹¶æ·»åŠ ç‚¹å‡»äº‹ä»¶</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ æ–‡å­—æŒ‰é’®</span></span><br><span class="line"><span class="built_in">UIBarButtonItem</span> *rightBarButton = [[<span class="built_in">UIBarButtonItem</span> alloc] initWithTitle:<span class="string">@"ç¼–è¾‘"</span> style:<span class="built_in">UIBarButtonItemStylePlain</span> target:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(editor)];</span><br><span class="line"></span><br><span class="line"><span class="keyword">self</span>.navigationItem.rightBarButtonItem = rightBarButton;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ å›¾ç‰‡æŒ‰é’®</span></span><br><span class="line"><span class="built_in">UIBarButtonItem</span> *rightBarBtn = [[<span class="built_in">UIBarButtonItem</span> alloc] initWithImage:[[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"å›¾ç‰‡å"</span>] imageWithRenderingMode:<span class="built_in">UIImageRenderingModeAlwaysOriginal</span>] style:<span class="built_in">UIBarButtonItemStylePlain</span> target:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(rightBarButtonEvent)];</span><br><span class="line"></span><br><span class="line">[<span class="keyword">self</span>.navigationItem setRightBarButtonItem:rightBarBtn];</span><br></pre></td></tr></table></figure>
<ul>
<li>ç»™ view æ·»åŠ æ‰‹åŠ¿ï¼Œå¹¶åŠ å…¥ç‚¹å‡»äº‹ä»¶</li>
</ul>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UITapGestureRecognizer *operationTap = [[UITapGestureRecognizer alloc]<span class="string">initWithTarget:</span>self <span class="string">action:</span><span class="meta">@selector</span>(<span class="string">gotoCapture:</span>)];</span><br><span class="line"></span><br><span class="line">[self.operationView <span class="string">addGestureRecognizer:</span>operationTap];</span><br></pre></td></tr></table></figure>
<ul>
<li>textview è¾“å…¥æ–‡æœ¬ï¼ŒæœåŠ¡å™¨é‚£è¾¹è¦æ±‚è¿”å›æ–‡æœ¬ä¸ªæ•°ä¸è¶…è¿‡32</li>
</ul>
<p>æœåŠ¡å™¨é‚£è¾¹æœ‰é™åˆ¶ï¼Œè¦æ±‚è¿”å›æ–‡æœ¬ä¸ªæ•°ä¸è¶…è¿‡32ä¸ªã€‚ã€‚ã€‚äºæ˜¯è¿™é‡Œåšäº†åˆ¤æ–­ï¼Œå¦‚æœè¶…è¿‡32ä¸ªå°±ä¸å†å…è®¸è¾“å…¥ï¼Œå…è®¸åˆ é™¤ã€‚</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)textViewDidChange:(<span class="built_in">UITextView</span> *)textView &#123;</span><br><span class="line"></span><br><span class="line">[<span class="keyword">self</span> updateViewHeight];</span><br><span class="line"><span class="comment">// è¯¥åˆ¤æ–­ç”¨äºè”æƒ³è¾“å…¥</span></span><br><span class="line"><span class="keyword">if</span> (textView == <span class="keyword">self</span>.secondDiagnosisTextView) &#123;</span><br><span class="line"><span class="keyword">if</span> (textView.text.length &gt; <span class="number">32</span>) &#123;</span><br><span class="line"><span class="comment">// æˆªå–å­—ç¬¦ä¸²</span></span><br><span class="line">textView.text = [textView.text substringToIndex:<span class="number">32</span>];</span><br><span class="line"><span class="comment">// HUD æç¤º</span></span><br><span class="line">[CommunityPublicClass showHUDwithLabelText:<span class="string">@"æœ€å¤šè¾“å…¥32ä¸ªå­—"</span> andDetailsLabelText:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»£ç†æ–¹æ³•è§„å®šåªèƒ½è¾“å…¥32ä¸ªå­—</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)textView:(<span class="built_in">UITextView</span> *)textView shouldChangeTextInRange:(<span class="built_in">NSRange</span>)range replacementText:(<span class="built_in">NSString</span> *)text &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å…¥32å­—ä¹‹åï¼Œå…è®¸åˆ é™¤</span></span><br><span class="line"><span class="keyword">if</span> ([text isEqualToString:<span class="string">@""</span>]) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (textView == <span class="keyword">self</span>.secondDiagnosisTextView) &#123;</span><br><span class="line"><span class="keyword">if</span> (textView.text.length == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line"><span class="built_in">NSInteger</span> existedLength = textView.text.length;</span><br><span class="line"><span class="built_in">NSInteger</span> selectedLength = range.length;</span><br><span class="line"><span class="built_in">NSInteger</span> replaceLength = text.length;</span><br><span class="line"><span class="keyword">if</span> (existedLength - selectedLength + replaceLength &gt; <span class="number">32</span>) &#123;</span><br><span class="line"><span class="comment">// HUD æç¤º</span></span><br><span class="line">[CommunityPublicClass showHUDwithLabelText:<span class="string">@"æœ€å¤šè¾“å…¥32ä¸ªå­—"</span> andDetailsLabelText:<span class="literal">nil</span>];</span><br><span class="line"><span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>textfield ä¸­è¾“å…¥æ‰‹æœºå·ï¼Œåªå…è®¸è¾“å…¥æ•°å­—</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)textField:(<span class="built_in">UITextField</span> *)textField shouldChangeCharactersInRange:(<span class="built_in">NSRange</span>)range replacementString:(<span class="built_in">NSString</span> *)string&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (textField == <span class="keyword">self</span>.secondAgeTextField) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ([<span class="keyword">self</span> isPureInt:string] || [string isEqualToString:<span class="string">@""</span>]) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ¤æ–­è¾“å…¥çš„æ˜¯å¦æ˜¯çº¯æ•°å­—</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)isPureInt:(<span class="built_in">NSString</span>*)string&#123;</span><br><span class="line"><span class="built_in">NSScanner</span> *scan = [<span class="built_in">NSScanner</span> scannerWithString:string];</span><br><span class="line"><span class="keyword">int</span> val;</span><br><span class="line"><span class="keyword">return</span> [scan scanInt:&amp;val] &amp;&amp; [scan isAtEnd];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ç»™ button è®¾ç½®è¾¹æ¡†ã€åœ†è§’ã€è¾¹æ¡†è®¾ç½®é¢œè‰²</li>
</ul>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="literal">self</span>.completeBtn.layer <span class="built_in">set</span>BorderWidth:<span class="number">1.0</span>];</span><br><span class="line"><span class="literal">self</span>.completeBtn.layer.cornerRadius = <span class="number">1</span>;</span><br><span class="line">[<span class="literal">self</span>.completeBtn.layer <span class="built_in">set</span>BorderColor:KXColorTextBlack.CGColor];</span><br></pre></td></tr></table></figure>
<ul>
<li>è®¾ç½®å›¾ç‰‡æ‹‰ä¼¸</li>
</ul>
<p>æœ‰æ—¶ UI è®¾è®¡å¸ˆç»™å‡ºçš„å›¾ç‰‡å¹¶ä¸åˆé€‚ï¼Œæ¯”å¦‚æˆ‘ä»¬è¿™çš„ UI è®¾è®¡å¸ˆä¸€è¾¹å¿™ web ç«¯ï¼Œä¸€è¾¹å¿™æˆ‘ä»¬ç§»åŠ¨ç«¯ï¼Œæœ‰æ—¶å€™éƒ½ä¸å¿å¿ƒè®©ä»–é‡æ–°ä½œå›¾ï¼Œäºæ˜¯åªå¥½è‡ªå·±æƒ³åŠæ³•</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¾ç½®å›¾ç‰‡æ‹‰ä¼¸</span></span><br><span class="line">UIImage *bgImage = [UIImage <span class="string">imageNamed:</span>@<span class="string">""</span>];</span><br><span class="line">_bgImageView.image = [bgImage <span class="string">stretchableImageWithLeftCapWidth:</span><span class="number">15</span> <span class="string">topCapHeight:</span><span class="number">15</span>];</span><br></pre></td></tr></table></figure>
<ul>
<li>ç‚¹å‡»å•å…ƒæ ¼æ—¶ï¼Œé»˜è®¤çš„ç‚¹å‡»æ•ˆæœæ¯”è¾ƒä¸‘ï¼Œå¤§å¤šæ—¶å€™ä¸æ˜¾ç¤ºç‚¹å‡»æ•ˆæœ</li>
</ul>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)<span class="string">tableView:</span>(UITableView *)tableView <span class="string">didSelectRowAtIndexPath:</span>(NSIndexPath *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">[tableView <span class="string">deselectRowAtIndexPath:</span>indexPath <span class="string">animated:</span>YES] ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>æ”¹å˜å¯¼èˆªæ æ ‡é¢˜çš„é¢œè‰²</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UIColor</span> *color = [<span class="built_in">UIColor</span> cyanColor];</span><br><span class="line"><span class="built_in">NSDictionary</span> *dictionary = [<span class="built_in">NSDictionary</span> dictionaryWithObject: color forKey:<span class="built_in">NSForegroundColorAttributeName</span>];</span><br><span class="line"><span class="keyword">self</span>.navigationController.navigationBar.titleTextAttributes = dictionary;</span><br></pre></td></tr></table></figure>
<ul>
<li>å»¶è¿Ÿè°ƒç”¨</li>
</ul>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å»¶è¿Ÿä¸¤ç§’é’Ÿè°ƒç”¨ beginAction æ–¹æ³•</span></span><br><span class="line">[self <span class="string">performSelector:</span><span class="meta">@selector</span>(beginAction) <span class="string">withObject:</span>nil <span class="string">afterDelay:</span><span class="number">0.2</span>] ;</span><br></pre></td></tr></table></figure>
<ul>
<li>é¡¹ç›®ä¸­ç”¨åˆ°äº† UISwitch æ§ä»¶ï¼Œéœ€è¦æ›´æ”¹å®ƒçš„å¤§å°</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ”¹å˜ UISwitch  çš„å¤§å°ï¼ŒCGAffineTransformMakeScale(CGFloat x, CGFloat y) å¯¹ view çš„é•¿å’Œå®½è¿›è¡Œç¼©æ”¾ï¼Œä¸æ”¹å˜ view çš„ä¸­å¿ƒç‚¹</span></span><br><span class="line"><span class="keyword">self</span>.orderSwitch.transform = <span class="built_in">CGAffineTransformMakeScale</span>(<span class="number">0.7</span>, <span class="number">0.7</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ”¹å˜ UISwitch å¼€å¯æ—¶çš„é¢œè‰²</span></span><br><span class="line"><span class="keyword">self</span>.orderSwitch.onTintColor = KXColorBlue;</span><br></pre></td></tr></table></figure>
<ul>
<li>åœ¨åšæ˜æš—æ–‡åˆ‡æ¢(å¯†ç è¾“å…¥æ¡†)çš„æ—¶å€™é‡è§ä¸€ä¸ªå‘â€”â€”å°±æ˜¯åˆ‡æ¢ secureTextEntry çš„æ—¶å€™ï¼Œè¾“å…¥æ¡†çš„å…‰æ ‡ä¼šåç§»ï¼Œä¸‹é¢æ˜¯è§£å†³åŠæ³•åŠæ˜æš—æ–‡åˆ‡æ¢çš„æ–¹æ³•ï¼š</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">IBAction</span>)btnClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line"></span><br><span class="line">sender.selected = !sender.selected;</span><br><span class="line"><span class="built_in">NSString</span> *passwordString = <span class="keyword">self</span>.passwordText.text;</span><br><span class="line"><span class="comment">// è¿™å¥ä»£ç å¯ä»¥é˜²æ­¢åˆ‡æ¢çš„æ—¶å€™å…‰æ ‡åç§»</span></span><br><span class="line"><span class="keyword">self</span>.passwordText.text = <span class="string">@""</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (sender.selected) &#123; <span class="comment">// æ˜æ–‡</span></span><br><span class="line"><span class="keyword">self</span>.passwordText.secureTextEntry = <span class="literal">NO</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123; <span class="comment">// æš—æ–‡</span></span><br><span class="line"><span class="keyword">self</span>.passwordText.secureTextEntry = <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">self</span>.passwordText.text = passwordString;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>åˆ¤æ–­å±å¹•æ¨ªå±/ç«–å±(åœ¨ViewControlleré‡Œé¢)</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å±å¹•å‘ç”Ÿç¿»è½¬çš„æ—¶å€™ä¼šè°ƒç”¨</span></span><br><span class="line">- (<span class="keyword">void</span>)viewWillLayoutSubviews &#123;</span><br><span class="line">[<span class="keyword">self</span> shouldRotateToOrientation:(<span class="built_in">UIDeviceOrientation</span>)[<span class="built_in">UIApplication</span> sharedApplication].statusBarOrientation];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)shouldRotateToOrientation:(<span class="built_in">UIDeviceOrientation</span>)orientation &#123;</span><br><span class="line"><span class="keyword">if</span> (orientation == <span class="built_in">UIDeviceOrientationPortrait</span> ||orientation == <span class="built_in">UIDeviceOrientationPortraitUpsideDown</span>) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"è¿™æ˜¯ç«–å±"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"è¿™æ˜¯æ¨ªå±"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>åŠ è½½æœ¬åœ°çš„ HTML æ–‡ä»¶ï¼Œæ¯”å¦‚æ–‡ä»¶åå­—æ˜¯<code>serviceDescription.html</code></li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *resourcePath = [[<span class="built_in">NSBundle</span> mainBundle] resourcePath];</span><br><span class="line"><span class="built_in">NSString</span> *filePath = [resourcePath stringByAppendingPathComponent:<span class="string">@"serviceDescription.html"</span>];</span><br><span class="line"><span class="built_in">NSString</span> *htmlString = [[<span class="built_in">NSString</span> alloc] initWithContentsOfFile:filePath encoding:<span class="built_in">NSUTF8StringEncoding</span> error:<span class="literal">nil</span>];</span><br><span class="line">[<span class="keyword">self</span>.webView loadHTMLString: htmlString baseURL: [<span class="built_in">NSURL</span> fileURLWithPath:[[<span class="built_in">NSBundle</span> mainBundle] bundlePath]]];</span><br></pre></td></tr></table></figure>
<ul>
<li>iOS é¡¹ç›®å¼€å‘ä¸­ç”¨çš„ä¸€éƒ¨åˆ†å®å®šä¹‰</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** selfçš„å¼±å¼•ç”¨ */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NNWeakSelf __weak typeof(self) weakSelf = self;</span></span><br><span class="line"><span class="comment">/** selfçš„å¼ºå¼•ç”¨ */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NNStrongSelf __strong __typeof(weakSelf)strongSelf = weakSelf;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NNColorBlue [UIColor colorWithRed:0.0/255.0f green:135.0/255.0f blue:209.0/255.0f alpha:1]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NNFontBoldText [UIFont boldSystemFontOfSize:fontFit(16)]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NNFontText [UIFont systemFontOfSize:fontFit(16)]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCREENWIDTH [UIScreen mainScreen].bounds.size.width</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCREENHEIGHT [UIScreen mainScreen].bounds.size.height</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> iPhone5 (([[UIScreen mainScreen] bounds].size.height*[[UIScreen mainScreen] bounds].size.width &lt;= 320*568)?YES:NO)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> iPhone6 (([[UIScreen mainScreen] bounds].size.height*[[UIScreen mainScreen] bounds].size.width &lt;= 375*667)?YES:NO)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> iPhone6p (([[UIScreen mainScreen] bounds].size.height*[[UIScreen mainScreen] bounds].size.width &lt;= 414*736)?YES:NO)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> iOS7 ([[[UIDevice currentDevice] systemVersion] floatValue] &gt;= 7.0 ? YES : NO) <span class="comment">// æ˜¯å¦IOS7</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">float</span> <span class="title">lengthFit</span><span class="params">(<span class="keyword">float</span> iphone6PlusLength)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (iPhone5) &#123;</span><br><span class="line"><span class="keyword">return</span> iphone6PlusLength *<span class="number">320.0f</span>/<span class="number">414.0f</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (iPhone6) &#123;</span><br><span class="line"><span class="keyword">return</span> iphone6PlusLength *<span class="number">375.0f</span>/<span class="number">414.0f</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> iphone6PlusLength;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">float</span> <span class="title">fontFit</span><span class="params">(<span class="keyword">float</span> iphone6PlusFont)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (iPhone5) &#123;</span><br><span class="line"><span class="keyword">return</span> iphone6PlusFont - <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (iPhone6) &#123;</span><br><span class="line"><span class="keyword">return</span> iphone6PlusFont - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> iphone6PlusFont;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PlaceholderAvatarImage [UIImage imageNamed:@<span class="meta-string">"é»˜è®¤å¤´åƒ"</span>]</span></span><br></pre></td></tr></table></figure>
<ul>
<li>ä¸€å¥ä»£ç éšè— UITableView ä¸­ç©ºçš„ cell</li>
</ul>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">self</span>.<span class="built_in">table</span>View.<span class="built_in">table</span>FooterView = [[UIView alloc] init];</span><br></pre></td></tr></table></figure>
<ul>
<li>è‡ªå®šä¹‰ leftBarButtonItem è¿”å›æŒ‰é’®æ—¶ï¼Œé˜²æ­¢è¿”å›æ‰‹åŠ¿å¤±æ•ˆçš„åŠæ³•</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)setupLeftBarButton &#123;</span><br><span class="line"><span class="keyword">self</span>.navigationItem.leftBarButtonItem = [[<span class="built_in">UIBarButtonItem</span> alloc]</span><br><span class="line">initWithImage:[[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"Back-è“"</span>] imageWithRenderingMode:<span class="built_in">UIImageRenderingModeAlwaysOriginal</span>]</span><br><span class="line">style:<span class="built_in">UIBarButtonItemStylePlain</span></span><br><span class="line">target:<span class="keyword">self</span></span><br><span class="line">action:<span class="keyword">@selector</span>(leftBarButtonClick)];</span><br><span class="line"><span class="keyword">self</span>.navigationController.interactivePopGestureRecognizer.delegate = (<span class="keyword">id</span>&lt;<span class="built_in">UIGestureRecognizerDelegate</span>&gt;)<span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)leftBarButtonClick &#123;</span><br><span class="line">[<span class="keyword">self</span>.navigationController popViewControllerAnimated:<span class="literal">YES</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ä¸å…è®¸ viewController è‡ªåŠ¨è°ƒæ•´ï¼Œæˆ‘ä»¬è‡ªå·±å¸ƒå±€ï¼›å¦‚æœè®¾ç½®ä¸ºYESï¼Œè§†å›¾ä¼šè‡ªåŠ¨ä¸‹ç§» 64 åƒç´ </li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.automaticallyAdjustsScrollViewInsets = <span class="literal">NO</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>å»ç©ºæ ¼ï¼Œå¼€å‘ä¸­æœ‰äº›åœ°æ–¹ä¸éœ€è¦ç©ºæ ¼ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹</li>
</ul>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å»æ‰ä¸¤ç«¯çš„ç©ºæ ¼</span></span><br><span class="line">[trimString <span class="string">stringByTrimmingCharactersInSet:</span>[NSCharacterSet whitespaceAndNewlineCharacterSet]];</span><br><span class="line"></span><br><span class="line"><span class="comment">// å»æ‰æ‰€æœ‰ç©ºæ ¼</span></span><br><span class="line">[trimString <span class="string">stringByReplacingOccurrencesOfString:</span>@<span class="string">" "</span> <span class="string">withString:</span>@<span class="string">""</span>];</span><br></pre></td></tr></table></figure>
<ul>
<li>åˆ¤æ–­å­—ç¬¦ä¸²ä¸­æ˜¯å¦åŒ…å«éæ³•å­—ç¬¦</li>
</ul>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ([self.searchText.text <span class="string">rangeOfString:</span>@<span class="string">"'"</span>].location != NSNotFound) &#123;</span><br><span class="line"><span class="comment">// ç”¨å°è£…å¥½çš„æç¤ºæ¡†æç¤º</span></span><br><span class="line">[CommunityPublicClass <span class="string">showHUDwithLabelText:</span>@<span class="string">"æ‚¨è¾“å…¥çš„å­—ç¬¦ä¸åˆæ³•"</span> <span class="string">andDetailsLabelText:</span>nil];</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>iOS å¯¼èˆªæ çš„æ­£ç¡®éšè—æ–¹æ³•</li>
</ul>
<p>ç¬¬ä¸€ç§æ–¹æ³•</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)<span class="string">viewWillAppear:</span>(BOOL)animated &#123;</span><br><span class="line">[<span class="keyword">super</span> <span class="string">viewWillAppear:</span>animated];</span><br><span class="line"></span><br><span class="line">[self.navigationController <span class="string">setNavigationBarHidden:</span>YES <span class="string">animated:</span>YES];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)<span class="string">viewWillDisappear:</span>(BOOL)animated &#123;</span><br><span class="line">[<span class="keyword">super</span> <span class="string">viewWillDisappear:</span>animated];</span><br><span class="line"></span><br><span class="line">[self.navigationController <span class="string">setNavigationBarHidden:</span>NO <span class="string">animated:</span>YES];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒç§æ–¹æ³•</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NNViewController</span> () &lt;<span class="title">UINavigationControllerDelegate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NNViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">[<span class="keyword">super</span> viewDidLoad];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®å¯¼èˆªæ§åˆ¶å™¨çš„ä»£ç†ä¸ºself</span></span><br><span class="line"><span class="keyword">self</span>.navigationController.delegate = <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - UINavigationControllerDelegate</span></span><br><span class="line">- (<span class="keyword">void</span>)navigationController:(<span class="built_in">UINavigationController</span> *)navigationController willShowViewController:(<span class="built_in">UIViewController</span> *)viewController animated:(<span class="built_in">BOOL</span>)animated &#123;</span><br><span class="line"></span><br><span class="line">[<span class="keyword">self</span>.navigationController setNavigationBarHidden: [viewController isKindOfClass:[<span class="keyword">self</span> <span class="keyword">class</span>]] animated:<span class="literal">YES</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©º</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">+ (<span class="built_in">BOOL</span>)isBlankString:(<span class="built_in">NSString</span> *)string &#123;</span><br><span class="line"><span class="keyword">if</span> (string == <span class="literal">nil</span> || string == <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ([string isKindOfClass:[<span class="built_in">NSNull</span> <span class="keyword">class</span>]]) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ([[string stringByTrimmingCharactersInSet:[<span class="built_in">NSCharacterSet</span> whitespaceCharacterSet]] length]==<span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/iOSå¼€å‘ä¹‹ - å¹¿å‘Šæ¤å…¥/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="åˆ˜æœ‹å¤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ä»¥æ¢¦ä¸ºé©¬">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/iOSå¼€å‘ä¹‹ - å¹¿å‘Šæ¤å…¥/" itemprop="url">
                  iOSå¼€å‘ä¹‹ - å¹¿å‘Šæ¤å…¥
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
                
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T12:30:20+08:00">2018-04-15</time>
            

            
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>åº”ç”¨ä¸­æ¤å…¥å¹¿å‘Šæ˜¯iOSå¼€å‘è€…è·å¾—æ”¶ç›Šçš„æ–¹å¼ä¹‹ä¸€ï¼Œå…¶å®æœ‰å¾ˆå¤š app çš„ç»å¤§éƒ¨åˆ†ç›ˆåˆ©éƒ½æ¥è‡ªäºå¹¿å‘Šæ”¶å…¥â€¦â€¦ä¸‹é¢å°±å¼€å§‹ä»‹ç»ä¸¤ç§ä¸»æµçš„æ¤å…¥å¹¿å‘Šçš„æ–¹æ³•ï¼šiAd æ–¹å¼å’Œ Admobæ–¹å¼ã€‚</p>
</blockquote>
<h2 id="ä¸€ã€iAd-æ–¹å¼"><a href="#ä¸€ã€iAd-æ–¹å¼" class="headerlink" title="ä¸€ã€iAd æ–¹å¼"></a>ä¸€ã€iAd æ–¹å¼</h2><ul>
<li><p>iAd æ–¹å¼ç®€ä»‹<br>iAd ç§»åŠ¨å¹¿å‘Šä¸šåŠ¡æ˜¯ä¹”å¸ƒæ–¯åœ¨2010å¹´æ¨å‡ºæ¥çš„ï¼Œæ€€å¿µï½ï½ï½<br><img src="http://upload-images.jianshu.io/upload_images/2665449-d2c8ede84e6f61e5.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iAd"><br>åˆšå¼€å§‹çš„æ—¶å€™ï¼ŒiAd çš„ç¡®æœ‰å¾ˆå¤§çš„å‘å±•ï¼Œä½†æ˜¯éšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ›´æ˜¯åœ¨è€ä¹”è¾ä¸–ğŸ˜¢ä¹‹åï¼ŒiAd çš„ä½¿ç”¨äººæ•°ä¾¿è¶Šæ¥è¶Šå°‘ã€‚ä»¥è‡³äºä»Šå¹´å¹´åˆï¼Œè‹¹æœå…¬å¸å®£å¸ƒå°†è¦æ”¾å¼ƒåœ¨ iAd å¹³å°ä¸Šç›´æ¥å‡ºå”®å¹¿å‘Šï¼Œè€Œæ˜¯å°†å…¶è½¬äº¤ç»™å‡ºç‰ˆå•†ã€‚ã€‚ã€‚ä½†æ˜¯ä½œä¸º iOS å¼€å‘è€…çš„æˆ‘ä»¬ï¼Œè¿˜æ˜¯æœ‰äº†è§£çš„å¿…è¦ï¼Œ iAd å¹¿å‘Šå¹³å°ä¾åœ¨ã€‚</p>
</li>
<li><p>ä½¿ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š</p>
</li>
</ul>
<p>1.1 å¯¼å…¥iAd.framework ä¾èµ–åº“<br><img src="http://upload-images.jianshu.io/upload_images/2665449-636c983733641509.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iAd.framework"></p>
<p>1.2 æ–¹ä¾¿èµ·è§ï¼Œæˆ‘æ˜¯åœ¨ Main.storyboard ä¸­æ‹‰å…¥ADBannerView<br><img src="http://upload-images.jianshu.io/upload_images/2665449-57e14a8fb97ab7c4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ADBannerView"></p>
<p>1.3 ä»£ç å®ç°<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;iAd/iAd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> () &lt;<span class="title">ADBannerViewDelegate</span>&gt;</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">NSLayoutConstraint</span> *bannerViewBottom;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>)ADBannerView *bannerView;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">[<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - ADBannerViewDelegate åè®®ä¸€å…±æœ‰äº”ä¸ªæ–¹æ³•</span></span><br><span class="line"><span class="comment">// å¹¿å‘Šå³å°†è¢«åŠ è½½</span></span><br><span class="line">- (<span class="keyword">void</span>)bannerViewWillLoadAd:(ADBannerView *)banner&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"bannerViewWillLoadAd"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¹¿å‘Šå·²è¢«åŠ è½½</span></span><br><span class="line">- (<span class="keyword">void</span>)bannerViewDidLoadAd:(ADBannerView *)banner</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"bannerViewDidLoadAd"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">self</span>.bannerViewBottom.constant = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">[<span class="built_in">UIView</span> animateWithDuration:<span class="number">0.5</span> animations:^&#123;</span><br><span class="line">[<span class="keyword">self</span>.view layoutIfNeeded];</span><br><span class="line">&#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ˜¯å¦å‡ºç°å…¨å±çš„å¹¿å‘Š</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)bannerViewActionShouldBegin:(ADBannerView *)banner willLeaveApplication:(<span class="built_in">BOOL</span>)willLeave &#123;</span><br><span class="line"><span class="comment">// return YES: ç”¨æˆ·ç‚¹å‡» Banner ä¹‹åï¼Œä¼šå‡ºç°å…¨å±å¹¿å‘Š</span></span><br><span class="line"><span class="comment">//    å¦‚æœè¿”å›çš„æ˜¯ NOï¼Œç”¨æˆ·ç‚¹å‡» Banner ä¹‹å, ä¸ä¼šå‡ºç°å…¨å±å¹¿å‘Š</span></span><br><span class="line"><span class="comment">//    å¦å¤–å¦‚æœè¿”å› YESï¼Œ ç”¨æˆ·å…¶å®ƒçš„æ´»åŠ¨éƒ½ä¼šè¢«æš‚åœ</span></span><br><span class="line"><span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…¨å±çš„å¹¿å‘Šé€€å‡ºæ—¶è°ƒç”¨ï¼Œç”¨æˆ·å…¶å®ƒçš„æ´»åŠ¨éƒ½ä¼šè¢«å”¤é†’</span></span><br><span class="line">- (<span class="keyword">void</span>)bannerViewActionDidFinish:(ADBannerView *)banner &#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"bannerViewActionDidFinish"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœ app ä¸Šæ²¡æœ‰å¹¿å‘Šï¼Œå°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•</span></span><br><span class="line">- (<span class="keyword">void</span>)bannerView:(ADBannerView *)banner didFailToReceiveAdWithError:(<span class="built_in">NSError</span> *)error</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"didFailToReceiveAdWithError"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<h2 id="äºŒã€Admobæ–¹å¼"><a href="#äºŒã€Admobæ–¹å¼" class="headerlink" title="äºŒã€Admobæ–¹å¼"></a>äºŒã€Admobæ–¹å¼</h2><ul>
<li>Admobæ–¹å¼ç®€ä»‹<br>Admob æ˜¯ Google æ¨å‡ºçš„ï¼Œç”¨çš„äººæ¯”è¾ƒå¤šï¼Œå®ƒæä¾›äº†ç›®å‰ä¸ºæ­¢æœ€æ–¹ä¾¿çš„ iPhone app å¹¿å‘Šé›†æˆåº“ã€‚</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-a4d5bb0d7fb0e5b0.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Admob"></p>
<p>ä¸‹é¢è¯´ä¸€ä¸‹å®ƒçš„åŸºæœ¬ä½¿ç”¨ï½ï½ï½</p>
<p>2.1 é¦–å…ˆéœ€è¦æ³¨å†ŒAdmobã€è®¾ç½®è´¦æˆ·ä¿¡æ¯ã€åˆ›å»ºåº”ç”¨ç­‰ç­‰ï¼Œè¿™é‡Œä¸å†è¯¦ç»†ä»‹ç»ï¼Œå¦‚æœæœ‰æœ‹å‹éœ€è¦å¯ä»¥å€Ÿé‰´<a href="http://blog.csdn.net/songrotek/article/details/8501557" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ã€‚</p>
<p>2.2  é›†æˆAdmob SDK.<br>2.21 ä¸‹è½½Admob SDKï¼š<a href="http://www.cocoachina.com/bbs/read.php?tid=284847" target="_blank" rel="noopener">Admob SDK</a><br>2.22 ä¸‹è½½å®Œæˆåï¼Œå°†è¿™ä¸¤ä¸ªæ–‡ä»¶å¯¼å…¥é¡¹ç›®ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-bb165f16616a1c81.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Admob SDK"></p>
<p>2.23 æ·»åŠ ä¾èµ–åº“</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2665449-717cd15cdd022342.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ·»åŠ ä¾èµ–åº“"></p>
<p>2.24 å¯¼å…¥å¤´æ–‡ä»¶<br><strong>æ³¨æ„éœ€è¦å¯¼å…¥çš„äº‹è¿™ä¸¤ä¸ªå¤´æ–‡ä»¶ï¼</strong><br><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">import</span> <span class="string">"GoogleMobileAds/GADInterstitial.h"</span></span><br><span class="line">#<span class="keyword">import</span> <span class="string">"GoogleMobileAds/GADBannerView.h"</span></span><br></pre></td></tr></table></figure></p>
<p>2.3 ä»£ç å®ç°</p>
<ul>
<li>åœ¨å±å¹•åº•éƒ¨æ¤å…¥å¹¿å‘Š</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"GoogleMobileAds/GADInterstitial.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"GoogleMobileAds/GADBannerView.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span>&#123;</span><br><span class="line">GADBannerView *bannerView;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> *MyId = <span class="string">@"********"</span>;</span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">[<span class="keyword">super</span> viewDidLoad];</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨å±å¹•åº•éƒ¨åˆ›å»ºæ ‡å‡†å°ºå¯¸çš„è§†å›¾</span></span><br><span class="line">bannerView = [[GADBannerView alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0.0</span>, <span class="keyword">self</span>.view.frame.size.height -GAD_SIZE_320x50.height, GAD_SIZE_320x50.width, GAD_SIZE_320x50.height)];</span><br><span class="line">bannerView.backgroundColor = [<span class="built_in">UIColor</span> redColor];</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‡å®šå¹¿å‘Šçš„æ ‡è¯†ç¬¦</span></span><br><span class="line">bannerView.adUnitID = MyId;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è½¬è‡³å¹¿å‘Šçš„å±•ç¤ºä½ç½®ä¹‹åæ¢å¤å“ªä¸ª UIViewController</span></span><br><span class="line">bannerView.rootViewController = <span class="keyword">self</span>;</span><br><span class="line">[<span class="keyword">self</span>.view addSubview:bannerView];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯·æ±‚å¹¶åŠ è½½å¹¿å‘Š</span></span><br><span class="line">[bannerView loadRequest:[GADRequest request]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<ul>
<li>ä¹Ÿå¯ä»¥åœ¨å±å¹•é¡¶éƒ¨æ¤å…¥å¹¿å‘Š</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"GoogleMobileAds/GADInterstitial.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"GoogleMobileAds/GADBannerView.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span>&#123;</span><br><span class="line">GADBannerView *bannerView;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> *MyId = <span class="string">@"********"</span>;</span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line"></span><br><span class="line">[<span class="keyword">super</span> viewDidLoad];</span><br><span class="line"><span class="comment">// å¯¼èˆªæ ä½ç½®æ·»åŠ å¹¿å‘Š</span></span><br><span class="line"><span class="keyword">float</span> y =<span class="keyword">self</span>.navigationController.navigationBar.frame.size.height + [[<span class="built_in">UIApplication</span> sharedApplication] statusBarFrame].size.height;</span><br><span class="line"><span class="keyword">float</span> x = ([<span class="built_in">UIScreen</span> mainScreen].bounds.size.width - <span class="number">320</span>) / <span class="number">2</span>;</span><br><span class="line">bannerView=[[GADBannerView alloc]initWithAdSize:kGADAdSizeBanner origin:<span class="built_in">CGPointMake</span>(x, y)];</span><br><span class="line">bannerView.adUnitID = MyId;</span><br><span class="line">bannerView.backgroundColor = [<span class="built_in">UIColor</span> redColor];</span><br><span class="line">bannerView.rootViewController = <span class="keyword">self</span>;</span><br><span class="line">[<span class="keyword">self</span>.view addSubview:bannerView];</span><br><span class="line">GADRequest *request = [GADRequest request];</span><br><span class="line">request.testDevices = @[MyId,MyId];</span><br><span class="line">[bannerView loadRequest:request];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>å½“ç„¶ï¼Œä½ å¯ä»¥åœ¨ä»»ä½•ä½ å¸Œæœ›çš„åœ°æ–¹æ¤å…¥å¹¿å‘Šï¼Œå¤§å®¶å¯ä»¥è¯•è¯•çš„ğŸ˜Šï¼ä»¥åè¦æ˜¯ç”¨çš„å¤šäº†ï¼Œæˆ‘ä¼šç»§ç»­åœ¨è¿™é‡Œè¡¥å……ï¼Œå¦å¤–å¦‚æœä»£ç ä¹¦å†™æœ‰è¯¯ï¼Œè¿˜è¯·å¤§å®¶èƒ½å¤ŸæŒ‡å‡ºæ¥ï¼äº’ç›¸äº¤æµå­¦ä¹ ï¼è°¢è°¢ï¼</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">åˆ˜æœ‹å¤</p>
              <p class="site-description motion-element" itemprop="description">iOS ä¿®ç‚¼ä¸­...</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives">
                
                    <span class="site-state-item-count">44</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              

              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">åˆ˜æœ‹å¤</span>

  

  
</div>




  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Muse</a> v6.1.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.1.0"></script>



  



	





  





  










  





  

  

  

  

  
  

  

  

  

  

</body>
</html>
